<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­éŸ³åˆæˆç³»ç»Ÿï¼ˆExpressive TTSï¼‰</title>
    <url>/2023/02/10/expressive-tts/</url>
    <content><![CDATA[<h1 id="å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­éŸ³åˆæˆç³»ç»Ÿ">å¯Œæœ‰è¡¨ç°åŠ›çš„è¯­éŸ³åˆæˆç³»ç»Ÿ</h1>
<h2 id="tacotron-gst">Tacotron-GST</h2>
<p>åœ¨Tacotronå¼•å…¥äº†<strong>å…¨å±€é£æ ¼æ ‡ç­¾ï¼ˆGlobal Style
Tokenï¼ŒGSTï¼‰</strong>ã€‚æ¨¡å‹åŒ…æ‹¬reference encoderï¼Œstyle attentionï¼Œstyle
embedding</p>
<figure>
<img src="/2023/02/10/expressive-tts/tacotron-gst.png" alt="Tacotron-GSTæ¨¡å‹ç»“æ„">
<figcaption aria-hidden="true">Tacotron-GSTæ¨¡å‹ç»“æ„</figcaption>
</figure>
<h2 id="styletoken-tts">StyleToken-TTS</h2>
<p>åœ¨æ•°æ®é›†ä¸Šå¢åŠ <strong>é£æ ¼æ ‡ç­¾</strong>ï¼Œä»£è¡¨è¯è¯­é£æ ¼çš„çŸ­è¯­æˆ–è¯ï¼Œä¾‹å¦‚æƒ…æ„Ÿã€æ„å›¾å’Œè¯­è°ƒã€‚ç”±äºé£æ ¼æ˜¯ç”¨è‡ªç„¶è¯­è¨€æ ‡è®°çš„ï¼Œå› æ­¤æ§åˆ¶è¯´è¯é£æ ¼æ˜¯ç›´è§‚å’Œå¯è§£é‡Šçš„ã€‚</p>
<p>ä½¿ç”¨çš„éŸ©è¯­æ•°æ®é›†<strong>FSNR0</strong>ï¼Œå†…å®¹ä¸ºä¸‰å…ƒç»„ {speech,
transcript, style tag} ï¼Œæœ‰ 327
ä¸ªé£æ ¼æ ‡ç­¾ï¼ŒåŒ…æ‹¬å„ç§æƒ…ç»ªã€æ„å›¾ã€è¯­éŸ³è¯­è°ƒå’Œé€Ÿåº¦ã€‚</p>
<figure>
<img src="/2023/02/10/expressive-tts/æˆªå±2023-02-10%2013.51.22.png" alt="ST-TTSæ¨¡å‹ç»“æ„">
<figcaption aria-hidden="true">ST-TTSæ¨¡å‹ç»“æ„</figcaption>
</figure>
<h2 id="prompttts">PromptTTS</h2>
<p>ä½¿ç”¨å¾®è½¯çš„TTSåˆæˆè¯­éŸ³<a href="https://speechresearch.github.io/prompttts/">è‡ªå»ºæ•°æ®é›†</a>ï¼Œåœ¨LibriSpeechçš„çœŸäººæ•°æ®ä¸ŠåšéªŒè¯ã€‚</p>
<p>å…¶é£æ ¼æç¤ºè¯å‡å®šæœ‰äº”ä¸ªé£æ ¼ç›¸å…³å†…å®¹ï¼Œå¦‚é«˜å£°è°ƒã€å¥³å£°</p>
<p>ç”¨<code>[CLS]</code>Tokenå­¦ä¹ éšè—çš„é£æ ¼è¡¨ç¤ºï¼ŒBERTç»è¿‡å¾®è°ƒï¼Œç”¨äºè¾“å‡ºäº”ä¸ªé£æ ¼ç›¸å…³ç‰¹å¾</p>
<figure>
<img src="/2023/02/10/expressive-tts/prompt-tts.png" alt="Prompt-TTSæ¨¡å‹ç»“æ„">
<figcaption aria-hidden="true">Prompt-TTSæ¨¡å‹ç»“æ„</figcaption>
</figure>
<p>å…¶ä¸­Content Encoderé¡¶å±‚çš„Variance
Adaptoræ¥è‡ªFastSpeech2ï¼Œç”¨äºé¢„æµ‹æŒç»­æ—¶é—´ã€éŸ³é«˜ã€èƒ½é‡ç­‰ã€‚</p>
<p><img src="/2023/02/10/expressive-tts/image-20230407211240554.png" alt="FastSpeech2" style="zoom: 33%;"></p>
<h2 id="instructtts">InstructTTS</h2>
<p>é¦™æ¸¯ä¸­æ–‡å¤§å­¦+è…¾è®¯AI Labåˆä½œ</p>
<p>demoåœ°å€ï¼š<a href="http://dongchaoyang.top/InstructTTS/">http://dongchaoyang.top/InstructTTS/</a></p>
<p>ä½¿ç”¨è‡ªç„¶è¯­è¨€ä½œä¸ºæç¤ºï¼ŒæŒ‡å¯¼è¯­éŸ³åˆæˆçš„æƒ…ç»ªï¼Œæç¤ºå¥åŒ…å«æ•´ä½“æ„ŸçŸ¥æƒ…ç»ªã€è¯è¯­æƒ…æ„Ÿæ°´å¹³ã€è¯è¯­é£æ ¼ï¼Œæ¯æ¡è¯­éŸ³ç”±äº”ä¸ªäººå†™å‡ºæç¤ºå¥ã€‚<strong>NLSpeechå†…éƒ¨æ•°æ®é›†</strong>æ—¶é•¿çº¦44å°æ—¶ã€‚</p>
<figure>
<img src="/2023/02/10/expressive-tts/æˆªå±2023-02-10%2013.23.58.png" alt="InstructTTS">
<figcaption aria-hidden="true">InstructTTS</figcaption>
</figure>
<figure>
<img src="/2023/02/10/expressive-tts/æˆªå±2023-02-10%2014.26.38.png" alt="æ¨¡å‹ç»“æ„">
<figcaption aria-hidden="true">æ¨¡å‹ç»“æ„</figcaption>
</figure>
<p><img src="/2023/02/10/expressive-tts/æˆªå±2023-02-17 13.20.26.png" alt="Mel-VQ-VAE" style="zoom: 67%;"></p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>è¯­éŸ³åˆæˆ</tag>
        <tag>è®ºæ–‡</tag>
      </tags>
  </entry>
  <entry>
    <title>Apple Silicon MacBook Proæ–°æœºé…ç½®</title>
    <url>/2022/07/31/apple-silicon-macbook-pro-xin-ji-pei-zhi/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡è®°å½•ä¸‹ç”±intelè½¬ç§»åˆ°m1çš„è¿‡ç¨‹ä¸­é‡è£…å„ç§ç¯å¢ƒå’Œå·¥å…·çš„å‘½ä»¤å’Œé…ç½®</p>
</blockquote>
<aside>
ğŸ’¡ ç¬¬ä¸€æ¬¡ä½¿ç”¨è‹¹æœçš„time
machineè¿›è¡Œè¿ç§»ï¼Œç»™æˆ‘çš„æ„Ÿè§‰å°±åƒæŠŠæ—§ç”µè„‘çš„ç¡¬ç›˜ç›´æ¥æ‘†åœ¨é¢å‰ä¸€æ ·ï¼Œè¿ç§»æ–‡ä»¶å¾ˆå¥½ç”¨
</aside>
<h1 id="é…ç½®git">é…ç½®git</h1>
<p>macè‡ªå¸¦gitï¼Œæ‰€ä»¥åªéœ€è¦é…ç½®ä¸‹ç”¨æˆ·åå’Œé‚®ç®±</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git config --global user.name <span class="hljs-string">&quot;John Doe&quot;</span><br>git config --global user.email <span class="hljs-string">&quot;johndoe@example.com&quot;</span><br></code></pre></td></tr></table></figure>
<h1 id="å®‰è£…brew">å®‰è£…brew</h1>
<p><a href="https://brew.sh/index_zh-cn">Homebrew</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">/bin/bash -c <span class="hljs-string">&quot;<span class="hljs-subst">$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)</span>&quot;</span><br></code></pre></td></tr></table></figure>
<p>æ ¹æ®è¿”å›çš„æœ€åå†…å®¹æ‰§è¡Œæç¤ºçš„ä»£ç ï¼Œå°†brewæ·»åŠ åˆ°pathä¸­</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;eval &quot;$(/opt/homebrew/bin/brew shellenv)&quot;&#x27;</span> &gt;&gt; /Users/ashone/.zprofile<br></code></pre></td></tr></table></figure>
<p>æœ€ååœ¨ç»ˆç«¯ä¸­è¾“å…¥brewæµ‹è¯•æ˜¯å¦æ·»åŠ æˆåŠŸ</p>
<h1 id="å®‰è£…iterm2">å®‰è£…iTerm2</h1>
<p><a href="https://iterm2.com/index.html">iTerm2 - macOS Terminal
Replacement</a></p>
<h1 id="å®‰è£…oh-my-zsh">å®‰è£…oh-my-zsh</h1>
<p><a href="https://ohmyz.sh/#install">Oh My Zsh - a delightful &amp;
open source framework for Zsh</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sh -c <span class="hljs-string">&quot;<span class="hljs-subst">$(curl -fsSL https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh)</span>&quot;</span><br></code></pre></td></tr></table></figure>
<h1 id="å®‰è£…zshä¸»é¢˜">å®‰è£…zshä¸»é¢˜</h1>
<p>æˆ‘é€‰æ‹©å®‰è£…powerlevel10kä¸»é¢˜ï¼Œé“¾æ¥åœ¨è¿™é‡Œhttps://github.com/romkatv/powerlevel10k</p>
<ol type="1">
<li><p>å®‰è£…å­—ä½“ï¼ˆå¯è·³è¿‡ï¼‰</p>
<p><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Regular.ttf">MesloLGS
NF Regular.ttf</a></p>
<p><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold.ttf">MesloLGS
NF Bold.ttf</a></p>
<p><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Italic.ttf">MesloLGS
NF Italic.ttf</a></p>
<p><a href="https://github.com/romkatv/powerlevel10k-media/raw/master/MesloLGS%20NF%20Bold%20Italic.ttf">MesloLGS
NF Bold Italic.ttf</a></p></li>
<li><p>æ‰‹åŠ¨å®‰è£…ä¸»é¢˜æ–‡ä»¶</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/romkatv/powerlevel10k.git <span class="hljs-variable">$&#123;ZSH_CUSTOM:-<span class="hljs-variable">$HOME</span>/.oh-my-zsh/custom&#125;</span>/themes/powerlevel10k<br></code></pre></td></tr></table></figure></p></li>
<li><p>ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œä¿®æ”¹ä¸»é¢˜ä¸º10k</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">code ~/.zshrc<br></code></pre></td></tr></table></figure></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ç¼–è¾‘å™¨æ‰“å¼€è¿™ä¸ªæ–‡ä»¶</p>
<p>ç„¶åæ‰¾åˆ°ç¬¬11è¡Œä¿®æ”¹ä¸»é¢˜ä¸º</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">powerlevel10k/powerlevel10k<br></code></pre></td></tr></table></figure></p></li>
<li><p>é‡å¯itermï¼ŒåŠ è½½ä¸»é¢˜æ–‡ä»¶</p>
<p><img src="/2022/07/31/apple-silicon-macbook-pro-xin-ji-pei-zhi/Untitled.png"></p></li>
<li><p>ä¾æ¬¡æ ¹æ®æ ·å¼è¿›è¡Œé…ç½®</p></li>
<li><p>é‡å¯itermå°±å¯ä»¥çœ‹åˆ°å´­æ–°çš„ä¸»é¢˜äº†</p></li>
</ol>
<h1 id="å®‰è£…oh-my-zshè‡ªåŠ¨è¡¥å…¨æ’ä»¶">å®‰è£…oh-my-zshè‡ªåŠ¨è¡¥å…¨æ’ä»¶</h1>
<p><a href="https://github.com/zsh-users/zsh-autosuggestions">GitHub -
zsh-users/zsh-autosuggestions: Fish-like autosuggestions for zsh</a></p>
<ol type="1">
<li><p>ä¸‹è½½æ’ä»¶</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">git <span class="hljs-built_in">clone</span> https://github.com/zsh-users/zsh-autosuggestions <span class="hljs-variable">$&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;</span>/plugins/zsh-autosuggestions<br></code></pre></td></tr></table></figure></p></li>
<li><p>ç¼–è¾‘zshrcé…ç½®æ–‡ä»¶ï¼Œå¢åŠ æ’ä»¶ï¼Œä¿®æ”¹é…è‰²</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">code ~/.zshrc<br></code></pre></td></tr></table></figure></p>
<p><figure class="highlight makefile"><table><tr><td class="code"><pre><code class="hljs makefile">plugins=( <br>    <span class="hljs-comment"># other plugins...</span><br>    zsh-autosuggestions<br>)<br><span class="hljs-comment"># æ­¤å¤„ä¿®æ”¹autosuggestionsæ’ä»¶çš„é…è‰²</span><br>ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE=<span class="hljs-string">&quot;fg=#d0d0d0,underline&quot;</span><br></code></pre></td></tr></table></figure></p></li>
<li><p>é‡å¼€iterm</p></li>
</ol>
<p>æŸ¥çœ‹æ•ˆæœï¼š</p>
<p><img src="/2022/07/31/apple-silicon-macbook-pro-xin-ji-pei-zhi/Untitled%201.png"></p>
<h1 id="é…ç½®pythonå’Œconda">é…ç½®pythonå’Œconda</h1>
<p><a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda -
Conda documentation</a></p>
<h2 id="å®‰è£…minicondaå¯¹åº”ç‰ˆæœ¬çš„pkgåŒå‡»åç›´æ¥å®‰è£…åœ¨ç»ˆç«¯æµ‹è¯•condaå‘½ä»¤æ˜¯å¦æ­£å¸¸">å®‰è£…minicondaå¯¹åº”ç‰ˆæœ¬çš„pkgï¼ŒåŒå‡»åç›´æ¥å®‰è£…ï¼Œåœ¨ç»ˆç«¯æµ‹è¯•condaå‘½ä»¤æ˜¯å¦æ­£å¸¸</h2>
<h2 id="æŸ¥çœ‹condaç¯å¢ƒ-åˆ›å»ºæ–°pythonç¯å¢ƒ">æŸ¥çœ‹condaç¯å¢ƒ,
åˆ›å»ºæ–°pythonç¯å¢ƒ</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda <span class="hljs-built_in">env</span> list<br>conda create -n your_env_name python=x.x<br><br>conda activate dl<br>conda deactivate<br></code></pre></td></tr></table></figure>
<h1 id="å®‰è£…pytorchapple-siliconç‰ˆæœ¬">å®‰è£…pytorchï¼ˆApple
Siliconç‰ˆæœ¬ï¼‰</h1>
<p><a href="https://pytorch.org/">PyTorch</a></p>
<p><img src="/2022/07/31/apple-silicon-macbook-pro-xin-ji-pei-zhi/Untitled%202.png"></p>
<p>pytorchä»1.13ç‰ˆæœ¬å¼€å§‹æ”¯æŒè‹¹æœèŠ¯ç‰‡gpuåŠ é€Ÿ,ç›®å‰ï¼ˆ7.30ï¼‰è¿˜å¾—å®‰è£…nightlyç‰ˆæœ¬</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">conda install pytorch -c pytorch-nightly<br></code></pre></td></tr></table></figure>
<p>ç”¨pythonæµ‹è¯•æŸ¥çœ‹ç‰ˆæœ¬å·ï¼Œtorchç‰ˆæœ¬ä¸º1.13å¼€å‘ç‰ˆå°±ä»£è¡¨å®‰è£…æˆåŠŸ</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">â¯ python<br>Python 3.8.13 (default, Mar 28 2022, 06:13:39)<br>[Clang 12.0.0 ] :: Anaconda, Inc. on darwin<br>Type <span class="hljs-string">&quot;help&quot;</span>, <span class="hljs-string">&quot;copyright&quot;</span>, <span class="hljs-string">&quot;credits&quot;</span> or <span class="hljs-string">&quot;license&quot;</span> <span class="hljs-keyword">for</span> more information.<br>&gt;&gt;&gt; import torch<br>&gt;&gt;&gt; torch.__version__<br><span class="hljs-string">&#x27;1.13.0.dev20220729&#x27;</span><br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>Apple</tag>
        <tag>é…ç½®</tag>
        <tag>conda</tag>
        <tag>zsh</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexoåšå®¢åœ¨materyä¸»é¢˜ä¸‹æ’å…¥mermaidæµç¨‹å›¾</title>
    <url>/2022/07/12/hexo-bo-ke-zai-matery-zhu-ti-xia-cha-ru-mermaid-liu-cheng-tu/</url>
    <content><![CDATA[<h1 id="hexoåšå®¢åœ¨materyä¸»é¢˜ä¸‹æ’å…¥mermaidæµç¨‹å›¾">Hexoåšå®¢åœ¨materyä¸»é¢˜ä¸‹æ’å…¥mermaidæµç¨‹å›¾</h1>
<blockquote>
<p>æœ¬æ–‡è§£å†³hexoæœ¬èº«æ— æ³•æ¸²æŸ“mermaidæµç¨‹å›¾çš„é—®é¢˜,æœ¬è´¨æ˜¯åŠ è½½å¯¹åº”çš„jsæ–‡ä»¶</p>
<p>å…¶ä»–ä¸»é¢˜å¯ä»¥ç›´æ¥å‚è€ƒhttps://github.com/webappdevelp/hexo-filter-mermaid-diagrams</p>
</blockquote>
<p>å®˜æ–¹æŒ‡å®šåœ¨<code>after-footer.ejs</code>æ–‡ä»¶ä¸­æ’å…¥ä»¥ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs ejs">&lt;% if (theme.mermaid.enable) &#123; %&gt;<br>  &lt;script src=&#x27;https://unpkg.com/mermaid@&lt;%= theme.mermaid.version %&gt;/dist/mermaid.min.js&#x27;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>    if (window.mermaid) &#123;<br>      mermaid.initialize(&#123;theme: &#x27;forest&#x27;&#125;);<br>    &#125;<br>  &lt;/script&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<p>è€Œå®é™…ä¸Šåœ¨materyä¸»é¢˜ä¸­æ²¡æœ‰è¯¥æ–‡ä»¶</p>
<h2 id="è§£å†³æ–¹æ³•">è§£å†³æ–¹æ³•</h2>
<h3 id="ç¬¬ä¸€æ­¥-å¢åŠ jsä»£ç ">ç¬¬ä¸€æ­¥ å¢åŠ jsä»£ç </h3>
<p>åœ¨materyä¸»é¢˜è·¯å¾„<code>themes/hexo-theme-matery/layout/_partial</code>ä¸‹æ‰¾åˆ°<code>footer.ejs</code></p>
<p>ç›´æ¥åœ¨è¯¥æ–‡ä»¶çš„æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs ejs">&lt;% if (theme.mermaid.enable) &#123; %&gt;<br>  &lt;script src=&#x27;https://unpkg.com/mermaid/dist/mermaid.min.js&#x27;&gt;&lt;/script&gt;<br>  &lt;script&gt;<br>    if (window.mermaid) &#123;<br>      mermaid.initialize(&#123;theme: &#x27;forest&#x27;&#125;);<br>    &#125;<br>  &lt;/script&gt;<br>&lt;% &#125; %&gt;<br></code></pre></td></tr></table></figure>
<p><strong>æ³¨æ„åˆ°å»æ‰äº†åŸæœ¬ä¸­é—´çš„ç‰ˆæœ¬æ§åˆ¶,
å› ä¸ºç‰ˆæœ¬é€‰æ‹©å¯èƒ½ä¼šå¯¼è‡´åŠ è½½çš„jsä¸èƒ½æ­£å¸¸æ˜¾ç¤ºtyporaä¸­çš„mermaidå›¾</strong></p>
<ul>
<li>å¦‚æœæƒ³è¦ä¿®æ”¹ä¸»é¢˜åˆ™ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹themeåçš„å†…å®¹ä¸ºå¦‚ä¸‹: <em>default |
dark | forest | neutral</em></li>
</ul>
<h3 id="ç¬¬äºŒæ­¥-å¢åŠ ymlæ–‡æœ¬">ç¬¬äºŒæ­¥ å¢åŠ ymlæ–‡æœ¬</h3>
<p>åœ¨<em>ä¸»é¢˜çš„é…ç½®æ–‡ä»¶</em>ä¸‹<code>themes/hexo-theme-matery/_config.yml</code>å¢åŠ æ–‡æœ¬</p>
<figure class="highlight yml"><table><tr><td class="code"><pre><code class="hljs yml"><span class="hljs-attr">mermaid:</span><br>  <span class="hljs-attr">enable:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>ä¸å‡ºæ„å¤–åˆ°è¿™é‡Œè¿›è¡Œæµ‹è¯•å°±å¯ä»¥è§åˆ°hexoèƒ½å¤ŸåŠ è½½å‡ºæ¥mermaidå›¾äº†(æ’’èŠ±)</p>
<p>å¦‚æœæ²¡èƒ½æˆåŠŸåŠ è½½, å¯ä»¥æŸ¥çœ‹æºä»£ç æŸ¥æ‰¾mermaid,
çœ‹çœ‹å¢åŠ çš„ejsä»£ç æ˜¯å¦æˆåŠŸæ¸²æŸ“</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>blog</tag>
        <tag>hexo</tag>
        <tag>typora</tag>
      </tags>
  </entry>
  <entry>
    <title>Flutterå­¦ä¹ ç¬”è®°</title>
    <url>/2021/09/28/flutter-xue-xi-bi-ji/</url>
    <content><![CDATA[<h1 id="flutterå­¦ä¹ ç¬”è®°">Flutterå­¦ä¹ ç¬”è®°</h1>
<h2 id="statelesswidgetå’Œstatefulwidget">StatelessWidgetå’ŒStatefulWidget</h2>
<ul>
<li>StatelessWidgetåœ¨åˆ›å»ºä¹‹åå°†ä¸ä¼šæ›´æ”¹ï¼Œæƒ³è¦æ›´æ”¹åªèƒ½newä¸€ä¸ªæ–°çš„åšæ›¿æ¢ã€‚<br>
</li>
<li>StatefulWidgeté€šè¿‡åœ¨Stateç±»ä¸­è°ƒç”¨setState((){})æ›´æ–°è§†å›¾ï¼Œè§¦å‘State.buildï¼Œå°†æ•´ä¸ªç»„ä»¶é‡æ–°ç»˜åˆ¶ï¼Œ<strong>åŒæ—¶ä¼šå¯¼è‡´æ‰€æœ‰å­ç»„ä»¶é‡æ–°æ„é€ ç”Ÿæˆï¼Œè¯¥ç»“ç‚¹çš„å…„å¼Ÿç»“ç‚¹ç»„ä»¶ä¹Ÿä¼šè¢«é‡æ–°æ„é€ </strong>ã€‚</li>
</ul>
<h2 id="å¼€å‘æ—¶å¦‚ä½•é€‰æ‹©">å¼€å‘æ—¶å¦‚ä½•é€‰æ‹©</h2>
<ul>
<li>ä¼˜å…ˆä½¿ç”¨ StatelessWidget<br>
</li>
<li>å«æœ‰å¤§é‡å­ Widgetï¼ˆå¦‚æ ¹å¸ƒå±€ã€æ¬¡æ ¹å¸ƒå±€ï¼‰æ…ç”¨ SatefulWidget</li>
<li>å°½é‡åœ¨å¶å­èŠ‚ç‚¹æ—¶ä½¿ç”¨ StatefulWidget</li>
<li>å°†ä¼šè°ƒç”¨åˆ°setState((){})
çš„ä»£ç å°½å¯èƒ½çš„å’Œè¦æ›´æ–°çš„è§†å›¾å°è£…åœ¨ä¸€ä¸ªå°½å¯èƒ½å°çš„æ¨¡å—é‡Œ</li>
<li>å¦‚æœä¸€ä¸ªWidgetéœ€è¦reBuildï¼Œé‚£ä¹ˆå®ƒçš„å­èŠ‚ç‚¹ã€å…„å¼ŸèŠ‚ç‚¹ã€å…„å¼ŸèŠ‚ç‚¹çš„å­èŠ‚ç‚¹åº”è¯¥å°½å¯èƒ½å°‘</li>
</ul>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>Flutter</tag>
        <tag>Dart</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexoå¿«é€Ÿä½¿ç”¨æŒ‡åŒ—</title>
    <url>/2020/10/12/hexo-kuai-su-shi-yong-zhi-bei/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very
first post. Check <a href="https://hexo.io/docs/">documentation</a> for
more info. If you get any problems when using Hexo, you can find the
answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or
you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="quick-start">Quick Start</h2>
<h3 id="create-a-new-post">Create a new post</h3>
<p>å¯ä»¥æŒ‡å®šæ¨¡æ¿</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br>$ hexo new post <span class="hljs-string">&quot;è¿™æ˜¯ä¸€ä¸ªæ–°çš„ç¬”è®°&quot;</span><br></code></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="run-server">Run server</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo server<br>$ hexo s<br></code></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="generate-static-files">Generate static files</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo generate<br>$ hexo g<br></code></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="deploy-to-remote-sites">Deploy to remote sites</h3>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">$ hexo deploy<br>$ hexo d<br></code></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<h3 id="å‘½ä»¤å¯ä»¥ç»„åˆä½¿ç”¨">å‘½ä»¤å¯ä»¥ç»„åˆä½¿ç”¨</h3>
<blockquote>
<p>hexo g &amp;&amp; hexo d &amp;&amp; hexo s</p>
</blockquote>
]]></content>
  </entry>
  <entry>
    <title>Hexoå®‰è£…å’Œé…ç½®æ’ä»¶</title>
    <url>/2022/08/01/hexo-an-zhuang-he-pei-zhi-cha-jian/</url>
    <content><![CDATA[<h1 id="hexoå®‰è£…å’Œé…ç½®æ’ä»¶">Hexoå®‰è£…å’Œé…ç½®æ’ä»¶</h1>
<aside>
ğŸ’¡ æœ¬æ–‡å®‰è£…é…ç½®äº†hexoåšå®¢çš„å¸¸ç”¨æ’ä»¶ï¼ŒåŒ…æ‹¬pandocã€mermaidã€æœ¬åœ°å›¾ç‰‡ç­‰æ’ä»¶
</aside>
<h1 id="å‡†å¤‡å·¥ä½œ">å‡†å¤‡å·¥ä½œ</h1>
<h2 id="å®‰è£…nodeç¯å¢ƒ">å®‰è£…nodeç¯å¢ƒ</h2>
<p>å¯ä»¥ç›´æ¥åœ¨nodejså®˜ç½‘ä¸‹è½½å®‰è£…åŒ…</p>
<h2 id="å‡†å¤‡è·¯å¾„åå®‰è£…hexo">å‡†å¤‡è·¯å¾„åå®‰è£…hexo</h2>
<p>åœ¨æƒ³è¦å®‰è£…nodeçš„è·¯å¾„ä¸‹å»ºç«‹ä¸€ä¸ªæ–°çš„æ–‡ä»¶å¤¹ï¼Œé¿å…è£…åœ¨æ ¹ç›®å½•ä¸‹</p>
<p>åœ¨æ–°çš„æ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œå‘½ä»¤å®‰è£…hexo</p>
<figure class="highlight cmake"><table><tr><td class="code"><pre><code class="hljs cmake">npm <span class="hljs-keyword">install</span> hexo<br></code></pre></td></tr></table></figure>
<p>æµ‹è¯•hexoå‘½ä»¤</p>
<h1 id="å®‰è£…å„ç§æ’ä»¶">å®‰è£…å„ç§æ’ä»¶</h1>
<h2 id="pandocæ¸²æŸ“latexå…¬å¼">pandocæ¸²æŸ“latexå…¬å¼</h2>
<p>å…ˆåœ¨å®˜ç½‘å®‰è£…pandocçš„åŒ…</p>
<p><a href="https://pandoc.org/installing.html">Installing
pandoc</a></p>
<p>å†æ‰§è¡Œå‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">npm install hexo-renderer-pandoc --save<br></code></pre></td></tr></table></figure>
<h2 id="å®‰è£…mermaidæµç¨‹å›¾æ’ä»¶">å®‰è£…mermaidæµç¨‹å›¾æ’ä»¶</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">npm install --save hexo-filter-mermaid-diagrams<br></code></pre></td></tr></table></figure>
<p>å®‰è£…åä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦ä¿®æ”¹éƒ¨åˆ†æ–‡ä»¶ï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹</p>
<p>å‚è€ƒæ–‡ç« ï¼š</p>
<p><a href="https://ash-one.github.io/2022/07/12/hexo-bo-ke-zai-matery-zhu-ti-xia-cha-ru-mermaid-liu-cheng-tu/">Hexoåšå®¢åœ¨materyä¸»é¢˜ä¸‹æ’å…¥mermaidæµç¨‹å›¾</a></p>
<h2 id="å®‰è£…æ”¯æŒæœ¬åœ°å›¾ç‰‡çš„æ’ä»¶">å®‰è£…æ”¯æŒæœ¬åœ°å›¾ç‰‡çš„æ’ä»¶</h2>
<ol type="1">
<li><p>æ’ä»¶å®‰è£…</p>
<p><figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">npm install hexo-asset-image --save<br></code></pre></td></tr></table></figure></p></li>
<li><p>ç”±äºæ’ä»¶å†…å®¹è€æ—§å¤±æ•ˆï¼Œæ‰¾åˆ°æ–‡ä»¶è¿›è¡Œä¿®æ”¹</p>
<p>ä½ç½®åœ¨/node_modules/hexo-asset-image/index.js</p>
<p><figure class="highlight jsx"><table><tr><td class="code"><pre><code class="hljs jsx"><span class="hljs-meta">&#x27;use strict&#x27;</span>;<br><span class="hljs-keyword">var</span> cheerio = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;cheerio&#x27;</span>);<br><br><span class="hljs-comment">// http://stackoverflow.com/questions/14480345/how-to-get-the-nth-occurrence-in-a-string</span><br><span class="hljs-keyword">function</span> <span class="hljs-title function_">getPosition</span>(<span class="hljs-params">str, m, i</span>) &#123;<br>  <span class="hljs-keyword">return</span> str.<span class="hljs-title function_">split</span>(m, i).<span class="hljs-title function_">join</span>(m).<span class="hljs-property">length</span>;<br>&#125;<br><br><span class="hljs-keyword">var</span> version = <span class="hljs-title class_">String</span>(hexo.<span class="hljs-property">version</span>).<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;.&#x27;</span>);<br>hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">filter</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;after_post_render&#x27;</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">data</span>)&#123;<br>  <span class="hljs-keyword">var</span> config = hexo.<span class="hljs-property">config</span>;<br>  <span class="hljs-keyword">if</span>(config.<span class="hljs-property">post_asset_folder</span>)&#123;<br>    	<span class="hljs-keyword">var</span> link = data.<span class="hljs-property">permalink</span>;<br>	<span class="hljs-keyword">if</span>(version.<span class="hljs-property">length</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-title class_">Number</span>(version[<span class="hljs-number">0</span>]) == <span class="hljs-number">3</span>)<br>	   <span class="hljs-keyword">var</span> beginPos = <span class="hljs-title function_">getPosition</span>(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">1</span>) + <span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">else</span><br>	   <span class="hljs-keyword">var</span> beginPos = <span class="hljs-title function_">getPosition</span>(link, <span class="hljs-string">&#x27;/&#x27;</span>, <span class="hljs-number">3</span>) + <span class="hljs-number">1</span>;<br>	<span class="hljs-comment">// In hexo 3.1.1, the permalink of &quot;about&quot; page is like &quot;.../about/index.html&quot;.</span><br>	<span class="hljs-keyword">var</span> endPos = link.<span class="hljs-title function_">lastIndexOf</span>(<span class="hljs-string">&#x27;/&#x27;</span>) + <span class="hljs-number">1</span>;<br>    link = link.<span class="hljs-title function_">substring</span>(beginPos, endPos);<br><br>    <span class="hljs-keyword">var</span> toprocess = [<span class="hljs-string">&#x27;excerpt&#x27;</span>, <span class="hljs-string">&#x27;more&#x27;</span>, <span class="hljs-string">&#x27;content&#x27;</span>];<br>    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; toprocess.<span class="hljs-property">length</span>; i++)&#123;<br>      <span class="hljs-keyword">var</span> key = toprocess[i];<br> <br>      <span class="hljs-keyword">var</span> $ = cheerio.<span class="hljs-title function_">load</span>(data[key], &#123;<br>        <span class="hljs-attr">ignoreWhitespace</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">xmlMode</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">lowerCaseTags</span>: <span class="hljs-literal">false</span>,<br>        <span class="hljs-attr">decodeEntities</span>: <span class="hljs-literal">false</span><br>      &#125;);<br><br>      $(<span class="hljs-string">&#x27;img&#x27;</span>).<span class="hljs-title function_">each</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)&#123;<br>		<span class="hljs-keyword">if</span> ($(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>))&#123;<br>			<span class="hljs-comment">// For windows style path, we replace &#x27;\&#x27; to &#x27;/&#x27;.</span><br>			<span class="hljs-keyword">var</span> src = $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>).<span class="hljs-title function_">replace</span>(<span class="hljs-string">&#x27;\\&#x27;</span>, <span class="hljs-string">&#x27;/&#x27;</span>);<br>			<span class="hljs-keyword">if</span>(!<span class="hljs-regexp">/http[s]*.*|\/\/.*/</span>.<span class="hljs-title function_">test</span>(src) &amp;&amp;<br>			   !<span class="hljs-regexp">/^\s*\//</span>.<span class="hljs-title function_">test</span>(src)) &#123;<br>			  <span class="hljs-comment">// For &quot;about&quot; page, the first part of &quot;src&quot; can&#x27;t be removed.</span><br>			  <span class="hljs-comment">// In addition, to support multi-level local directory.</span><br>			  <span class="hljs-keyword">var</span> linkArray = link.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)&#123;<br>				<span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span>;<br>			  &#125;);<br>			  <span class="hljs-keyword">var</span> srcArray = src.<span class="hljs-title function_">split</span>(<span class="hljs-string">&#x27;/&#x27;</span>).<span class="hljs-title function_">filter</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">elem</span>)&#123;<br>				<span class="hljs-keyword">return</span> elem != <span class="hljs-string">&#x27;&#x27;</span> &amp;&amp; elem != <span class="hljs-string">&#x27;.&#x27;</span>;<br>			  &#125;);<br>			  <span class="hljs-keyword">if</span>(srcArray.<span class="hljs-property">length</span> &gt; <span class="hljs-number">1</span>)<br>				srcArray.<span class="hljs-title function_">shift</span>();<br>			  src = srcArray.<span class="hljs-title function_">join</span>(<span class="hljs-string">&#x27;/&#x27;</span>);<br>			  $(<span class="hljs-variable language_">this</span>).<span class="hljs-title function_">attr</span>(<span class="hljs-string">&#x27;src&#x27;</span>, config.<span class="hljs-property">root</span> + link + src);<br>			  <span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&quot;update link as:--&gt;&quot;</span>+config.<span class="hljs-property">root</span> + link + src);<br>			&#125;<br>		&#125;<span class="hljs-keyword">else</span>&#123;<br>			<span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">&quot;no src attr, skipped...&quot;</span>);<br>			<span class="hljs-variable language_">console</span>.<span class="hljs-property">info</span>&amp;&amp;<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>($(<span class="hljs-variable language_">this</span>));<br>		&#125;<br>      &#125;);<br>      data[key] = $.<span class="hljs-title function_">html</span>();<br>    &#125;<br>  &#125;<br>&#125;);<br></code></pre></td></tr></table></figure></p></li>
<li><p>æ‰“å¼€hexoé…ç½®æ–‡ä»¶_config.ymlï¼Œæ‰¾åˆ°è¿™ä¸ªé…ç½®é¡¹å¼€å¯åŠŸèƒ½ï¼Œç›®çš„æ˜¯åœ¨æ¯æ¬¡ä½¿ç”¨hexo
newç”Ÿæˆæ–°åšå®¢æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªåŒåçš„ç›®å½•å­˜æ”¾é™æ€æ–‡ä»¶</p>
<p><figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-attr">post_asset_folder:</span> <span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure></p></li>
</ol>
<p>å¯ä»¥ç”Ÿæˆæµ‹è¯•æ˜¯å¦èƒ½æ­£å¸¸åŠ è½½blogä¸­çš„æœ¬åœ°å›¾ç‰‡</p>
<p>å¦‚æœæ²¡èƒ½æ­£ç¡®ç”Ÿæˆå¯ä»¥ä½¿ç”¨å‘½ä»¤æ¸…ç†æ–‡ä»¶é‡æ–°ç¼–è¯‘</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">hexo clean<br></code></pre></td></tr></table></figure>
<h1 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h1>
<p><a href="https://juejin.cn/post/7006594302604214280">è§£å†³hexoå¼•ç”¨æœ¬åœ°å›¾ç‰‡æ— æ³•æ˜¾ç¤ºçš„é—®é¢˜
- æ˜é‡‘</a></p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>é…ç½®</tag>
        <tag>blog</tag>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>VALL-E</title>
    <url>/2023/01/13/vall-e/</url>
    <content><![CDATA[<h1 id="vall-e">VALL-E</h1>
<h2 id="æ¨¡å‹">æ¨¡å‹</h2>
<p>ä½¿ç”¨60kå°æ—¶è‹±è¯­è¯­éŸ³è®­ç»ƒï¼Œä½¿å¾—æ¨¡å‹å‡ºç°ä¸Šä¸‹æ–‡å­¦ä¹ èƒ½åŠ›ã€‚åªéœ€è¦3ç§’ç‰¹å®šå½•éŸ³ï¼Œå°±å¯ä»¥å­¦ä¹ åˆ°è¯´è¯äººçš„è¯´è¯æ–¹å¼ï¼Œç”šè‡³æ˜¯èƒŒæ™¯éŸ³ã€‚</p>
<p>demoæ¼”ç¤ºï¼š<a href="https://valle-demo.github.io/">https://valle-demo.github.io/</a></p>
<figure>
<img src="/2023/01/13/vall-e/model.png" alt="æ¨¡å‹æ€»è§ˆ">
<figcaption aria-hidden="true">æ¨¡å‹æ€»è§ˆ</figcaption>
</figure>
<h2 id="éŸ³é¢‘é‡åŒ–-speech-quantization">éŸ³é¢‘é‡åŒ– Speech Quantization</h2>
<p>å¯¹äºå¸¸è§çš„ä¸€ç§’éŸ³é¢‘ï¼Œ16ä½ï¼Œ48kHzï¼Œæ„å‘³ç€éœ€è¦æ¯ä¸ªstepæœ‰<span class="math inline">\(2^{16}=65536\)</span>ä¸ªå€¼ï¼Œæ•´ä¸ªåºåˆ—é•¿åº¦æ¥è¿‘5ä¸‡ã€‚è¯­éŸ³é‡åŒ–çš„ç›®çš„æ˜¯å‹ç¼©è¿™ä¸¤ä¸ªæ•°å€¼ã€‚</p>
<p>Wavenetä¸­æ›¾ä½¿ç”¨<span class="math inline">\(\mu\)</span>-lawå˜æ¢å¯ä»¥ä½¿ç”¨256ä¸ªå€¼é‡å»ºé«˜è´¨é‡éŸ³é¢‘ï¼Œå‹ç¼©ä¸€åŠï¼Œä½†æ²¡æœ‰å‡å°‘åºåˆ—é•¿åº¦ã€‚</p>
<p>åé¢å‡ºç°äº†çŸ¢é‡é‡åŒ–ï¼ˆvector
quantizationï¼‰ï¼Œåº”ç”¨åœ¨vq-wav2vecã€HuBERTã€‚</p>
<p>æ–‡ç« é‡‡ç”¨AudioLMçš„æ–¹æ³•ï¼Œç¥ç»ç¼–ç è§£ç å™¨æ¨¡å‹ï¼ˆneural codec
modelsï¼‰ï¼Œä¼˜ç‚¹å¦‚ä¸‹ï¼š</p>
<ul>
<li>åœ¨ä½æ¯”ç‰¹ç‡ä¸‹è¡¨ç°æ¯”ä¼ ç»ŸéŸ³é¢‘ç¼–è§£ç å™¨æ›´å¥½ã€‚</li>
<li>åŒ…å«è¯´è¯äººä¿¡æ¯å’Œå£°å­¦ä¿¡æ¯ï¼ŒHuBERTåšä¸åˆ°ä¿å­˜è¯´è¯äººä¿¡æ¯ã€‚</li>
<li>æœ‰å­¦è€…æå‡ºçš„ç°æœ‰çš„è§£ç å™¨ï¼Œç”¨äºå°†ç¦»æ•£æ ‡è®°è½¬æ¢ä¸ºæ³¢å½¢ï¼Œä¸ç”¨è®¾è®¡è§£ç å™¨ã€‚ğŸ¤£</li>
<li>å¯ä»¥åšåˆ°å‡å°‘æ—¶é—´åºåˆ—é•¿åº¦ã€‚</li>
</ul>
<p>æ–‡ç« é‡‡ç”¨é¢„è®­ç»ƒçš„ç¥ç»éŸ³é¢‘ç¼–è§£ç å™¨æ¨¡å‹EnCodecä½œä¸ºtokenizerï¼Œç”Ÿæˆå£°å­¦ä»£ç çŸ©é˜µï¼ˆacoustic
code
matrixï¼‰ã€‚EnCodecæ˜¯ä¸€ç§å·ç§¯ç¼–ç å™¨-è§£ç å™¨æ¨¡å‹ï¼Œå…¶è¾“å…¥å’Œè¾“å‡ºå‡ä¸ºå¯å˜æ¯”ç‰¹ç‡çš„24kHzéŸ³é¢‘ã€‚å…¶ç¼–ç å™¨å°†24kHzçš„è¾“å…¥æ³¢å½¢ç”Ÿæˆ75Hzçš„åµŒå…¥ï¼Œé‡‡æ ·ç‡é™ä½äº†320å€ã€‚æ¯ä¸ªåµŒå…¥éƒ½é€šè¿‡æ®‹å·®çŸ¢é‡é‡åŒ–(RVQ)å»ºæ¨¡ï¼Œå…«ä¸ªé‡åŒ–å™¨æ¯ä¸ªæœ‰1024ä¸ªæ¡ç›®ã€‚</p>
<figure>
<img src="/2023/01/13/vall-e/EnCodec.png" alt="RVQ">
<figcaption aria-hidden="true">RVQ</figcaption>
</figure>
<p>å¯¹äºVQ1ä½¿ç”¨ARå­¦ä¹ åˆ°é‡è¦çš„è¯´è¯äººç‰¹å¾ï¼ŒVQ2-8ä½¿ç”¨NARå­¦ä¹ å…¶ä»–ç‰¹å¾ã€‚</p>
<h2 id="æ¨¡å‹-1">æ¨¡å‹</h2>
<p>ä¼˜åŒ–ç›®æ ‡ï¼š<span class="math inline">\(\max p(C|x,\tilde
C)\)</span></p>
<figure>
<img src="/2023/01/13/vall-e/LM.png" alt="LM">
<figcaption aria-hidden="true">LM</figcaption>
</figure>
<h2 id="æ¨ç†">æ¨ç†</h2>
<p>å°†æ–‡æœ¬è½¬æ¢ä¸ºéŸ³ç´ åºåˆ—ï¼Œå¹¶å°†ç™»è®°çš„å½•éŸ³ç¼–ç ä¸ºå£°å­¦çŸ©é˜µï¼Œå½¢æˆéŸ³ç´ æç¤ºå’Œå£°å­¦æç¤ºã€‚å£°å­¦æç¤ºå¯èƒ½ä¸è¦åˆæˆçš„è¯­éŸ³åœ¨è¯­ä¹‰ä¸Šç›¸å…³ï¼Œä¹Ÿå¯èƒ½ä¸ç›¸å…³ï¼Œå¯¼è‡´ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>VALL-Eï¼šåªå­¦ä¹ promptè¯­éŸ³çš„å£°å­¦æ¡ä»¶ï¼ŒæŒ‰ç…§æ–‡æœ¬ç”Ÿæˆè¯­éŸ³ã€‚</li>
<li>VALL-E-continualï¼šæŒ‰ç…§å®Œæ•´promptè¯­éŸ³è½¬å½•çš„æ–‡æœ¬ä½œä¸ºéŸ³ç´ æç¤ºï¼Œä½¿ç”¨è¯­éŸ³çš„å‰3ç§’ä½œä¸ºå£°å­¦æç¤ºï¼Œç”Ÿæˆçš„è¯­éŸ³è¯­ä¹‰ä¸Šæ¥ç€promptè¯­éŸ³ã€‚</li>
</ul>
<h2 id="æ•°æ®">æ•°æ®</h2>
<p>LibriLightåŒ…å«è‹±è¯­æœ‰å£°è¯»ç‰©60Kå°æ—¶æ— æ ‡è®°è¯­éŸ³ï¼Œè¯´è¯äººæ•°é‡çº¦7000</p>
<p>ä½¿ç”¨Kaldiçš„ASRæ¨¡å‹ï¼Œä¸ºæ— æ ‡è®°è¯­éŸ³æ•°æ®ç”ŸæˆéŸ³ç´ å’Œå¯¹é½ã€‚</p>
<p>å°†å¹³å‡é•¿åº¦ä¸º60ç§’çš„éŸ³é¢‘éšæœºè£å‰ªä¸º10-20ç§’çš„éšæœºé•¿åº¦ï¼Œå…¶å¯¹åº”çš„éŸ³ç´ åºåˆ—ä½œä¸ºpromptã€‚åœ¨NARä¸­çš„promptä¼šä½¿ç”¨åŒä¸€æ®µè¯ä¸­çš„3ç§’éšæœºéŸ³é¢‘ã€‚</p>
<p>16ä¸ª NVIDIA TESLA V100
32GBï¼Œæ¯ä¸ªGPUçš„æ‰¹é‡å¤§å°ä¸º6kå£°å­¦æ ‡è®°ï¼Œ800kæ­¥ã€‚ä½¿ç”¨AdamWä¼˜åŒ–å™¨ä¼˜åŒ–æ¨¡å‹ï¼Œå‰32kæ­¥æ›´æ–°çš„å­¦ä¹ ç‡é¢„çƒ­åˆ°
5 Ã— 10âˆ’4 çš„å³°å€¼ï¼Œç„¶åå¯¹å…¶è¿›è¡Œçº¿æ€§è¡°å‡ã€‚</p>
<h2 id="åˆ†æ">åˆ†æ</h2>
<ul>
<li>å¤šæ ·æ€§ä¸°å¯Œï¼šåŸæœ¬çš„melè°±å›¾ç”ŸæˆåŸºäºæ¯ä¸ªæ­¥éª¤çš„é‡å»ºï¼Œå…¶éšæœºæ€§è¾ƒå·®ï¼Œç”±äºVALL-Eä½¿ç”¨é‡‡æ ·çš„æ–¹å¼ç”Ÿæˆç¦»æ•£æ ‡è®°ï¼Œç›¸åŒæ–‡æœ¬çš„è¾“å‡ºä¸åŒï¼Œå…¶å¤šæ ·æ€§ä¸°å¯Œã€‚</li>
<li>èƒ½ä¿æŒç¯å¢ƒéŸ³ï¼šä½œè€…è®¤ä¸ºï¼ŒVALL-Eçš„æ•°æ®é›†å£°å­¦æ¡ä»¶æ›´å¤šï¼Œå½“promptå¸¦æœ‰æ··å“ï¼Œbaselineå¾—åˆ°çš„æ˜¯å¹²å‡€çš„å£°éŸ³ï¼ŒVALL-Eå¯ä»¥å¾—åˆ°ç›¸åŒçš„æ··å“æ•ˆæœã€‚</li>
<li>èƒ½ä¿æŒè¯´è¯äººçš„æƒ…ç»ªï¼šemotionalã€‚å¯ä»¥åœ¨0-shotæ¡ä»¶ä¸‹ä¿ç•™promptä¸­çš„æƒ…ç»ªã€‚</li>
<li>é²æ£’æ€§æœ‰å¾…æå‡ï¼šç”±äºVQ1æ˜¯è‡ªå›å½’æ¨¡å‹ï¼Œå…¶ä¸­çš„transformeræ³¨æ„åŠ›æ— åºï¼Œä¹Ÿæ²¡æœ‰å¢åŠ çº¦æŸï¼Œå¯¼è‡´åœ¨åˆæˆç»“æœä¸­å‡ºç°ä¸æ¸…æ¥šã€é—æ¼å’Œé‡å¤çš„é—®é¢˜ã€‚</li>
<li>æ•°æ®è¦†ç›–æœ‰é™ï¼šç”±äºæ˜¯æœ‰å£°è¯»ç‰©ï¼Œå£éŸ³æ²¡æœ‰è¦†ç›–å®Œå…¨ï¼Œå¹¶ä¸”åªæœ‰é˜…è¯»é£æ ¼ï¼Œéœ€è¦æ‰©å¤§è¦†ç›–èŒƒå›´ã€‚</li>
<li>æ¨¡å‹çš„æ»¥ç”¨é£é™©ï¼šä¼ªé€ æ”¿å®¢ã€ç”µä¿¡è¯ˆéª—ç­‰åº”ç”¨è¾ƒä¸ºå±é™©ã€‚ç±»ä¼¼äºgoogleçš„AudioLMå¯èƒ½éœ€è¦åŒæ—¶æ¨å‡ºä¸€ä¸ªåˆ†ç±»å™¨ç”¨äºåŒºåˆ†æ£€æµ‹VALL-Eçš„åˆæˆè¯­éŸ³ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>è¯­éŸ³åˆæˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>PythonåŸºç¡€çŸ¥è¯†ç‚¹</title>
    <url>/2021/09/18/python-ji-chu-zhi-shi-dian/</url>
    <content><![CDATA[<h1 id="pythonåŸºç¡€çŸ¥è¯†ç‚¹">PythonåŸºç¡€çŸ¥è¯†ç‚¹</h1>
<blockquote>
<p>æœ¬ç¯‡ä¸ºç»™é«˜äºŒå­¦ç”Ÿä¸Šè¯¾ç”¨çš„å¤ä¹ å†…å®¹, é«˜äºŒå­¦ç”Ÿéƒ½èƒ½çœ‹æ‡‚!!!</p>
</blockquote>
<h2 id="æ•°æ®ç±»å‹6ä¸ª">æ•°æ®ç±»å‹6ä¸ª</h2>
<ol type="1">
<li><strong>æ•´å‹ int</strong><br>
æ•°å­¦ä¸­çš„æ•´æ•°ï¼Œå¦‚1ï¼Œ-8080ï¼Œ0<br>
</li>
<li><strong>å®å‹ï¼ˆæµ®ç‚¹æ•°ï¼‰float</strong><br>
æ•°å­¦ä¸­çš„å®æ•°ï¼Œå¦‚3.14ï¼Œ9e-4<br>
</li>
<li><strong>å­—ç¬¦ä¸² string</strong><br>
ä»¥å¼•å·å¼€å§‹ç»“æŸçš„ä¸€ä¸²å­—ç¬¦ï¼Œå¦‚<code>'this is a string'</code><br>
</li>
<li><strong>å¸ƒå°”å‹ bool</strong><br>
åªæœ‰<code>True</code>å’Œ<code>False</code>ä¸¤ä¸ªå€¼<br>
</li>
<li><strong>åˆ—è¡¨ list</strong><br>
ä»¥ä¸­æ‹¬å·å¼€å§‹ç»“æŸçš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œå¦‚<code>[1,2,3,4,5]</code><br>
</li>
<li><strong>å­—å…¸ dictionary</strong><br>
ä»¥å¤§æ‹¬å·å¼€å§‹ç»“æŸï¼Œå­˜å‚¨å†…å®¹ä¸ºé”®å€¼å¯¹ï¼Œå¦‚<code>&#123;'name':'wow','age':17&#125;</code><br>
å–å‡ºä¸‹åˆ—å­—å…¸ä¸­çš„'name'é”®å¯¹åº”çš„å€¼ï¼š <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">d=&#123;<span class="hljs-string">&#x27;name&#x27;</span>:<span class="hljs-string">&#x27;wow&#x27;</span>,<span class="hljs-string">&#x27;age&#x27;</span>:<span class="hljs-number">17</span>&#125;  <br>d[<span class="hljs-string">&#x27;name&#x27;</span>]=<br></code></pre></td></tr></table></figure> #### ç´¢å¼•ä¸åˆ‡ç‰‡
è¯·å†™å‡ºä¸‹åˆ—ç´¢å¼•ä¸åˆ‡ç‰‡çš„ç»“æœ <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">info=[<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27;what&#x27;</span>,<span class="hljs-number">5432</span>]  <br>info2=[ [<span class="hljs-string">&#x27;world&#x27;</span>,<span class="hljs-string">&#x27;you&#x27;</span>],[<span class="hljs-number">231</span>,<span class="hljs-string">&#x27;how&#x27;</span>] ]   <br>info[<span class="hljs-number">1</span>]=  <br>info[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=  <br>info[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]=  <br>info2[<span class="hljs-number">0</span>]=  <br>info2[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=  <br>info2[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]=  <br>info2[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>][<span class="hljs-number">1</span>:<span class="hljs-number">3</span>]=  <br></code></pre></td></tr></table></figure> ***</li>
</ol>
<h2 id="è¿ç®—ç¬¦">è¿ç®—ç¬¦</h2>
<h3 id="ç®—æ•°è¿ç®—ç¬¦">ç®—æ•°è¿ç®—ç¬¦</h3>
<p><code>+-*/</code>åŠ å‡ä¹˜é™¤ <code>//</code>æ•´é™¤ï¼Œç»“æœå–æ•´æ•°éƒ¨åˆ†<br>
<code>%</code>å–ä½™æ•° <code>**</code>ä¹˜æ–¹</p>
<p><em>ç®—æ•°è¿ç®—ç¬¦å¾—åˆ°çš„ç»“æœä¸ºæ•°</em> ### å…³ç³»è¿ç®—ç¬¦
<code>&gt;&lt;</code>å¤§äºå°äº <code>&gt;= &lt;=</code>å¤§äºç­‰äº
å°äºç­‰äº<br>
<code>==</code>ç­‰äº<code>!=</code>ä¸ç­‰äº<br>
<code>in</code>åŒ…å«äº</p>
<p><em>å…³ç³»è¿ç®—å¾—åˆ°çš„ç»“æœä¸ºå¸ƒå°”å‹ï¼Œå³<code>True</code>å’Œ<code>False</code></em></p>
<h3 id="é€»è¾‘è¿ç®—ç¬¦">é€»è¾‘è¿ç®—ç¬¦</h3>
<p><code>and</code>ä¸è¿ç®—ï¼Œåªæœ‰ä¸¤ä¸ª<code>True</code>ç»“æœæ‰ä¸º<code>True</code><br>
<code>or</code>
æˆ–è¿ç®—ï¼Œåªè¦æœ‰ä¸€ä¸ª<code>True</code>ç»“æœå°±ä¸º<code>True</code><br>
<code>not</code>éè¿ç®—ï¼Œ<code>not True</code>ç»“æœä¸º<code>False</code></p>
<p><em>é€»è¾‘è¿ç®—å¾—åˆ°çš„ç»“æœä¸ºå¸ƒå°”å‹ï¼Œå³<code>True</code>å’Œ<code>False</code></em></p>
<hr>
<h2 id="å˜é‡å’Œèµ‹å€¼">å˜é‡å’Œèµ‹å€¼</h2>
<p><strong>å¸¸é‡</strong>ï¼š0ï¼Œ3.14ï¼Œ60000ï¼Œpiï¼Œeç­‰æ•°å­¦ä¸Šçš„å®¢è§‚æ•°å­—<br>
<strong>å˜é‡</strong>ï¼šåœ¨ç¼–ç¨‹ä¸­å£°æ˜/å®šä¹‰çš„ä¸€ä¸ªä»£å·ï¼Œç”¨äºå­˜å‚¨æ•°æ®ã€‚å˜é‡åå¯ä»¥åŒ…æ‹¬å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œä¸å¯ä»¥ç”¨æ•°å­—å¼€å¤´</p>
<p><strong>èµ‹å€¼è¯­å¥</strong><br>
<code>=</code>ç”¨äºèµ‹å€¼ï¼Œå°†ç­‰å·å³ä¾§çš„å€¼èµ‹ç»™å·¦ä¾§çš„å˜é‡<br>
&gt;n=0 #å°†0èµ‹å€¼ç»™å˜é‡n<br>
n=n+1 #å°†n+1çš„å€¼èµ‹ç»™å˜é‡n<br>
n+=1 #å°†n+1çš„å€¼èµ‹ç»™å˜é‡nï¼Œå³nçš„å€¼å¢åŠ 1</p>
<p><em>æ³¨æ„ï¼š<code>==</code>å’Œ<code>=</code>åœ¨ç”¨æ³•ä¸Šå®Œå…¨ä¸åŒ</em></p>
<h2 id="å¸¸ç”¨å‡½æ•°">å¸¸ç”¨å‡½æ•°</h2>
<p><code>print(x)</code>è¾“å‡ºxçš„å€¼<br>
<code>input(x)</code>å°†xçš„å€¼è¾“å‡ºåœ¨å±å¹•ä¸Šï¼Œå¹¶è¯»å–ç”¨æˆ·çš„è¾“å…¥ï¼Œä»¥å­—ç¬¦ä¸²å­˜å‚¨<br>
<code>int(x)</code>å°†xè½¬æ¢ä¸ºæ•´å‹<br>
<code>float(x)</code>å°†xè½¬æ¢ä¸ºæµ®ç‚¹æ•°</p>
<hr>
<h2 id="åˆ†æ”¯ç»“æ„">åˆ†æ”¯ç»“æ„</h2>
<blockquote>
<p>if æ¡ä»¶:<br>
â€ƒâ€ƒè¯­å¥<br>
elif æ¡ä»¶:<br>
â€ƒâ€ƒè¯­å¥<br>
else:<br>
â€ƒâ€ƒè¯­å¥</p>
</blockquote>
<p>ä¾‹ï¼š<br>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">if</span> x%<span class="hljs-number">2</span>==<span class="hljs-number">0</span>:  <br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å¶æ•°&#x27;</span>)  <br>esle:  <br>		<span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;å¥‡æ•°&#x27;</span>)<br></code></pre></td></tr></table></figure></p>
<h2 id="å¾ªç¯ç»“æ„">å¾ªç¯ç»“æ„</h2>
<h4 id="forå¾ªç¯">forå¾ªç¯</h4>
<p>åºåˆ—éå†å®Œæˆåé€€å‡ºå¾ªç¯ &gt;for å˜é‡ in åºåˆ—:<br>
â€ƒâ€ƒå¾ªç¯ä½“</p>
<p>ä¾‹ï¼š<br>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">s=<span class="hljs-number">0</span>  <br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">101</span>,<span class="hljs-number">1</span>):  <br>		s+=i  <br>		<span class="hljs-built_in">print</span>(i)  <br></code></pre></td></tr></table></figure> #### whileå¾ªç¯
å¾ªç¯æ¡ä»¶ä¸º<code>True</code>æ—¶è¿›å…¥å¾ªç¯ï¼Œå¦åˆ™é€€å‡ºå¾ªç¯<br>
&gt;while å¾ªç¯æ¡ä»¶:<br>
â€ƒâ€ƒå¾ªç¯ä½“</p>
<p>ä¾‹ï¼š<br>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">s=<span class="hljs-number">0</span>  <br>i=<span class="hljs-number">0</span>  <br><span class="hljs-keyword">while</span> i&lt;=<span class="hljs-number">100</span>:  <br>    s+=i<br>    i+=<span class="hljs-number">1</span><br>    <span class="hljs-built_in">print</span>(i)<br><span class="hljs-built_in">print</span>(s)<br></code></pre></td></tr></table></figure></p>
<p><strong><em>ä»£ç é™¤äº†æ¨ªå‘é˜…è¯»ï¼Œä¹Ÿè¦çºµå‘é˜…è¯»</em></strong><br>
<strong><em>æ¨ªå‘é˜…è¯»çœ‹<code>åŠŸèƒ½</code>ï¼Œçºµå‘é˜…è¯»çœ‹<code>ç»“æ„</code></em></strong><br>
<strong><em>æ³¨æ„å¾ªç¯ä½“å’Œåˆ†æ”¯ç»“æ„è¯­å¥å—çš„ç¼©è¿›</em></strong></p>
<hr>
<h2 id="ä¹ é¢˜">ä¹ é¢˜</h2>
<p>ä½¿ç”¨forå¾ªç¯å’Œwhileå¾ªç¯ä¸¤ç§æ–¹å¼è®¡ç®—[100,1000]ä¸­æ‰€æœ‰å¥‡æ•°çš„å’Œ<br>
è¯·åœ¨ä¸‹æ–¹ä¹¦å†™<br>
<em>æç¤ºï¼šåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¶æ•°è¿˜æ˜¯å¥‡æ•°æ˜¯ç”¨ä½™æ•°çš„æ–¹å¼</em></p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>ä¿¡æ¯æŠ€æœ¯</tag>
        <tag>æ”¯æ•™</tag>
      </tags>
  </entry>
  <entry>
    <title>esxiå®‰è£…é»‘ç¾¤æ™–è®°å½•</title>
    <url>/2022/10/02/esxi-an-zhuang-hei-qun-hui-ji-lu/</url>
    <content><![CDATA[<h1 id="esxiç³»ç»Ÿå®‰è£…">esxiç³»ç»Ÿå®‰è£…</h1>
<p>ç”¨Uç›˜åˆ·å¥½ç³»ç»Ÿï¼Œå…·ä½“çœç•¥</p>
<h1 id="å‡†å¤‡">å‡†å¤‡</h1>
<h2 id="é•œåƒ">é•œåƒ</h2>
<p>é»‘ç¾¤æ™–é•œåƒé“¾æ¥:
https://pan.baidu.com/s/1ZOLCEvfAgF0tTZRkMt3MjA?pwd=ya4g</p>
<p>å…¶ä¸­ä¸åŒé•œåƒå¯¹åº”çš„å°±æ˜¯ä¸åŒçš„ç¾¤æ™–ç¡¬ä»¶ï¼Œæˆ‘ä¸€å¼€å§‹ä½¿ç”¨çš„ds918+ä¸€ç›´å¡åœ¨æœ€åä¸€æ­¥å®‰è£…å¤±è´¥ï¼Œæ‰€ä»¥åé¢é€‰ç”¨çš„<strong>ds2617xs</strong></p>
<p>é•œåƒåˆ†ä¸ºå¼•å¯¼æ–‡ä»¶(.img)å’Œç³»ç»Ÿå®‰è£…åŒ…(.pat)ï¼Œè¦ä¸‹è½½å¥½å¯¹åº”çš„ç‰ˆæœ¬</p>
<h2 id="ç¡¬ä»¶å‡†å¤‡">ç¡¬ä»¶å‡†å¤‡</h2>
<p>æœ€å¥½å‡†å¤‡ä¸€å—ä»¥ä¸Šæœªä½¿ç”¨çš„ç¡¬ç›˜ï¼Œä¸“é—¨ä¸ºé»‘ç¾¤æ™–ä½¿ç”¨åšæ•°æ®ç›˜ï¼Œé˜²æ­¢å„ç§ç¯èŠ‚ä¸Šå‡ºé”™</p>
<h2 id="imgè½¬vmdk">imgè½¬vmdk</h2>
<h3 id="æœ¬åœ°qemuå·¥å…·è½¬æ¢">æœ¬åœ°qemuå·¥å…·è½¬æ¢</h3>
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œesxiçš„ç³»ç»Ÿéœ€è¦å•ç‹¬åˆ¶ä½œvmdkæ–‡ä»¶</p>
<p>å¯¹äºimgæ–‡ä»¶ï¼Œä»¥Macä¸ºä¾‹ï¼Œä½¿ç”¨å¸¸ç”¨çš„<code>qemu</code>å·¥å…·è½¬æ¢</p>
<p>æ²¡å®‰è£…qemuçš„å…ˆä½¿ç”¨brewå®‰è£…</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">brew install qemu<br></code></pre></td></tr></table></figure>
<p>qemuè½¬æ¢imgä¸ºvmdkçš„å‘½ä»¤ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">qemu-img convert -f raw name.img -O vmdk name.vmdk<br></code></pre></td></tr></table></figure>
<p>æ­¤æ—¶æˆ‘ä»¬çš„vmdk<u>è¿˜ä¸èƒ½åœ¨esxiä¸Šç›´æ¥ä½¿ç”¨</u>ï¼Œå¿…é¡»ä½¿ç”¨esxiçš„å‘½ä»¤å†è½¬æ¢ä¸€æ¬¡</p>
<h3 id="ä¸Šä¼ åˆ°esxiç³»ç»Ÿè½¬æ¢">ä¸Šä¼ åˆ°esxiç³»ç»Ÿè½¬æ¢</h3>
<ol type="1">
<li><p><strong>å³é”®ä¸»æœº-æœåŠ¡-å¯ç”¨å®‰å…¨Shell</strong>ï¼Œæ‰“å¼€esxiçš„sshç™»é™†ï¼Œç„¶åé€šè¿‡sshç™»é™†åå°</p>
<figure>
<img src="https://s2.loli.net/2022/10/02/945pvVtThizKP2n.png" alt="å¯åŠ¨SSH">
<figcaption aria-hidden="true">å¯åŠ¨SSH</figcaption>
</figure></li>
<li><p><strong>å³é”®å­˜å‚¨-æµè§ˆæ•°æ®å­˜å‚¨</strong>
ç‚¹å‡»ä¸Šè½½ï¼Œå°†æœ¬åœ°çš„vmdkä¸Šä¼ åˆ°esxiä¸Š</p></li>
<li><p>åœ¨sshä¼šè¯ä¸­æ‰¾åˆ°ä¸Šä¼ çš„æ–‡ä»¶ï¼Œ<code>/vmfs/volumes/</code>ä¸‹æ˜¯ç¡¬ç›˜</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> /vmfs/volumes/datastore1/<br></code></pre></td></tr></table></figure>
<figure>
<img src="https://s2.loli.net/2022/10/02/tHPp8UrCVEAXMfF.png" alt="æŸ¥çœ‹è·¯å¾„">
<figcaption aria-hidden="true">æŸ¥çœ‹è·¯å¾„</figcaption>
</figure></li>
<li><p>æ‰§è¡Œè½¬æ¢å‘½ä»¤</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus">vmkfstools -<span class="hljs-selector-tag">i</span> ds3617<span class="hljs-selector-class">.vmdk</span> ds3617_esxi.vmdk<br></code></pre></td></tr></table></figure></li>
<li><p>æœ€å¥½åšä¸‹å¤‡ä»½ï¼Œå› ä¸ºesxiåˆ é™¤è™šæ‹Ÿæœºæ—¶ä¼šåˆ é™¤æ‰vmdkæ–‡ä»¶</p></li>
</ol>
<h1 id="åˆ›å»ºè™šæ‹Ÿæœº">åˆ›å»ºè™šæ‹Ÿæœº</h1>
<ol type="1">
<li>åˆ›å»ºç±»å‹ï¼šæ–°è™šæ‹Ÿæœº</li>
<li>åç§°ã€å…¼å®¹æ€§ï¼šéšä¾¿é€‰ä¸€ä¸ªlinux</li>
<li>é€‰æ‹©å­˜å‚¨ï¼šè£…åœ¨ç³»ç»Ÿç›˜ä¸Š</li>
<li><strong>è‡ªå®šä¹‰è®¾ç½®</strong></li>
</ol>
<h2 id="è‡ªå®šä¹‰è®¾ç½®">è‡ªå®šä¹‰è®¾ç½®</h2>
<p>CPUå†…å­˜æ ¹æ®éœ€è¦ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©äº†2æ ¸4Gï¼Œåˆ é™¤æ‰åŸæœ¬çš„ç¡¬ç›˜1å’ŒSCSIæ§åˆ¶å™¨0ã€CDç­‰é€‰é¡¹</p>
<h3 id="æ·»åŠ sataæ§åˆ¶å™¨">æ·»åŠ SATAæ§åˆ¶å™¨</h3>
<p>æ·»åŠ å…¶ä»–è®¾å¤‡- SATAæ§åˆ¶å™¨</p>
<h3 id="æ·»åŠ ç¡¬ç›˜">æ·»åŠ ç¡¬ç›˜</h3>
<p>æˆ‘æ·»åŠ ä¸€å—ç°æœ‰ç¡¬ç›˜å’Œä¸€å—æ–°æ ‡å‡†ç¡¬ç›˜</p>
<ul>
<li>ç°æœ‰ç¡¬ç›˜ï¼Œ<strong>é€‰æ‹©vmdkä½œä¸ºé»‘ç¾¤æ™–çš„ç³»ç»Ÿç›˜</strong>ï¼Œä¿è¯å…¶æ§åˆ¶å™¨ä½ç½®æ˜¯SATAæ§åˆ¶å™¨0ï¼Œï¼ˆ0:0ï¼‰è¡¨ç¤ºæœ€å…ˆå¯åŠ¨çš„ç¡¬ç›˜</li>
<li>æ–°æ ‡å‡†ç¡¬ç›˜ï¼Œ<strong>ä½œä¸ºé»‘ç¾¤æ™–çš„æ•°æ®ç›˜</strong>ã€‚é€‰æ‹©ç©ºç¡¬ç›˜åˆ†é…å…¨éƒ¨å¤§å°ä¸Šé™ï¼Œé€‰æ‹©SATAæ§åˆ¶å™¨1ï¼Œè·Ÿç³»ç»Ÿç›˜åŒºåˆ†å¼€</li>
<li>å¦‚æœä½ æœ‰æ›´å¤šçš„ç¡¬ç›˜å¯ä»¥ç»§ç»­æ·»åŠ ï¼Œå¯ä»¥é€‰æ‹©é0å·çš„å…¶ä»–SATAæ§åˆ¶å™¨å³å¯</li>
</ul>
<p>å…¶ä½™å‡ä½œé»˜è®¤è®¾ç½®å³å¯ï¼Œä¸å‡ºæ„å¤–çš„è¯å°±å¯ä»¥å¯åŠ¨è™šæ‹Ÿæœºäº†</p>
<h1 id="å¯åŠ¨é»‘ç¾¤æ™–è™šæ‹Ÿæœº">å¯åŠ¨é»‘ç¾¤æ™–è™šæ‹Ÿæœº</h1>
<p>å¯åŠ¨ååœ¨esxiä¸­æ˜¾ç¤ºå¦‚å›¾</p>
<blockquote>
<p>Loading Linux...</p>
<p>Starting kernel with SATA boot</p>
</blockquote>
<figure>
<img src="https://s2.loli.net/2022/10/02/qSiyMOHnG5uLfmg.png" alt="å¯åŠ¨æˆåŠŸ">
<figcaption aria-hidden="true">å¯åŠ¨æˆåŠŸ</figcaption>
</figure>
<p>æ­¤æ—¶éœ€è¦é€šè¿‡è·¯ç”±å™¨æŸ¥çœ‹é»‘ç¾¤æ™–è·å¾—çš„IPåœ°å€</p>
<p>æˆ–è€…ä½¿ç”¨ç¾¤æ™–çš„SynologyAssistantè½¯ä»¶æœç´¢IPåœ°å€</p>
<blockquote>
<p>å¦‚æœä½ çš„è·¯ç”±å™¨æ²¡æœ‰å¼€DHCPå°±å¿…é¡»ä½¿ç”¨è½¯ä»¶æœç´¢ï¼Œæ‰¾åˆ°ä¹‹åè®¾ç½®é™æ€è·¯ç”±åœ°å€ï¼Œä¸è¿‡éå¸¸ä¸æ¨èæ­¤å¤„è®¾ç½®é™æ€è·¯ç”±åœ°å€ï¼Œå› ä¸ºåç»­é»‘ç¾¤æ™–å®‰è£…æ—¶ä¼šä¸æ–­é‡å¯ï¼Œä¸¢å¤±è®¾ç½®å¥½çš„IPå¯¼è‡´é…ç½®å¤±è´¥</p>
</blockquote>
<blockquote>
<p>å¦‚æœåœ¨è¿™ä¸€æ­¥æœç´¢ä¸åˆ°IPåœ°å€ï¼Œå¯èƒ½æ˜¯å¡åœ¨å†…æ ¸å¯åŠ¨äº†ï¼ŒåŸå› å¯èƒ½å¾ˆå¤šï¼Œå»ºè®®ç›´æ¥é‡è£…ï¼ˆ</p>
</blockquote>
<p>è®¿é—®IPåœ°å€çš„5005ç«¯å£å°±å¯ä»¥å¼€å§‹é…ç½®é»‘ç¾¤æ™–äº†ï¼</p>
<p>PSï¼š</p>
<p>å¦‚æœç­‰å¾…10åˆ†é’Ÿå€’è®¡æ—¶åæ˜¾ç¤ºé…ç½®é”™è¯¯ä¹‹ç±»çš„ï¼Œå¤šæ¬¡å°è¯•æ— æœçš„ï¼Œå¤šåŠæ˜¯å› ä¸ºç¡¬ä»¶å’Œè½¯ä»¶ä¸åŒ¹é…ï¼Œå»ºè®®æ›´æ¢é•œåƒé‡æ–°å¯åŠ¨è™šæ‹Ÿæœºã€‚</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>è™šæ‹Ÿæœº</tag>
        <tag>esxi</tag>
        <tag>ç¾¤æ™–</tag>
      </tags>
  </entry>
  <entry>
    <title>Ubuntuä¸ŠåŸºäºdockeræ­å»ºHadoopé›†ç¾¤</title>
    <url>/2022/10/07/ubuntu-shang-de-ji-yu-docker-da-jian-hadoop-ji-qun/</url>
    <content><![CDATA[<h1 id="dockeræ“ä½œ">Dockeræ“ä½œ</h1>
<p>å…ˆå­¦ä¹ ä¸€ä¸‹åŸºç¡€çš„dockerå‘½ä»¤ï¼Œåé¢å¸¸ç”¨ï¼Œè¿™é‡Œæ”¾å‡ºæ¥å¤‡æŸ¥</p>
<h2 id="æŸ¥çœ‹å®¹å™¨container">æŸ¥çœ‹å®¹å™¨container</h2>
<p>docker ps çš„å‘½ä»¤åŒ…æ‹¬ï¼š 1ï¼‰-a åˆ—å‡ºæ‰€æœ‰å®¹å™¨ 2ï¼‰-l åˆ—å‡ºæœ€æ–°åˆ›å»ºå®¹å™¨
3ï¼‰-n=2 åˆ—å‡ºæœ€è¿‘åˆ›å»ºçš„2ä¸ªå®¹å™¨ 4ï¼‰-q ä»…åˆ—å‡ºå®¹å™¨ID 5ï¼‰-s æ˜¾ç¤ºå®¹å™¨å¤§å°</p>
<figure class="highlight css"><table><tr><td class="code"><pre><code class="hljs css">sudo docker ps -<span class="hljs-selector-tag">a</span><br></code></pre></td></tr></table></figure>
<h2 id="åˆ é™¤å®¹å™¨">åˆ é™¤å®¹å™¨</h2>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> docker rm <span class="hljs-number">1051267</span>f9afb<br></code></pre></td></tr></table></figure>
<h2 id="æŸ¥çœ‹é•œåƒimage">æŸ¥çœ‹é•œåƒimage</h2>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">sudo docker images</span><br></code></pre></td></tr></table></figure>
<h2 id="åˆ é™¤é•œåƒ">åˆ é™¤é•œåƒ</h2>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> docker rmi <span class="hljs-number">5</span>d0da3dc9764<br></code></pre></td></tr></table></figure>
<h2 id="å¯åŠ¨å®¹å™¨">å¯åŠ¨å®¹å™¨</h2>
<figure class="highlight apache"><table><tr><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">sudo</span> docker run -itd weicg/hadoop:<span class="hljs-number">1</span>.<span class="hljs-number">2</span><br></code></pre></td></tr></table></figure>
<ul>
<li>-dè¡¨ç¤ºåœ¨åå°è¿è¡Œï¼Œéœ€è¦è¿›å…¥å®¹å™¨</li>
</ul>
<figure class="highlight applescript"><table><tr><td class="code"><pre><code class="hljs applescript">sudo docker exec -<span class="hljs-keyword">it</span> be349f8dd945 bash<br></code></pre></td></tr></table></figure>
<ul>
<li>ä½¿ç”¨exec è¿›å…¥å®¹å™¨æ—¶exitå‘½ä»¤ä¸ä¼šç»“æŸå®¹å™¨</li>
</ul>
<h1 id="hadoopé›†ç¾¤æ­å»º">Hadoopé›†ç¾¤æ­å»º</h1>
<h2 id="å‡†å¤‡é•œåƒ">å‡†å¤‡é•œåƒ</h2>
<p>æˆ‘é€‰æ‹©çš„æ˜¯dockerhubä¸Šçš„<code>weicg/hadoop:1.2</code>,åŒæ ·æ˜¯ä¸€ä½åˆå­¦è€…åˆ¶ä½œçš„ï¼Œè¯•ç”¨è¿˜ç®—å¯ä»¥ï¼ˆå•æœºå¯ä»¥å¼€ç®±å³ç”¨ï¼‰ä¸è¿‡è¿™é‡Œæ­å»ºé›†ç¾¤è¿˜éœ€è¦ä¿®æ”¹ä¸€äº›å†…å®¹ã€‚æ¥æºï¼šhttps://hub.docker.com/r/weicg/hadoop</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo docker pull weicg/hadoop:1.2<br></code></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ‰“ç®—å»ºç«‹ä¸€ä¸ª<strong>ä¸€ä¸»ä¸¤ä»</strong>çš„é›†ç¾¤ï¼Œéœ€è¦å¼€ä¸‰ä¸ªå®¹å™¨</p>
<h2 id="å»ºç«‹ç½‘æ¡¥">å»ºç«‹ç½‘æ¡¥</h2>
<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><code class="hljs livecodeserver">sudo docker network <span class="hljs-built_in">create</span> <span class="hljs-comment">--driver bridge hadoop-br</span><br></code></pre></td></tr></table></figure>
<h2 id="å¼€å¯å¤šä¸ªå®¹å™¨">å¼€å¯å¤šä¸ªå®¹å™¨</h2>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo docker run -itd --network hadoop-br --name hadoop1 -p 50070:50070 -p 8088:8088 weicg/hadoop:1.2<br>sudo docker run -itd --network hadoop-br --name hadoop2 weicg/hadoop:1.2<br>sudo docker run -itd --network hadoop-br --name hadoop3 weicg/hadoop:1.2<br></code></pre></td></tr></table></figure>
<p>å¾—åˆ°ä¸‰ä¸ªå®¹å™¨</p>
<ul>
<li>23c1187f8492</li>
<li>676e08f5ecc5</li>
<li>d2ec810e1e89</li>
</ul>
<p>è¿›å…¥è¿™äº›å®¹å™¨åªéœ€è¦</p>
<figure class="highlight applescript"><table><tr><td class="code"><pre><code class="hljs applescript">sudo docker exec -<span class="hljs-keyword">it</span> hadoop1 bash<br>sudo docker exec -<span class="hljs-keyword">it</span> hadoop2 bash<br>sudo docker exec -<span class="hljs-keyword">it</span> hadoop3 bash<br></code></pre></td></tr></table></figure>
<h2 id="æŸ¥çœ‹ç½‘æ¡¥é…ç½®">æŸ¥çœ‹ç½‘æ¡¥é…ç½®</h2>
<figure class="highlight mipsasm"><table><tr><td class="code"><pre><code class="hljs mipsasm">sudo docker network <span class="hljs-keyword">inspect </span>hadoop-<span class="hljs-keyword">br </span><br></code></pre></td></tr></table></figure>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-attr">&quot;Containers&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-attr">&quot;23c1187f84929b19883f3ff3452688fca46c101e43bdfcc2a0cabaa4cd4fc593&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;Name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hadoop1&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;EndpointID&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;27504f3d67c0a1e884ab8420c717b7bf5f3aa7db211360fa19a0d501fa6f9ed7&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;MacAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;02:42:ac:12:00:02&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv4Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;172.18.0.2/16&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv6Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;676e08f5ecc5273542efd51e554ef1fa8790b2aa4a57fa3516cb39d6b09cfb7f&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;Name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hadoop2&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;EndpointID&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;b766f1d85e339558f0bbf89e52e8e9a103c8d8e5b593dbcb6832367a925dcb4f&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;MacAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;02:42:ac:12:00:03&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv4Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;172.18.0.3/16&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv6Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-attr">&quot;d2ec810e1e897f47add8b09f8a813b6c23ab892fddd0706b88373d7f67f76b2f&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">&#123;</span><br>        <span class="hljs-attr">&quot;Name&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;hadoop3&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;EndpointID&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;552975d97feddc22fcf5d4ac1afa61be698846f08727e249d7581aaa33e220c2&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;MacAddress&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;02:42:ac:12:00:04&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv4Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;172.18.0.4/16&quot;</span><span class="hljs-punctuation">,</span><br>        <span class="hljs-attr">&quot;IPv6Address&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªdockerçš„ipåœ°å€</p>
<p>172.18.0.2 hadoop1</p>
<p>172.18.0.3 hadoop2</p>
<p>172.18.0.4 hadoop3</p>
<p>ä½¿ç”¨<code>ping</code>å‘½ä»¤åˆ†åˆ«æ£€æŸ¥æ˜¯å¦ç½‘ç»œé€šç•…</p>
<p>ä»¥ä¸‹å‘½ä»¤éœ€è¦åˆ†åˆ«è¿›å…¥ä¸‰ä¸ªå®¹å™¨å†…æ‰§è¡Œ</p>
<p>1.æ›´æ”¹hostsæ–‡ä»¶<code>vim /etc/hosts</code>,åŠ å…¥å¦‚ä¸‹é…ç½®</p>
<figure class="highlight accesslog"><table><tr><td class="code"><pre><code class="hljs accesslog"><span class="hljs-number">172.18.0.2</span> hadoop1 <br><span class="hljs-number">172.18.0.3</span> hadoop2 <br><span class="hljs-number">172.18.0.4</span> hadoop3 <br></code></pre></td></tr></table></figure>
<p>2.åˆ†åˆ«åœ¨ä¸‰ä¸ªå®¹å™¨å†…é…ç½®ssh,å› ä¸ºé•œåƒå·²ç»ç”Ÿæˆäº†å¯†é’¥ï¼Œæ­¤å¤„å°†æœ¬æœºå¯†é’¥åŠ å…¥æœ¬æœºçš„è®¿é—®åˆ—è¡¨ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cd</span> ~/.ssh<br><span class="hljs-built_in">cat</span> id_rsa.pub &gt;&gt; authorized_keys<br></code></pre></td></tr></table></figure>
<p>å®Œæˆåå¯ä»¥<code>ssh root@hadoop2</code>æŸ¥çœ‹æ˜¯å¦æˆåŠŸé…ç½®sshå’Œç½‘ç»œã€‚</p>
<h2 id="é…ç½®hadoopæ–‡ä»¶">é…ç½®hadoopæ–‡ä»¶</h2>
<p>è¿›å…¥hadoop1,åˆ›å»ºä¸€äº›é…ç½®ç”¨åˆ°çš„æ–‡ä»¶å¤¹</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">mkdir <span class="hljs-regexp">/home/</span>hadoop<br>mkdir <span class="hljs-regexp">/home/</span>hadoop<span class="hljs-regexp">/tmp /</span>home<span class="hljs-regexp">/hadoop/</span>hdfs_name <span class="hljs-regexp">/home/</span>hadoop/hdfs_data<br></code></pre></td></tr></table></figure>
<p>åˆ‡åˆ°hadoopé…ç½®ç›®å½•</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">cd <span class="hljs-variable">$HADOOP_HOME</span><span class="hljs-regexp">/etc/</span>hadoop/<br></code></pre></td></tr></table></figure>
<p>ä¸‹é¢çš„ç¼–è¾‘éƒ¨åˆ†å¯ä»¥ç›´æ¥æ‹·è´è¦†ç›–ç²˜è´´</p>
<h3 id="ç¼–è¾‘workersæ–‡ä»¶">ç¼–è¾‘workersæ–‡ä»¶</h3>
<p><code>vim workers</code></p>
<figure class="highlight smali"><table><tr><td class="code"><pre><code class="hljs smali">hadoop2<br>hadoop3<br></code></pre></td></tr></table></figure>
<h3 id="ç¼–è¾‘core-site.xml">ç¼–è¾‘core-site.xml</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>fs.defaultFS<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hdfs://hadoop1:9000<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>  <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hadoop.tmp.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:/home/hadoop/tmp<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>io.file.buffer.size<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>131702<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="ç¼–è¾‘hdfs-site.xml">ç¼–è¾‘hdfs-site.xml</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br> <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.name.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:/home/hadoop/hdfs_name<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.datanode.data.dir<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>file:/home/hadoop/hdfs_data<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.replication<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.namenode.secondary.http-address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:9001<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>dfs.webhdfs.enabled<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>true<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="ç¼–è¾‘mapred-site.xml">ç¼–è¾‘mapred-site.xml</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.framework.name<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>yarn<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:10020<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:19888<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<h3 id="ç¼–è¾‘yarn-site.xml">ç¼–è¾‘yarn-site.xml</h3>
<figure class="highlight xml"><table><tr><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">configuration</span>&gt;</span><br>   <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>mapreduce_shuffle<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.nodemanager.auxservices.mapreduce.shuffle.class<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:8032<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.scheduler.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:8030<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.resource-tracker.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:8031<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:8033<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">property</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>yarn.resourcemanager.webapp.address<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>hadoop1:8088<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">property</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">configuration</span>&gt;</span><br></code></pre></td></tr></table></figure>
<p>æŠŠä¸Šé¢é…ç½®å¥½çš„æ–‡ä»¶æ‹·è´åˆ°2ã€3å·æœº</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">scp -r <span class="hljs-regexp">/home/</span>hadoop hadoop2:<span class="hljs-regexp">/home/</span><br>scp -r <span class="hljs-regexp">/home/</span>hadoop hadoop3:<span class="hljs-regexp">/home/</span><br>scp -r <span class="hljs-variable">$HADOOP_HOME</span><span class="hljs-regexp">/etc/</span>hadoop<span class="hljs-regexp">/ hadoop2:$HADOOP_HOME/</span>etc<span class="hljs-regexp">/hadoop/</span><br>scp -r <span class="hljs-variable">$HADOOP_HOME</span><span class="hljs-regexp">/etc/</span>hadoop<span class="hljs-regexp">/ hadoop3:$HADOOP_HOME/</span>etc<span class="hljs-regexp">/hadoop/</span><br></code></pre></td></tr></table></figure>
<h2 id="å¯é€‰å¢åŠ sbinç›®å½•çš„ç¯å¢ƒå˜é‡æ–¹ä¾¿éšæ„å¯åŠ¨">ï¼ˆå¯é€‰ï¼‰å¢åŠ sbinç›®å½•çš„ç¯å¢ƒå˜é‡ï¼Œæ–¹ä¾¿éšæ„å¯åŠ¨</h2>
<ol type="1">
<li><p>åˆ†åˆ«è¿æ¥ä¸‰å°æœºå™¨</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">docker <span class="hljs-built_in">exec</span> -it hadoop1 bash<br>docker <span class="hljs-built_in">exec</span> -it hadoop2 bash<br>docker <span class="hljs-built_in">exec</span> -it hadoop3 bash<br></code></pre></td></tr></table></figure></li>
<li><p>å°†hadoop/sbinç›®å½•åŠ å…¥PATHç¯å¢ƒå˜é‡ä¸­<code>vim ï½/.bashrc</code></p>
<p>è¿½åŠ å†…å®¹<code>export PATH=$PATH:$HADOOP_HOME/sbin</code></p>
<p>ç„¶åæ‰§è¡Œ<code>source ~/.bashrc</code></p></li>
</ol>
<p><strong>è¿™ä¸€æ­¥ç•¥è¿‡çš„è¯ï¼Œå¯åŠ¨hadoopçš„ç›¸å…³å‘½ä»¤éœ€è¦å…ˆ<code>cd $HADOOP_HOME/sbin</code></strong></p>
<h2 id="å¯åŠ¨hadoop">å¯åŠ¨HADOOP</h2>
<p>è¿›å…¥hadoop1å·ä¸»èŠ‚ç‚¹</p>
<p>ç¬¬ä¸€æ¬¡å¯åŠ¨éœ€è¦æ ¼å¼åŒ–hdfsï¼Œåç»­<strong><u>ç»å¯¹ä¸è¦å†</u></strong>æ‰§è¡Œè¿™ä¸€æ¡<code>hdfs namenode -format</code></p>
<p>å…ˆåœ¨ä¸»èŠ‚ç‚¹ä¸Šå¯åŠ¨æ–‡ä»¶ç³»ç»Ÿï¼š<code>start-dfs.sh</code></p>
<p>ä½¿ç”¨<code>jps</code>å‘½ä»¤æ­¤æ—¶å¯ä»¥è§‚å¯Ÿåˆ°ï¼š</p>
<p>hadoop1ä¸Šå¯åŠ¨äº†<u>åç§°èŠ‚ç‚¹</u>å’Œ<u>ç¬¬äºŒåç§°èŠ‚ç‚¹</u>ï¼ˆç¬¬äºŒåç§°èŠ‚ç‚¹å¯ä»¥é…ç½®åœ¨å…¶ä»–èŠ‚ç‚¹ä¸Šï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@5d574541fd94:/opt/hadoop-3.1.3/etc/hadoop<span class="hljs-comment"># jps</span><br>1649 NameNode<br>1854 SecondaryNameNode<br>1967 Jps<br></code></pre></td></tr></table></figure>
<p>hadoop2å’Œhadoop3ä¸Šå¯åŠ¨äº†<u>æ•°æ®èŠ‚ç‚¹</u>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@004916b254fc:/opt/hadoop-3.1.3/etc/hadoop<span class="hljs-comment"># jps</span><br>294 DataNode<br>361 Jps<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@c5bea89663f9:/<span class="hljs-comment"># jps</span><br>279 Jps<br>188 DataNode<br></code></pre></td></tr></table></figure>
<p>ç¬¬äºŒæ­¥åœ¨ä¸»èŠ‚ç‚¹ä¸Šå¯åŠ¨yarnç®¡ç†ç³»ç»Ÿï¼š<code>start-yarn.sh</code></p>
<p>Hadoop1:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@5d574541fd94:/opt/hadoop-3.1.3/etc/hadoop<span class="hljs-comment"># jps</span><br>3751 Jps<br>3255 SecondaryNameNode<br>3049 NameNode<br>3455 ResourceManager<br></code></pre></td></tr></table></figure>
<p>Hadoop2å’Œhadoop3:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@004916b254fc:/opt/hadoop-3.1.3/etc/hadoop<span class="hljs-comment"># jps</span><br>851 NodeManager<br>731 DataNode<br>975 Jps<br></code></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">root@c5bea89663f9:/<span class="hljs-comment"># jps</span><br>644 DataNode<br>890 Jps<br>766 NodeManager<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ä¸¤å°ä»èŠ‚ç‚¹éƒ½å¤šäº†ä¸€ä¸ªNodeManager</p>
<p>æ­¤æ—¶hadoopåº”ç”¨å·²ç»æˆåŠŸè¿è¡Œã€‚</p>
<p>å¯åŠ¨åº”ç”¨<u>ä¸æ¨è</u>ä½¿ç”¨start-all</p>
<p>åœæ­¢åº”ç”¨ï¼š<code>stop-dfs.sh</code>å’Œ<code>stop-yarn.sh</code>æˆ–è€…<code>stop-all.sh</code></p>
<blockquote>
<p>åœ¨hadoopè¿è¡Œä¸­æœ‰å“ªä¸ªdatanodeæ‰äº†å¾ˆæ­£å¸¸ğŸ¤£ğŸ¤£</p>
<p>ä½¿ç”¨ä¸‹é¢å‘½ä»¤åœ¨æ•°æ®èŠ‚ç‚¹ä¸Šé‡å¼€â¬‡ï¸</p>
<p><code>hdfs --daemon start datanode</code></p>
</blockquote>
<p>åœ¨å®¿ä¸»æœºä¸Šå¯ä»¥é€šè¿‡IP:8088æŸ¥çœ‹Hadoopè¿è¡ŒçŠ¶æ€ã€‚</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>docker</tag>
        <tag>ubuntu</tag>
        <tag>hadoop</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨BERTopicæå–æ–‡æœ¬ä¸»é¢˜</title>
    <url>/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨bertopicæå–æ–‡æœ¬ä¸»é¢˜">ä½¿ç”¨BERTopicæå–æ–‡æœ¬ä¸»é¢˜</h1>
<h2 id="åŠ è½½æ•°æ®é›†">åŠ è½½æ•°æ®é›†</h2>
<p>æŒ‚è½½Google
Driveç”¨äºè¯»å–æ•°æ®é›†ï¼Œè¿™é‡Œä¼šè¦æ±‚ç™»é™†Googleè´¦å·æˆæƒï¼Œæ¯æ¬¡éƒ½éœ€è¦é‡æ–°æˆæƒï¼Œå»ºè®®ä¸€å¼€å§‹åœ¨colabä¸­é€‰å¥½gpuåˆ†é…èµ„æºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> google.colab <span class="hljs-keyword">import</span> drive<br>drive.mount(<span class="hljs-string">&#x27;/content/drive&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>æ•°æ®é›†æ¥è‡ªå¤–å–å¹³å°ä¸­æ–‡è¯„è®ºï¼Œæ•°æ®é›†åœ°å€ï¼šhttps://raw.githubusercontent.com/SophonPlus/ChineseNlpCorpus/master/datasets/waimai_10k/waimai_10k.csvï¼Œå¯ä»¥ç›´æ¥wgetè·å–ã€‚è¯¥æ•°æ®é›†æœ¬èº«ç”¨äºæƒ…æ„ŸäºŒåˆ†ç±»ã€‚
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> pandas <span class="hljs-keyword">as</span> pd<br>df = pd.read_csv(<span class="hljs-string">&#x27;/content/drive/MyDrive/colab/waimai_10k.csv&#x27;</span>)<br>df[<span class="hljs-string">&#x27;label&#x27;</span>].value_counts()<br></code></pre></td></tr></table></figure></p>
<p>ç»“æœä¸ºï¼š</p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><code class="hljs yaml"><span class="hljs-number">0</span>    <span class="hljs-number">7987</span><br><span class="hljs-number">1</span>    <span class="hljs-number">4000</span><br><span class="hljs-attr">Name:</span> <span class="hljs-string">label,</span> <span class="hljs-attr">dtype:</span> <span class="hljs-string">int64</span><br></code></pre></td></tr></table></figure>
<p>0 è¡¨ç¤ºè´Ÿé¢è¯„è®º<br>
1 è¡¨ç¤ºæ­£é¢è¯„è®º<br>
ä¸è¿‡è¿™äº›labelå¹¶ä¸ä½¿ç”¨ï¼Œåªéœ€è¦æ–‡æœ¬review</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">df.head(n=<span class="hljs-number">10</span>)<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/æŸ¥çœ‹æ•°æ®é›†dataframe.png" alt="æ•°æ®é›†dataframe">
<figcaption aria-hidden="true">æ•°æ®é›†dataframe</figcaption>
</figure>
<p>å°†æ•°æ®é›†æ•´ç†ä¸ºåˆ—è¡¨æ–¹ä¾¿è¾“å…¥</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">dataset = [x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> df[<span class="hljs-string">&#x27;review&#x27;</span>]]<br>dataset[:<span class="hljs-number">10</span>]<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºï¼š</p>
<p><code>['å¾ˆå¿«ï¼Œå¥½åƒï¼Œå‘³é“è¶³ï¼Œé‡å¤§', 'æ²¡æœ‰é€æ°´æ²¡æœ‰é€æ°´æ²¡æœ‰é€æ°´', 'éå¸¸å¿«ï¼Œæ€åº¦å¥½ã€‚', 'æ–¹ä¾¿ï¼Œå¿«æ·ï¼Œå‘³é“å¯å£ï¼Œå¿«é€’ç»™åŠ›', 'èœå‘³é“å¾ˆæ£’ï¼é€é¤å¾ˆåŠæ—¶ï¼', 'ä»Šå¤©å¸ˆå‚…æ˜¯ä¸æ˜¯æ‰‹æŠ–äº†ï¼Œå¾®è¾£æ ¼å¤–è¾£ï¼', 'é€é¤å¿«,æ€åº¦ä¹Ÿç‰¹åˆ«å¥½,è¾›è‹¦å•¦è°¢è°¢', 'è¶…çº§å¿«å°±é€åˆ°äº†ï¼Œè¿™ä¹ˆå†·çš„å¤©æ°”éª‘å£«ä»¬è¾›è‹¦äº†ã€‚è°¢è°¢ä½ ä»¬ã€‚éº»è¾£é¦™é”…ä¾ç„¶å¾ˆå¥½åƒã€‚', 'ç»è¿‡ä¸Šæ¬¡æ™šäº†2å°æ—¶ï¼Œè¿™æ¬¡è¶…çº§å¿«ï¼Œ20åˆ†é’Ÿå°±é€åˆ°äº†â€¦â€¦', 'æœ€åäº”åˆ†é’Ÿè®¢çš„ï¼Œå–å®¶ç‰¹åˆ«å¥½æ¥å•äº†ï¼Œè°¢è°¢ã€‚']</code></p>
<p>å»é™¤åœç”¨è¯ï¼ˆæ²¡ç”¨åˆ°ï¼Œæ•°æ®é›†å·²ç»è¿‡æ¸…æ´—ï¼‰</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><code class="hljs pgsql">stopwords = [<span class="hljs-string">&#x27; &#x27;</span>]+[<span class="hljs-type">line</span>.strip() <span class="hljs-keyword">for</span> <span class="hljs-type">line</span> <span class="hljs-keyword">in</span> <span class="hljs-keyword">open</span>(&quot;cn_stopwords.txt&quot;, &quot;rt&quot;, encoding=&quot;utf-8&quot;).readlines()]<br></code></pre></td></tr></table></figure>
<h2 id="bertopicå»ºæ¨¡">BERTopicå»ºæ¨¡</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">!pip install bertopic<br><br><span class="hljs-keyword">from</span> bertopic <span class="hljs-keyword">import</span> BERTopic<br><span class="hljs-keyword">from</span> sentence_transformers <span class="hljs-keyword">import</span> SentenceTransformer<br><span class="hljs-keyword">from</span> umap <span class="hljs-keyword">import</span> UMAP<br><span class="hljs-keyword">from</span> hdbscan <span class="hljs-keyword">import</span> HDBSCAN<br><span class="hljs-keyword">from</span> bertopic.vectorizers <span class="hljs-keyword">import</span> ClassTfidfTransformer<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>sentence-transformers</code>æ”¯æŒå¤šè¯­è¨€çš„å¤§æ¨¡å‹è¿›è¡Œembeddingï¼Œåœ¨colabä¸Šä¸‹è½½é€Ÿåº¦å¾ˆå¿«ï¼Œçº¦400Mç¬é—´å®Œæˆã€‚
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">embedding_model = SentenceTransformer(<span class="hljs-string">&#x27;sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2&#x27;</span>)<br></code></pre></td></tr></table></figure> <strong>é™ç»´</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">umap_model = UMAP(n_neighbors=<span class="hljs-number">20</span>, n_components=<span class="hljs-number">5</span>, min_dist=<span class="hljs-number">0.0</span>, metric=<span class="hljs-string">&#x27;cosine&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p><strong>èšç±»</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">hdbscan_model = HDBSCAN(min_cluster_size=<span class="hljs-number">10</span>, metric=<span class="hljs-string">&#x27;euclidean&#x27;</span>, cluster_selection_method=<span class="hljs-string">&#x27;eom&#x27;</span>, prediction_data=<span class="hljs-literal">True</span>)<br></code></pre></td></tr></table></figure>
<p>tokenizer <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> sklearn.feature_extraction.text <span class="hljs-keyword">import</span> CountVectorizer<br>vectorizer_model = CountVectorizer()<br></code></pre></td></tr></table></figure>
<strong>åŠ æƒ</strong>ï¼šä½¿ç”¨æ”¹è¿›tf-idfçš„c-tf-idfæ–¹æ³•</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">ctfidf_model = ClassTfidfTransformer()<br></code></pre></td></tr></table></figure>
<p>è¾“å…¥BERTopicæ¨¡å‹ <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model = BERTopic(<br>â€‹    embedding_model=embedding_model,<br>â€‹    umap_model=umap_model,<br>â€‹    hdbscan_model=hdbscan_model,<br>â€‹    vectorizer_model=vectorizer_model,<br>â€‹    ctfidf_model=ctfidf_model,<br>â€‹    nr_topics=<span class="hljs-number">10</span>                        <br>)<br></code></pre></td></tr></table></figure> è®­ç»ƒ <figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topics, probabilities = topic_model.fit_transform(dataset)<br></code></pre></td></tr></table></figure></p>
<h2 id="å¯è§†åŒ–å‘ˆç°å’Œç»“æœåˆ†æ">å¯è§†åŒ–å‘ˆç°å’Œç»“æœåˆ†æ</h2>
<p><strong>æŸ¥çœ‹èšç±»ç»“æœ</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.get_document_info(dataset)<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/èšç±»åç»“æœ.png" alt="ç»“æœ">
<figcaption aria-hidden="true">ç»“æœ</figcaption>
</figure>
<p>æŸ¥çœ‹å„è¯é¢˜æ–‡æœ¬æ•°é‡ã€‚<br>
-1è¡¨ç¤ºæ²¡æœ‰èšç±»</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.get_topic_freq()<br></code></pre></td></tr></table></figure>
<p><img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/è¯é¢˜æ–‡æœ¬æ•°é‡.png" alt="è¯é¢˜æ–‡æœ¬æ•°é‡" style="zoom: 50%;"></p>
<p>æŸ¥çœ‹è¯é¢˜7çš„æ–‡æœ¬å¹¶æŒ‰ç…§é‡è¦ç¨‹åº¦æ’åº</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.get_topic(<span class="hljs-number">7</span>)<br><br><span class="hljs-string">&#x27;&#x27;&#x27;</span><br><span class="hljs-string">[(&#x27;å°±æ˜¯æœ‰ç‚¹æ²¹&#x27;, 0.12314684980074718),</span><br><span class="hljs-string"> (&#x27;å°±æ˜¯æ²¹å¤ªå¤§&#x27;, 0.12314684980074718),</span><br><span class="hljs-string"> (&#x27;å…¨æ˜¯æ²¹&#x27;, 0.10826034220928046),</span><br><span class="hljs-string"> (&#x27;å‘³é“ä¸é”™&#x27;, 0.07580202124764789),</span><br><span class="hljs-string"> (&#x27;æŒºå¥½çš„&#x27;, 0.07380868069892178),</span><br><span class="hljs-string"> (&#x27;ç°å¸¸æ»¡æ„&#x27;, 0.06720667864215085),</span><br><span class="hljs-string"> (&#x27;ä¸€å±‚åšåšçš„æ²¹&#x27;, 0.06720667864215085),</span><br><span class="hljs-string"> (&#x27;çº¢æ²¹æŠ„æ‰‹è´µ&#x27;, 0.06720667864215085),</span><br><span class="hljs-string"> (&#x27;çº¢æ²¹æŠ„æ‰‹å¥½å¤šæ²¹å•Š&#x27;, 0.06720667864215085),</span><br><span class="hljs-string"> (&#x27;çº¢æ²¹æŠ„æ‰‹ä¸é”™&#x27;, 0.06720667864215085)]</span><br><span class="hljs-string"> &#x27;&#x27;&#x27;</span><br></code></pre></td></tr></table></figure>
<p><strong>å¯è§†åŒ–æŸ¥çœ‹å„è¯é¢˜åˆ†æ•°æ’åº</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.visualize_barchart()<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/åˆ†æ•°æ’åº.png" alt="åˆ†æ•°æ’åº">
<figcaption aria-hidden="true">åˆ†æ•°æ’åº</figcaption>
</figure>
<p>èƒ½å¤Ÿçœ‹åˆ°ä¸€éƒ¨åˆ†ç»“æœèšç±»æ•ˆæœå¾ˆå¥½ï¼Œæ¯”å¦‚é›†ä¸­æè¿°é€é¤æ…¢ã€å‡‰ã€å’–å•¡å¥¶èŒ¶ã€æŠ«è¨ã€æ²¹ç­‰ä¸»é¢˜ï¼Œè€Œå…¶ä»–ä¸€éƒ¨åˆ†çœ‹èµ·æ¥å¥½åå‚åŠï¼ŒåŸå› åº”è¯¥æ˜¯è¯¥ä¸»é¢˜èšç±»å¯èƒ½å°†è¯„ä»·å¥½åéƒ½åˆ—ä¸ºâ€œè¯„ä»·ä¸»é¢˜â€è€Œåˆ†åˆ°ä¸€èµ·ã€‚</p>
<p><strong>å¯è§†åŒ–å‘ˆç°ç‚¹äº‘å›¾</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">embeddings = embedding_model.encode(dataset, show_progress_bar=<span class="hljs-literal">False</span>)<br>topic_model.visualize_documents(dataset, embeddings=embeddings)<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/ç‚¹äº‘å›¾.png" alt="ç‚¹äº‘å›¾">
<figcaption aria-hidden="true">ç‚¹äº‘å›¾</figcaption>
</figure>
<p>ç‚¹äº‘å›¾ä¸­é¢œè‰²ç›¸åŒçš„å±äºåŒä¸€ä¸»é¢˜ï¼Œç°è‰²å±äºæ— æ³•èšç±»çš„æ–‡æœ¬ã€‚</p>
<p><strong>å¯è§†åŒ–å‘ˆç°çƒ­åº¦å›¾</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.visualize_heatmap()<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/çƒ­åº¦å›¾.png" alt="çƒ­åº¦å›¾">
<figcaption aria-hidden="true">çƒ­åº¦å›¾</figcaption>
</figure>
<p>çƒ­åº¦å›¾ä¸­é¢œè‰²ç›¸è¿‘çš„è‰²å—è¡¨ç¤ºç›¸ä¼¼åº¦é«˜ï¼Œå¯ä»¥çœ‹åˆ°01ä¸¤ä¸»é¢˜çš„å†…å®¹å¾ˆç›¸ä¼¼ï¼Œé¢œè‰²è¾ƒæ·±ï¼›åŒæ—¶01ä¸¤ä¸ªè¯é¢˜ä¸å…¶ä»–è¯é¢˜çš„ç›¸ä¼¼åº¦éƒ½å¾ˆé«˜ï¼›2å·ä¸»é¢˜ä¸å…¶ä»–çš„ç›¸ä¼¼åº¦è¾ƒä½ï¼Œå¯ä»¥ä»é¢œè‰²å’Œæ–‡æœ¬ä¸­è§‚å¯Ÿåˆ°ã€‚</p>
<p><strong>å¯è§†åŒ–å‘ˆç°è¯é¢˜é—´è·ç¦»</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">topic_model.visualize_topics()<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/03/28/shi-yong-bertopic-ti-qu-wen-ben-zhu-ti/è¯é¢˜é—´è·ç¦».png" alt="è¯é¢˜é—´è·ç¦»">
<figcaption aria-hidden="true">è¯é¢˜é—´è·ç¦»</figcaption>
</figure>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Bert</tag>
        <tag>NLP</tag>
        <tag>BERTopic</tag>
        <tag>æ–‡æœ¬ä¸»é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Bertè¿›è¡ŒNERå‘½åå®ä½“è¯†åˆ«feat.fastNLP(ä¸‹ï¼šä½¿ç”¨flaskéƒ¨ç½²æ¨¡å‹)</title>
    <url>/2023/03/25/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp-xia-shi-yong-flask-bu-shu-mo-xing/</url>
    <content><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>ä¸‹ç¯‡ä¸»è¦ä»‹ç»ä½¿ç”¨flaskæ­å»ºç®€å•çš„ç½‘é¡µå’Œå“åº”ï¼Œå¹¶å®ç°è°ƒç”¨æ¨¡å‹æ¨ç†ï¼Œå®ŒæˆNERä»»åŠ¡å¯è§†åŒ–ã€‚</p>
<blockquote>
<p>å¢åŠ bilstm+crfçš„æ¨¡å‹ç¡®å®åœ¨é¢„æµ‹ä¸Šæ›´ä¸ºå‡†ç¡®ï¼Œä¾‹å­ä¸­çš„â€œå´”æ°¸å…ƒçœŸé¢â€ä¸­å¯ä»¥å‡†ç¡®åˆ†è¾¨å‡º"å´”æ°¸å…ƒ"æ‰æ˜¯äººåï¼Œè€Œmlpæ¨¡å‹ä¼šå°†â€œå´”æ°¸å…ƒçœŸâ€ä½œä¸ºä¸€ä¸ªäººåğŸ¤£</p>
</blockquote>
<p>é¡¹ç›®å·¥ç¨‹çš„Githubä»“åº“åœ°å€ä¸ºï¼šhttps://github.com/Ash-one/ChineseBert-finetuned-NER</p>
<figure>
<img src="/2023/03/25/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp-xia-shi-yong-flask-bu-shu-mo-xing/ç»“æœ.png" alt="ç»“æœå±•ç¤º">
<figcaption aria-hidden="true">ç»“æœå±•ç¤º</figcaption>
</figure>
<p>æœåŠ¡å™¨ä½¿ç”¨flaskå“åº”getè¯·æ±‚ï¼Œå¯è§†åŒ–ç»“æœéƒ¨åˆ†ä½¿ç”¨pythonçš„displacyåº“ç”ŸæˆHTMLç›´æ¥æ’å…¥åŸå§‹HTMLã€‚</p>
<h1 id="flaskæœåŠ¡ç«¯">FlaskæœåŠ¡ç«¯</h1>
<p>flaskå·¥ç¨‹çš„ç›®å½•ç»“æ„å¦‚ä¸‹ï¼Œç¨‹åºçš„å…¥å£åœ¨<code>run.py</code>ä¸­ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><code class="hljs stylus">â”œâ”€â”€ app<br>â”‚   â”œâ”€â”€ __init__<span class="hljs-selector-class">.py</span><br>â”‚   â”œâ”€â”€ loader<span class="hljs-selector-class">.py</span><br>â”‚   â”œâ”€â”€ model<span class="hljs-selector-class">.py</span><br>â”‚   â”œâ”€â”€ run<span class="hljs-selector-class">.py</span><br>â”‚   â”œâ”€â”€ static<br>â”‚   â”‚   â”œâ”€â”€ bg<span class="hljs-selector-class">.jpg</span><br>â”‚   â”‚   â”œâ”€â”€ js<br>â”‚   â”‚   â”‚   â””â”€â”€ mystyle<span class="hljs-selector-class">.css</span><br>â”‚   â”‚   â””â”€â”€ models<br>â”‚   â”‚       â”œâ”€â”€ rbt3-bilstm-crf-ner<span class="hljs-selector-class">.pth</span><br>â”‚   â”‚       â”œâ”€â”€ rbt3-bilstm-crf-ner<span class="hljs-selector-class">.txt</span><br>â”‚   â”‚       â”œâ”€â”€ rbt3-mlp-ner<span class="hljs-selector-class">.pth</span><br>â”‚   â”‚       â””â”€â”€ rbt3-mlp-ner<span class="hljs-selector-class">.txt</span><br>â”‚   â””â”€â”€ templates<br>â”‚       â””â”€â”€ index<span class="hljs-selector-class">.html</span><br>â”œâ”€â”€ test.py<br></code></pre></td></tr></table></figure>
<h2 id="åŸºç¡€è·¯ç”±">åŸºç¡€è·¯ç”±</h2>
<p>åªè¦åœ¨<code>templates</code>æ–‡ä»¶å¤¹ä¸‹æ”¾ç½®å¥½htmlæ–‡ä»¶ï¼Œå°±å¯ä»¥ç›´æ¥é€šè¿‡<code>render_template</code>æ–¹æ³•æ¸²æŸ“å‡ºé¡µé¢ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, request, make_response<br><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Response, render_template<br><span class="hljs-keyword">import</span> loader<br><span class="hljs-keyword">from</span> model <span class="hljs-keyword">import</span> BertNER,BertBilstmCrfNER<br><span class="hljs-keyword">from</span> spacy <span class="hljs-keyword">import</span> displacy<br><br>app = Flask(__name__)<br><br><span class="hljs-meta">@app.route(<span class="hljs-params"><span class="hljs-string">&#x27;/&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">index</span>():<br>    <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">&#x27;index.html&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h2 id="å“åº”getè¯·æ±‚">å“åº”getè¯·æ±‚</h2>
<p>ä¸‹é¢è¿™ä¸ªè£…é¥°å™¨ä¸“é—¨å“åº”/predictè·¯å¾„çš„getè¯·æ±‚ã€‚</p>
<p>è¿™é‡Œç”±äºåªéœ€è¦æ ¹æ®è¾“å…¥å‚æ•°è¿”å›é¢„æµ‹ç»“æœï¼Œæ•…é€‰æ‹©ä½¿ç”¨getè¯·æ±‚ï¼Œæ£€æŸ¥å‚æ•°åˆæ³•ååŠ è½½å¯¹åº”æ¨¡å‹é¢„æµ‹ï¼Œå¹¶å¯¹é¢„æµ‹ç»“æœè¿›è¡Œåå¤„ç†ï¼Œç”±displacyåº“æ¸²æŸ“ä¸ºHTMLï¼Œæœ€åè¿”å›å“åº”ç»“æœã€‚</p>
<blockquote>
<p>displacyå®˜æ–¹è¡¨ç¤ºæœ€å¥½ä¸è¦åœ¨æœåŠ¡å™¨ç«¯æ¸²æŸ“å¾—åˆ°HTMLï¼Œè€Œæ˜¯ä½¿ç”¨ä»–ä»¬æä¾›çš„jsæ–‡ä»¶åœ¨å®¢æˆ·ç«¯æ¸²æŸ“ï¼Œè€Œé‚£ä¸ªjsæ–‡ä»¶çš„ä»“åº“å·²ç»è¢«archivedäº†ï¼Œä¸å¾—ä¸ç”¨è¿™ç§æ–¹æ³•......</p>
</blockquote>
<p>ç”±äºåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­éœ€è¦è·å–åˆ°æ¨¡å‹ï¼Œå› æ­¤éœ€è¦åœ¨importé˜¶æ®µåŠ è½½å®šä¹‰çš„pytorchæ¨¡å‹ã€‚åŠ è½½æ¨¡å‹æ¨ç†çš„éƒ¨åˆ†æ¯”è¾ƒç®€å•ï¼Œä¸Šç¯‡æœ‰æ‰€æåŠï¼Œè¿™é‡Œä¸åšå±•ç¤ºï¼Œéœ€è¦æ³¨æ„çš„æ˜¯displacyåº“çš„è¾“å…¥æ ¼å¼æ˜¯å½¢å¦‚<code>&#123;'text': 'æˆ‘å°±è¦åœ¨ä¸­å›½ä¼ åª’å¤§å­¦åƒä¸Šå´”æ°¸å…ƒçœŸé¢', 'ents': [&#123;'label': 'GPE.NAM', 'start': 4, 'end': 6&#125;, &#123;'label': 'ORG.NAM', 'start': 6, 'end': 10&#125;, &#123;'label': 'PER.NAM', 'start': 12, 'end': 15&#125;], 'title': None&#125;</code>çš„å­—å…¸ï¼Œåœ¨å¾—åˆ°æ¨¡å‹é¢„æµ‹åºåˆ—åéœ€è¦å¤šä¸€æ­¥è½¬æ¢ä¸ºå­—å…¸ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-meta">@app.get(<span class="hljs-params"><span class="hljs-string">&#x27;/predict&#x27;</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict__text</span>():<br>    text = request.args.get(<span class="hljs-string">&#x27;text&#x27;</span>)<br>    model_name = request.args.get(<span class="hljs-string">&#x27;model&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;text:&#x27;</span>,text,<span class="hljs-string">&#x27;model_name:&#x27;</span>,model_name)<br>    <span class="hljs-comment"># ä¸‹é¢å¯¹ä¸åˆæ³•æˆ–æ— æ³•è¯»å–çš„æ¨¡å‹è¿›è¡Œå¤„ç†</span><br>    <span class="hljs-keyword">try</span>:<br>        model,label_idx_list = loader.load_model_from_file(model_name)<br>    <span class="hljs-keyword">except</span> IOError:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;IOError&#x27;</span><br>    <span class="hljs-keyword">if</span> model == <span class="hljs-literal">None</span> <span class="hljs-keyword">or</span> label_idx_list == <span class="hljs-literal">None</span>:<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Model not found&#x27;</span><br>    <br>    result = &#123;&#125;<br>    result[<span class="hljs-string">&#x27;text&#x27;</span>] = text<br>    numbers = [<span class="hljs-built_in">int</span>(x) <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> loader.predict(text,model)]<br>    <br>    labels = loader.convert_result2label(numbers,label_idx_list)<br>    entities = loader.convert_label2entity(labels)<br><br>    result[<span class="hljs-string">&#x27;ents&#x27;</span>] = entities<br>    result[<span class="hljs-string">&#x27;title&#x27;</span>] = <span class="hljs-literal">None</span><br>    <span class="hljs-built_in">print</span>(result)<br>    <br>    <span class="hljs-comment"># é…ç½®éœ€è¦å±•ç¤ºçš„å®ä½“ï¼Œä»loaderä¸­åŠ è½½é¢œè‰²é…ç½®</span><br>    options = &#123;<span class="hljs-string">&quot;ents&quot;</span>: [<span class="hljs-string">&quot;ORG.NAM&quot;</span>,<br>                        <span class="hljs-string">&quot;GPE.NAM&quot;</span>,<br>                        <span class="hljs-string">&quot;PER.NAM&quot;</span>,<br>                        <span class="hljs-string">&quot;LOC.NAM&quot;</span>,<br>                        <span class="hljs-string">&quot;LOC.NOM&quot;</span>,<br>                        <span class="hljs-string">&quot;PER.NOM&quot;</span>,<br>                        <span class="hljs-string">&quot;ORG.NOM&quot;</span><br>                        ], <span class="hljs-string">&quot;colors&quot;</span>: loader.load_colors_preset()&#125;<br>    html = displacy.render(result, style=<span class="hljs-string">&quot;ent&quot;</span>, manual=<span class="hljs-literal">True</span>, options=options)<br><br>    response = make_response(html,<span class="hljs-number">200</span>)<br>    <span class="hljs-keyword">return</span> response<br></code></pre></td></tr></table></figure>
<h1 id="webå®¢æˆ·ç«¯">Webå®¢æˆ·ç«¯</h1>
<p>é¢„æµ‹è¿‡ç¨‹åœ¨ä¸ªäººæœåŠ¡å™¨ä¸Šä¼šèŠ±è´¹è¾ƒå¤šæ—¶é—´ï¼Œå› æ­¤éœ€è¦åœ¨é¡µé¢ä¸­ä½¿ç”¨jså¼‚æ­¥æ§åˆ¶å‘é€getè¯·æ±‚å’Œè·å–å“åº”ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨è¡¨å•formæäº¤getè¯·æ±‚ï¼Œä¸ç„¶ä¼šä¸€ç›´å¡ä½ä¸åŠ¨è€Œå®é™…ä¸Šæ˜¯åœ¨ç­‰å¾…å“åº”ï¼Œç±»ä¼¼äºå®¢æˆ·ç«¯å¤šçº¿ç¨‹è¯·æ±‚ï¼Œè¿™é‡Œä½¿ç”¨jsçš„fetchå‘é€getè¯·æ±‚ï¼Œå¹¶ä¿®æ”¹é¡µé¢å†…å®¹è¡¨ç¤ºæ­£åœ¨ç­‰å¾…å“åº”ï¼Œç­‰æ”¶åˆ°å“åº”åä¿®æ”¹htmlæ–‡ä»¶ã€‚</p>
<figure class="highlight html"><table><tr><td class="code"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span><br><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">submitForm</span>(<span class="hljs-params"></span>) &#123;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> text = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;my-text&quot;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> model = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">querySelector</span>(<span class="hljs-string">&#x27;input[name=&quot;model&quot;]:checked&#x27;</span>).<span class="hljs-property">value</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> waiting = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;waiting-text&quot;</span>);</span><br><span class="language-javascript">        waiting.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;æ­£åœ¨é¢„æµ‹...&#x27;</span>;</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> displacy = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">&quot;visual&quot;</span>);</span><br><span class="language-javascript">        <span class="hljs-keyword">var</span> url = <span class="hljs-string">&quot;/predict?text=&quot;</span> + text + <span class="hljs-string">&quot;&amp;model=&quot;</span> + model;</span><br><span class="language-javascript">        <span class="hljs-keyword">const</span> response = <span class="hljs-title function_">fetch</span>(url, &#123;</span><br><span class="language-javascript">            <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,</span><br><span class="language-javascript">        &#125;).<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) &#123;</span><br><span class="language-javascript">            <span class="hljs-keyword">return</span> response.<span class="hljs-title function_">text</span>();</span><br><span class="language-javascript">        &#125;)</span><br><span class="language-javascript">        .<span class="hljs-title function_">then</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) &#123;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(data);</span><br><span class="language-javascript">                waiting.<span class="hljs-property">innerHTML</span> = <span class="hljs-string">&#x27;&#x27;</span>;</span><br><span class="language-javascript">                displacy.<span class="hljs-property">innerHTML</span> = data;</span><br><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&quot;ok!!!&quot;</span>);</span><br><span class="language-javascript">            &#125;);</span><br><span class="language-javascript">    &#125;</span><br><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br>......<br><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;input&quot;</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>è¾“å…¥å¾…é¢„æµ‹æ–‡æœ¬ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">textarea</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;my-text&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;text&quot;</span> <span class="hljs-attr">rows</span>=<span class="hljs-string">&quot;3&quot;</span> <span class="hljs-attr">cols</span>=<span class="hljs-string">&quot;20&quot;</span>&gt;</span>æˆ‘å°±è¦åœ¨ä¸­å›½ä¼ åª’å¤§å­¦åƒä¸Šå´”æ°¸å…ƒçœŸé¢<span class="hljs-tag">&lt;/<span class="hljs-name">textarea</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>é€‰æ‹©ä¸€ä¸ªæ¨¡å‹ï¼š<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;model&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;rbt3-mlp-ner&quot;</span> <span class="hljs-attr">checked</span>=<span class="hljs-string">&quot;true&quot;</span>&gt;</span>rbt3-mlp-ner<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;radio&quot;</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;model&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;rbt3-bilstm-crf-ner&quot;</span>&gt;</span>rbt3-bilstm-crf-ner<span class="hljs-tag">&lt;<span class="hljs-name">br</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">input</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;submit&quot;</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;my-button&quot;</span> <span class="hljs-attr">value</span>=<span class="hljs-string">&quot;æäº¤å¼€å§‹é¢„æµ‹&quot;</span> <span class="hljs-attr">onclick</span>=<span class="hljs-string">&quot;submitForm()&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span><br></code></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Bert</tag>
        <tag>NLP</tag>
        <tag>NER</tag>
        <tag>python</tag>
        <tag>flask</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€Šå£°ä¸æƒ…ï¼šæ’­éŸ³ç”¨å£°çš„å®è¯ç ”ç©¶ã€‹ç¬”è®°</title>
    <url>/2022/11/03/sheng-yu-qing-bo-yin-yong-sheng-de-shi-zheng-yan-jiu-bi-ji/</url>
    <content><![CDATA[<blockquote>
<p>é“¾æ¥ï¼šhttps://www.zhizhen.com/detail_38502727e7500f26ca5684ae8f3c3b6429bcb36a14c533e11921b0a3ea25510134114c969f2eae5c9837344477b6470412f90171de0b6360e6b1c5d917c82372d97823f6a9338067eed855d3fbe548a5?&amp;apistrclassfy=0_7_3</p>
</blockquote>
<h1 id="æ„ä¹‰">æ„ä¹‰</h1>
<p>æ’­éŸ³å­¦åŸåˆ™ï¼š<strong>ä»¥æƒ…å¸¦å£°</strong></p>
<p>æ¢è®¨<u>æ’­éŸ³è¯­è¨€çš„è‰ºæœ¯ç”¨å£°</u>åœ¨éŸµå¾‹èŠ‚å¥ä¸Šçš„</p>
<ul>
<li>è§„å¾‹ã€ç‰¹ç‚¹</li>
<li>å£°å­¦è¡¨ç°ç‰¹å¾</li>
<li>å‘éŸ³äººçš„å‘¼å¸ç‰¹ç‚¹</li>
</ul>
<p>ç”¨äºæŒ‡å¯¼ï¼š</p>
<ul>
<li>å…·ä½“å®è·µï¼Œè§£å†³ä¸»æŒäººå’Œæ’­éŸ³å‘˜çš„ç”¨å£°é—®é¢˜</li>
<li>æ’­éŸ³æ•™å­¦</li>
</ul>
<h1 id="å®éªŒå†…å®¹">å®éªŒå†…å®¹</h1>
<h2 id="è®¾å¤‡">è®¾å¤‡</h2>
<ul>
<li><p>è¯ç­’å’Œè°ƒéŸ³å°ï¼šè¯­éŸ³ä¿¡å·</p></li>
<li><p>ç”µå­å£°é—¨ä»ªï¼šå—“éŸ³ä¿¡å·</p></li>
<li><p>å‘¼å¸å¸¦ï¼šèƒ¸å‘¼å¸ä¿¡å·ã€è…¹å‘¼å¸ä¿¡å·</p></li>
</ul>
<h3 id="å®è¯ç ”ç©¶ä¸€">å®è¯ç ”ç©¶ä¸€</h3>
<table>

<thead>
<tr class="header">
<th style="text-align: center;">è¯­æ–™åˆ†ç±»</th>
<th style="text-align: center;">è¯­æ–™æ¥æº</th>
<th style="text-align: center;">å­—æ•°</th>
<th style="text-align: center;">å‘è¨€äºº</th>
<th style="text-align: center;">æœ‰æ•ˆäººæ•°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">æ•£æ–‡è¯­å¥</td>
<td style="text-align: center;">ã€ŠåŒ†åŒ†ã€‹ã€ŠçŸ³ç¼é—´çš„ç”Ÿå‘½ã€‹å®Œæ•´ç‰‡æ®µ</td>
<td style="text-align: center;">200+</td>
<td style="text-align: center;">å‰æ—å¤§å­¦æ’­éŸ³ä¸“ä¸šå¤§ä¸‰å­¦ç”Ÿ</td>
<td style="text-align: center;">4</td>
</tr>
<tr class="even">
<td style="text-align: center;">æ–°é—»è¯­å¥</td>
<td style="text-align: center;"></td>
<td style="text-align: center;">200+</td>
<td style="text-align: center;">å‰æ—å¤§å­¦æ’­éŸ³ä¸“ä¸šå¤§ä¸‰å­¦ç”Ÿ</td>
<td style="text-align: center;">6</td>
</tr>
</tbody>
</table>
<table>

<thead>
<tr class="header">
<th style="text-align: center;">æ–‡æœ¬ç±»å‹</th>
<th style="text-align: center;">ç‰©ç†ç‰¹å¾</th>
<th style="text-align: left;">å®éªŒç»“æœ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">æ•£æ–‡è¯­å¥</td>
<td style="text-align: center;">åœé¡¿</td>
<td style="text-align: left;">ä¸å¸¦æƒ…æ„Ÿçš„å°åœé¡¿å¤šäºå¤§åœé¡¿
å¸¦æƒ…æ„Ÿçš„å¤§åœé¡¿å¤šäºä¸å¸¦æƒ…æ„Ÿçš„å¤§åœé¡¿ å¸¦æƒ…æ„Ÿçš„å°åœé¡¿å¤šäºç­‰äºå¤§åœé¡¿æ•°é‡</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">åŸºé¢‘</td>
<td style="text-align: left;">å˜åŒ–ä¸å¤§ã€‚ç”·80-250Hzï¼Œå¥³150-330Hz</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">èƒ½é‡</td>
<td style="text-align: left;">å˜åŒ–ä¸å¤§ã€‚15-17dB</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">å‘¼å¸</td>
<td style="text-align: left;">æœ‰æ„Ÿæƒ…å‘¼å¸åœ¨æ¬¡æ•°ã€é‡ç½®å¹…åº¦éƒ½å˜å¤šã€‚å…¶ä¸­è…¹å‘¼å¸æŠ–åŠ¨æ¯”èƒ¸å‘¼å¸å¤šï¼Œè¯´æ˜æœ‰æ›´å¤šçš„å·æ°”ã€‚èƒ¸è…¹å‘¼å¸èµ·ä¼èµ°å‘å¤§ä½“ä¸€è‡´ã€‚</td>
</tr>
<tr class="odd">
<td style="text-align: center;">æ–°é—»è¯­å¥</td>
<td style="text-align: center;">åœé¡¿</td>
<td style="text-align: left;">ä¸å¯¹æ¯”æœ‰æ— æƒ…æ„Ÿã€‚</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">åŸºé¢‘</td>
<td style="text-align: left;">ç”·100-200Hzï¼Œå¥³150-300Hz</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">èƒ½é‡</td>
<td style="text-align: left;">ç”·22.82-89.51dBï¼Œå¥³22.52-89.47dB</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">å‘¼å¸</td>
<td style="text-align: left;">èƒ¸è…¹å‘¼å¸èµ·ä¼èµ°å‘å¤§ä½“ä¸€è‡´ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="å®è¯ç ”ç©¶äºŒ">å®è¯ç ”ç©¶äºŒ</h3>
<table style="width:100%;">

<thead>
<tr class="header">
<th style="text-align: center;">è¯­æ–™åˆ†ç±»</th>
<th style="text-align: center;">è¯­æ–™æ¥æº</th>
<th style="text-align: center;">å­—æ•°</th>
<th style="text-align: center;">å‘è¨€äºº</th>
<th style="text-align: center;">æœ‰æ•ˆäººæ•°</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">æ•£æ–‡è¯­å¥</td>
<td style="text-align: center;">ã€Šå¤§æµ·å•Šæ•…ä¹¡ã€‹ã€ã€Šä¹¡æ„ã€‹ã€ã€Šå¤œè¿‡åŒ—æµ·æ¡¥ã€‹</td>
<td style="text-align: center;">300-</td>
<td style="text-align: center;">å‰æ—å¤§å­¦æ’­éŸ³ä¸“ä¸šå¤§ä¸€å­¦ç”Ÿï¼ˆç¬¬ä¸‰å‘¨ï¼‰</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">æ•£æ–‡è¯­å¥</td>
<td style="text-align: center;">ã€Šå¤§æµ·å•Šæ•…ä¹¡ã€‹ã€ã€Šä¹¡æ„ã€‹ã€ã€Šå¤œè¿‡åŒ—æµ·æ¡¥ã€‹</td>
<td style="text-align: center;">300-</td>
<td style="text-align: center;">å‰æ—å¤§å­¦æ’­éŸ³ä¸“ä¸šå¤§ä¸€å­¦ç”Ÿï¼ˆç¬¬å…«å‘¨ï¼‰</td>
<td style="text-align: center;">6</td>
</tr>
</tbody>
</table>
<p><u><strong>è¿™é‡Œä¼šè¦æ±‚å­¦ç”Ÿçš„æƒ…æ„Ÿå®è¿‡å‹¿æ¬ </strong></u></p>
<table>

<thead>
<tr class="header">
<th style="text-align: center;">æ–‡æœ¬ç±»å‹</th>
<th style="text-align: center;">ç‰©ç†ç‰¹å¾</th>
<th style="text-align: left;">å®éªŒç»“æœ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">æ•£æ–‡è¯­å¥</td>
<td style="text-align: center;">åœé¡¿</td>
<td style="text-align: left;">æ€»æ•°å¤šï¼Œå¸¦æƒ…æ„Ÿçš„å¤§åœé¡¿æ˜¾è‘—å¤šäºå°åœé¡¿ï¼Œæ—¶é•¿æœ‰æ‰€ä¸åŒ</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">åŸºé¢‘</td>
<td style="text-align: left;">å¥³150-290Hzå˜ä¸º150-320Hzï¼Œç”·100-260Hzå˜ä¸º120-230Hz</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">èƒ½é‡</td>
<td style="text-align: left;">æœ‰æƒ…çš„èƒ½é‡ä½</td>
</tr>
<tr class="even">
<td style="text-align: center;"></td>
<td style="text-align: center;">å‘¼å¸</td>
<td style="text-align: left;">æœ‰æƒ…çš„å‘¼å¸é‡ç½®æ¬¡æ•°å¢å¤šï¼Œå¹…åº¦åŠ å¤§ï¼Œæ— å£°æ®µæ—¶é•¿æ›´é•¿ã€‚èƒ¸è…¹å‘¼å¸åŸºæœ¬ä¿æŒä¸€è‡´ã€‚</td>
</tr>
<tr class="odd">
<td style="text-align: center;"></td>
<td style="text-align: center;">æ—¶é•¿</td>
<td style="text-align: left;">å¸¦æƒ…æ„Ÿçš„å¥å­æ—¶é•¿æ˜¯ä¸å¸¦æƒ…æ„Ÿçš„æ—¶é•¿è¿‘ä¹2å€</td>
</tr>
</tbody>
</table>
<h1 id="æ’­éŸ³å­¦è§£é‡Š">æ’­éŸ³å­¦è§£é‡Š</h1>
<p>â€œå£°è¶³æƒ…æ¬ â€â€œæƒ…è¶³å£°æ¬ â€è¯´æ˜ä¸å’Œè°ï¼Œâ€œæƒ…æ¬ â€ä¸å¥½ï¼Œâ€œå£°æ¬ â€ä¹Ÿä¸å¥½ï¼Œè¿™éƒ½å½±å“éŸµå¾‹ã€‚</p>
<p><strong>éŸ³æ­¥</strong>ä½œä¸ºæ±‰è¯­çš„å°èŠ‚å¥å•å…ƒï¼Œæœ¬æ–‡æŠŠæ±‰è¯­ä¸­çš„éŸ³æ­¥æ¦‚æ‹¬ä¸ºï¼š</p>
<p>ç”±è‹¥å¹²ä¸ªéŸ³èŠ‚æ„æˆçš„è¯­éŸ³ç‰‡æ®µï¼Œåœ¨éŸ³æ­¥å†…å’ŒéŸ³æ­¥é—´ä¹Ÿå­˜åœ¨é•¿çŸ­ã€é«˜ä½ã€å¼ºå¼±çš„å¯¹æ¯”ï¼Œä¸”<u><strong>éŸ³æ­¥é—´è¢«åœé¡¿åˆ†å¼€</strong></u>ã€‚æœ¬æ–‡å¯¹æ•£æ–‡è¯­å¥çš„éŸµå¾‹å±‚çº§çš„åˆ’åˆ†ä¹Ÿå°†ä»éŸ³æ­¥å¼€å§‹ã€‚</p>
<p><img src="/2022/11/03/sheng-yu-qing-bo-yin-yong-sheng-de-shi-zheng-yan-jiu-bi-ji/image-20221106140548462.png" alt="image-20221106140548462" style="zoom:50%;"></p>
<p>â‘ å¶å†›ï¼šã€Šæ±‰è¯­è¯­å¥éŸµå¾‹çš„åŠŸèƒ½ç ”ç©¶ã€‹ï¼šhttp://www.docin.com/p-12614263.html.</p>
<p>åœ¨å®é™…çš„è¨€è¯­ä¸­ï¼ŒéŸµå¾‹æœ‰ç€ä¸åŒçš„å±‚çº§ï¼Œå„å±‚çº§ä¹‹é—´çš„è¿‡æ¸¡å’Œæ¥å£åˆ™æ‰¿è½½ç€éå¸¸é‡è¦çš„è¨€è¯­èŠ‚å¾‹ç‰¹å¾ã€‚åœ¨å£°å­¦ä¸Šï¼Œå®ƒä»¬ä¸»è¦è¡¨ç°ä¸ºåœå»¶ã€‚<strong>åœå»¶æ˜¯è¯´è¯æˆ–æœ—è¯»æ—¶è¯­æµä¸­å£°éŸ³çš„ä¸­æ–­å’Œå»¶è¿</strong>ï¼Œå®ƒèµ·åˆ°è¨€è¯­åœ¨è¯­æµä¸­çš„åˆ†åˆä½œç”¨ã€‚</p>
<p><img src="/2022/11/03/sheng-yu-qing-bo-yin-yong-sheng-de-shi-zheng-yan-jiu-bi-ji/image-20221103222828943.png" alt="image-20221103222828943" style="zoom:50%;"></p>
<p><img src="/2022/11/03/sheng-yu-qing-bo-yin-yong-sheng-de-shi-zheng-yan-jiu-bi-ji/image-20221103222922094.png" alt="image-20221103222922094" style="zoom:50%;"></p>
<p>èŠ‚å¥çš„æŠ€å·§æ˜¯æ¬²é«˜å…ˆä½ï¼Œæ¬²ä½å…ˆé«˜ï¼›æ¬²è½»å…ˆé‡ï¼Œæ¬²é‡å…ˆè½»ï¼›é€¢æ…¢å¿…å…ˆå¿«ï¼Œé€¢å¿«å¿…å…ˆæ…¢ï¼Œå³<strong>èŠ‚å¥æ˜¯é€šè¿‡é«˜ä½ã€å¿«æ…¢ã€è½»é‡</strong>ä½“ç°ã€‚</p>
<p>ä»ä¸Šæ–‡è®ºè¿°ä¸­ï¼Œæˆ‘ä»¬å¾—å‡ºç†è®ºä¸Šçš„å‡è®¾æ˜¯ï¼šæƒ…æ„Ÿçš„è¡¨ç°ä¸éŸ³é«˜å˜åŒ–ã€å£°éŸ³å¼ºåº¦ã€å¿«æ…¢æœ‰å…³ï¼Œè€Œè¿™äº›åˆéƒ½ä¸å‘¼å¸åœé¡¿ç›´æ¥ç›¸å…³ï¼Œæ°æ°<strong>åœé¡¿æœ€èƒ½ä½“ç°æ±‰è¯­è¨€èŠ‚å¥çš„ç‰¹ç‚¹</strong>ï¼Œå› è€Œæœ¬æ–‡å°±æ˜¯é€šè¿‡å®è¯æ€§çš„ç ”ç©¶è¯æ˜æ’­éŸ³è‰ºæœ¯è¯­è¨€ä½¿ç”¨ä¸­ï¼Œæƒ…æ„Ÿå½±å“å‘¼å¸ï¼Œå‘¼å¸å½±å“åœå»¶ï¼Œåœå»¶è¡¨ç°è¯­è¨€èŠ‚å¥ï¼Œè¿™äº›è¯­éŸ³çš„å®é™…è¡¨ç°å½¢å¼åˆå†³å®šäº†æ’­éŸ³è¯­è¨€è¯­ä¹‰ä¿¡æ¯åŠæƒ…æ„Ÿä¿¡æ¯è¡¨è¾¾çš„ä¿¡åº¦å’Œæ•ˆåº¦ã€‚</p>
]]></content>
  </entry>
  <entry>
    <title>ä½¿ç”¨wireguardæ­å»ºå±äºè‡ªå·±çš„è™šæ‹Ÿå†…ç½‘</title>
    <url>/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/</url>
    <content><![CDATA[<h1 id="ä½¿ç”¨wireguardæ­å»ºå±äºè‡ªå·±çš„è™šæ‹Ÿå†…ç½‘">ä½¿ç”¨wireguardæ­å»ºå±äºè‡ªå·±çš„è™šæ‹Ÿå†…ç½‘</h1>
<blockquote>
<p>æœ¬æ–‡å°†ä½¿ç”¨wireguardçš„dockeré•œåƒï¼Œå€ŸåŠ©ä¸­è½¬æœåŠ¡å™¨ï¼Œå¿«é€Ÿæ–¹ä¾¿çš„éƒ¨ç½²å‡ºä¸€ä¸ªå±äºè‡ªå·±çš„è™šæ‹Ÿå†…ç½‘ï¼Œç½‘å†…åœ°å€å®Œå…¨è‡ªå®šä¹‰ï¼Œæ”¯æŒå…¨å¹³å°ã€‚</p>
</blockquote>
<h2 id="wireguardç»“æœå±•ç¤º">wireguardç»“æœå±•ç¤º</h2>
<p>wireguardåˆ†ä¸ºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ï¼Œå…¶ä¸­æœåŠ¡ç«¯éœ€è¦éƒ¨ç½²åœ¨æœ‰å…¬ç½‘IPçš„æœåŠ¡å™¨ä¸Šï¼Œéœ€è¦åŠ å…¥å†…ç½‘çš„è®¾å¤‡éœ€è¦å•ç‹¬å®‰è£…å®¢æˆ·ç«¯å¹¶å¯åŠ¨ã€‚</p>
<p>åœ¨éƒ¨ç½²å®Œæˆåæ˜¯è¿™æ ·çš„æ•ˆæœï¼š</p>
<figure>
<img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/éƒ¨ç½²å®Œæˆæµ‹é€Ÿ.png" alt="éƒ¨ç½²å®Œæˆæµ‹é€Ÿ">
<figcaption aria-hidden="true">éƒ¨ç½²å®Œæˆæµ‹é€Ÿ</figcaption>
</figure>
<p>å³ä¾§æµ‹é€Ÿç»“æœæ˜¾ç¤º5.67/5.63Mbpsï¼Œ<strong>è·‘æ»¡</strong>äº†æˆ‘çš„ä¸­è½¬æœåŠ¡å™¨çš„<strong>6Mbps</strong>ï¼Œé€Ÿåº¦è¿˜æ˜¯ååˆ†ç»™åŠ›çš„ã€‚</p>
<p>åœ¨æ‰‹æœºä¸Šæˆ‘ä¹Ÿå¯ä»¥ç›´æ¥é€šè¿‡<strong>å†…ç½‘IP</strong>åœ¨å¤–é¢è®¿é—®åˆ°NASä¸­çš„æ•°æ®ï¼š</p>
<p><img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/æ‰‹æœºä¸Šçš„ç¾¤æ™–.PNG" alt="æ‰‹æœºä¸Šçš„ç¾¤æ™–" style="zoom:33%;"></p>
<p>åŒæ—¶é…ç½®åœ¨labå†…ç½‘çš„ä¸ªäººæœåŠ¡å™¨ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å†…ç½‘sshè®¿é—®ï¼Œè¿™ä¸€ç‚¹å’Œé…ç½®frpçš„æ•ˆæœå€’æ˜¯ç›¸åŒçš„ã€‚ä¸è¿‡æˆ‘è®¤ä¸ºwireguardå¼ºå¤§å°±åœ¨äºï¼Œä¸ç”¨åƒfrpæ¯ä¸ªéœ€è¦å¼€æ”¾çš„ç«¯å£éƒ½å¾—é…ç½®ï¼Œç„¶ååœ¨ä¸­è½¬æœåŠ¡å™¨å¼€ç«¯å£ã€‚wireguardæœ¬ä½“åªéœ€è¦åœ¨ä¸­è½¬æœåŠ¡å™¨å¼€ä¸€ä¸ªUDPç«¯å£å°±å¯ä»¥ä½¿ç”¨å†…ç½‘è®¿é—®å…¶ä»–å®¢æˆ·ç«¯æ‰€æœ‰çš„ç«¯å£ã€‚è¿™åœ¨åšè°ƒè¯•å·¥ä½œæ—¶ä¼šæ–¹ä¾¿è®¸å¤šã€‚</p>
<figure>
<img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/image-20221016121811707.png" alt="è®¿é—®è™šæ‹Ÿå†…ç½‘ä¸­çš„hadoop">
<figcaption aria-hidden="true">è®¿é—®è™šæ‹Ÿå†…ç½‘ä¸­çš„hadoop</figcaption>
</figure>
<blockquote>
<p>è™½ç„¶labå†…çš„ç¯å¢ƒæ›´èˆ’é€‚ï¼Œä½†æ€»æ˜¯æƒ³éšæ—¶è®¿é—®æŸäº›æœåŠ¡çš„å†²åŠ¨æˆ‘æƒ³å¥½å¤šäººéƒ½ä¼šæœ‰å§å“ˆå“ˆå“ˆå“ˆå“ˆ</p>
</blockquote>
<h2 id="å¿«é€Ÿæ­å»ºwireguard">å¿«é€Ÿæ­å»ºwireguard</h2>
<blockquote>
<p>æ­å»ºè¿‡ç¨‹ä¹Ÿå¯ä»¥å‚è€ƒï¼šhttps://gitee.com/spoto/wireguard</p>
</blockquote>
<p>æœ¬æ–‡ä½¿ç”¨<code>weejewel/wg-easy</code>çš„dockeré•œåƒå¿«é€Ÿæ­å»ºèµ·å¯ç”¨çš„è™šæ‹Ÿå†…ç½‘ã€‚</p>
<p>é¦–å…ˆç™»é™†ä¸­è½¬æœåŠ¡å™¨ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨çš„æ˜¯è…¾è®¯äº‘ä¸Šçš„ubuntuæœåŠ¡å™¨ï¼Œå°†ä¸‹é¢çš„å‘½ä»¤æ”¹å¥½åç›´æ¥è¿è¡Œï¼ˆIPã€å¯†ç ã€ç½‘æ®µéƒ½éœ€è¦å¡«è‡ªå·±çš„å“¦ï¼‰</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo docker run -d \<br>  --name=wg-easy \<br>  -e WG_HOST=123.123.123.123 (ğŸš¨è¿™é‡Œè¾“å…¥æœåŠ¡å™¨çš„å…¬ç½‘IP) \<br>  -e PASSWORD=passwd123 (ğŸš¨è¿™é‡Œè¾“å…¥ä½ çš„å¯†ç ) \<br>  -e WG_DEFAULT_ADDRESS=10.0.8.x ï¼ˆğŸš¨é»˜è®¤IPåœ°å€ï¼‰\<br>  -e WG_ALLOWED_IPS=10.0.8.0/24 ï¼ˆğŸš¨å…è®¸è¿æ¥çš„IPæ®µï¼‰\<br>  -e WG_PERSISTENT_KEEPALIVE=25 ï¼ˆğŸš¨é‡è¿é—´éš”ï¼‰\<br>  -v ~/.wg-easy:/etc/wireguard \<br>  -p 51820:51820/udp \<br>  -p 51821:51821/tcp \<br>  --cap-add=NET_ADMIN \<br>  --cap-add=SYS_MODULE \<br>  --sysctl=<span class="hljs-string">&quot;net.ipv4.conf.all.src_valid_mark=1&quot;</span> \<br>  --sysctl=<span class="hljs-string">&quot;net.ipv4.ip_forward=1&quot;</span> \<br>  --restart unless-stopped \<br>  weejewel/wg-easy<br></code></pre></td></tr></table></figure>
<p>è¿è¡Œèµ·æ¥ä¹‹åè®°å¾—å¼€å¯ä¸¤ä¸ªè®¾ç½®è¿‡çš„ç«¯å£ï¼Œä¸€ä¸ªudpä¸€ä¸ªtcpï¼Œç„¶åå¯ä»¥æ ¹æ®tcpç«¯å£ç™»é™†åˆ°ç®¡ç†ç•Œé¢ï¼Œè¾“å…¥åˆšæ‰è®¾ç½®çš„å¯†ç ï¼Œè¿™å°±æ˜¯è¿™ä¸ªé•œåƒçš„æ–¹ä¾¿å¿«æ·ä¹‹å¤„ï¼Œå‡å°‘äº†æ‰‹åŠ¨åˆ›å»ºé…ç½®çš„è¿‡ç¨‹ã€‚</p>
<figure>
<img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/image-20221016122810680.png" alt="åˆ›å»ºå®Œæˆé…ç½®å®Œæˆåçš„æ ·å­">
<figcaption aria-hidden="true">åˆ›å»ºå®Œæˆé…ç½®å®Œæˆåçš„æ ·å­</figcaption>
</figure>
<p>æˆ‘è¿™é‡Œæ˜¾ç¤ºçš„å°±æ˜¯é…ç½®å®¢æˆ·ç«¯ä¹‹åçš„æ ·å­ï¼Œä¸€å¼€å§‹è¿›æ¥è¿˜ä»€ä¹ˆéƒ½æ²¡æœ‰ï¼Œå…ˆç‚¹å‡»<code>+New</code>åˆ›å»ºä¸€ä¸ªæ–°çš„é…ç½®ã€‚</p>
<ol type="1">
<li><p>å¦‚æœä¸ç†Ÿæ‚‰çš„è¯å¯ä»¥å…ˆç”¨æ‰‹æœºä¸‹è½½å¯¹åº”çš„å®¢æˆ·ç«¯ï¼ˆåå­—å°±æ˜¯wireguardï¼‰ï¼Œç„¶åæ‰«ç æ·»åŠ é…ç½®ï¼Œå°±è¿›å…¥åˆ°å†…ç½‘äº†ã€‚</p></li>
<li><p>å¦‚æœæ˜¯Macå’ŒWindowsä¹Ÿæ˜¯ä¸€æ ·çš„é…ç½®æ–¹æ³•ï¼š</p>
<ul>
<li>å…ˆä¸‹è½½å®¢æˆ·ç«¯ï¼ŒMacç›´æ¥åœ¨appstoreæœç´¢wireguardï¼Œæ¸¯åŒºå¯ä»¥ç‚¹è¿™é‡Œ<a href="https://apps.apple.com/hk/app/wireguard/id1451685025?mt=12">æ¸¯åŒºwireguardé“¾æ¥</a></li>
<li>ä¸‹è½½ç®¡ç†ç•Œé¢çš„é…ç½®æ–‡ä»¶xxx.conf</li>
<li>å®¢æˆ·ç«¯å†…æ·»åŠ éš§é“ï¼Œé€‰æ‹©xxx.conf</li>
<li>å¼€å¯éš§é“é“¾æ¥ï¼Œè¿›å…¥å†…ç½‘ï¼Œå¯ä»¥<code>ping</code>å‘½ä»¤æŸ¥çœ‹æ˜¯å¦é€šç•…</li>
</ul></li>
<li><p>å¦‚æœä½ æƒ³æŠŠubuntuç­‰æœåŠ¡å™¨åŠ å…¥wireguard:</p>
<ul>
<li>åœ¨Ubuntuä¸Šè¦ä¸‹è½½å®¢æˆ·ç«¯<code>sudo apt install wireguard</code></li>
<li>ä¸‹è½½ç®¡ç†ç•Œé¢çš„é…ç½®æ–‡ä»¶xxx.conf</li>
<li>scpä¸Šä¼ confæ–‡ä»¶åˆ°ubuntuï¼Œæˆ–è€…ç›´æ¥åœ¨ubuntuä¸Šæ–°å»ºæ–‡æ¡£å°†å†…å®¹å¤åˆ¶è¿›å»ï¼Œä¿è¯æ–‡ä»¶åä¸€æ ·</li>
<li><code>sudo wg-quick up xxx</code>å¼€å¯é…ç½®ï¼Œ<code>sudo wg-quick down xxx</code>å…³é—­é…ç½®</li>
<li><code>sudo wg</code>å¯ä»¥æŸ¥çœ‹wireguardå¼€å¯çš„æœåŠ¡ã€‚</li>
</ul>
<figure>
<img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/image-20221016161236707.png" alt="wireguardæŸ¥çœ‹å½“å‰å¼€æ”¾çš„è™šæ‹Ÿç½‘å¡">
<figcaption aria-hidden="true">wireguardæŸ¥çœ‹å½“å‰å¼€æ”¾çš„è™šæ‹Ÿç½‘å¡</figcaption>
</figure></li>
<li><p>å¦‚æœä½ æƒ³æŠŠNASåŠ å…¥wireguard(ä»¥ç¾¤æ™–ä¸ºä¾‹)ï¼š</p>
<ul>
<li><p>ç¾¤æ™–çš„å¥—ä»¶ä¸­å¿ƒåŠŸèƒ½ä¸å¤šï¼Œéœ€è¦åŠ å…¥ç¤¾ç¾¤æ‰©å±•ï¼Œç‚¹å‡»å¥—ä»¶ä¸­å¿ƒ-è®¾ç½®-å¥—ä»¶æ¥æº-æ–°å¢ï¼Œåç§°éšæ„ï¼Œä½ç½®https://spk7.imnks.com/</p>
<figure>
<img src="/2022/10/16/shi-yong-wireguard-da-jian-shu-yu-zi-ji-de-xu-ni-nei-wang/image-20221016162618677.png" alt="ç¾¤æ™–å†…çš„å¥—ä»¶ä¸­å¿ƒ">
<figcaption aria-hidden="true">ç¾¤æ™–å†…çš„å¥—ä»¶ä¸­å¿ƒ</figcaption>
</figure></li>
<li><p>åœ¨ç¤¾ç¾¤ä¸­æœç´¢wireguardå®‰è£…ï¼Œéœ€è¦sshåˆ°ç¾¤æ™–ä¸Šæ‰§è¡Œ<code>sudo sed -i 's/package/root/g' /var/packages/WireGuard/conf/privilege</code></p></li>
<li><p>åé¢æ­¥éª¤åŒUbuntuï¼Œåªæ˜¯çœç•¥äº†å®‰è£…aptå®‰è£…çš„æ­¥éª¤ã€‚</p></li>
</ul></li>
</ol>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>å†…ç½‘</tag>
        <tag>wireguard</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨ä¸­è½¬æœåŠ¡å™¨ä»£ç†è®¿é—®å†…ç½‘bySSinDocker</title>
    <url>/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/</url>
    <content><![CDATA[<h1 id="ç›®çš„">ç›®çš„</h1>
<p>é€šè¿‡å¸¸ç”¨çš„ä»£ç†è½¯ä»¶ï¼ˆå°ç«ç®­ï¼‰è¿æ¥åˆ°å¤„äºå†…ç½‘ç¯å¢ƒçš„ä»£ç†æœåŠ¡å™¨ï¼Œä»è€Œå®ç°åœ¨ä»»æ„åœ°æ–¹è®¿é—®å†…ç½‘çš„éœ€æ±‚ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å†…ç½‘è·³æ¿æœºè¿æ¥å…¶ä»–å†…ç½‘æœºå™¨ï¼Œçªç ´SSLä¼šè¯é™åˆ¶ã€‚</p>
<figure>
<img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027122230481.png" alt="åœ¨å¤–ç½‘å¯ä»¥ä½¿ç”¨ä»£ç†æœåŠ¡å™¨è®¿é—®å†…ç½‘æœåŠ¡">
<figcaption aria-hidden="true">åœ¨å¤–ç½‘å¯ä»¥ä½¿ç”¨ä»£ç†æœåŠ¡å™¨è®¿é—®å†…ç½‘æœåŠ¡</figcaption>
</figure>
<h1 id="æ­å»ºæ­¥éª¤">æ­å»ºæ­¥éª¤</h1>
<h2 id="æ¦‚è§ˆ">æ¦‚è§ˆ</h2>
<ol type="1">
<li><p>ä¸ºæ–¹ä¾¿å¿«æ·ï¼Œä½¿ç”¨dockeråœ¨å†…ç½‘ä¸­éƒ¨ç½²shadowsocksæœåŠ¡å™¨ï¼Œæ”¾å‡ºç«¯å£</p></li>
<li><p>ä¸ºä»å¤–éƒ¨è®¿é—®å†…ç½‘ï¼Œä½¿ç”¨dockeréƒ¨ç½²frpcç›‘å¬ssæœåŠ¡å™¨ç«¯å£ï¼Œè¿æ¥å¸¦æœ‰å…¬ç½‘IPçš„frps</p></li>
<li><p>ç»ˆç«¯è®¾å¤‡ä¸Šä½¿ç”¨Shadowrocketè¿æ¥ssæœåŠ¡å™¨ï¼Œé…ç½®èŠ‚ç‚¹</p></li>
</ol>
<h2 id="æ­å»ºssæœåŠ¡å™¨">æ­å»ºSSæœåŠ¡å™¨</h2>
<p>æ­¤å¤„é€‰æ‹©çš„dockeré•œåƒæ˜¯<a href="https://registry.hub.docker.com/r/gists/shadowsocks-libev/">gists/shadowsocks-libev</a>ï¼Œä¼˜åŠ¿æ˜¯å¾ˆè½»é‡ï¼Œåªæœ‰12Mï¼Œåé¢å¯ä»¥ç ”ç©¶v2rayæ’ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">docker run -d \<br>						--name ss \<br>           -p 8388:8388 \<br>           -p 8388:8388/udp \<br>           -e METHOD=aes-256-gcm \<br>           -e PASSWORD=YOUR_PASSWORD \<br>						gists/shadowsocks-libev<br></code></pre></td></tr></table></figure>
<h2 id="æ­å»ºfrpc">æ­å»ºfrpc</h2>
<p>å¦‚æœä½ æœ¬èº«å°±åœ¨ç”¨frpcï¼Œç›´æ¥æ·»åŠ ä¸€ä¸ªæ–°çš„æœåŠ¡åå’Œé…ç½®å°±å¥½ã€‚</p>
<p>éœ€è¦æå‰å†™å¥½frpcçš„é…ç½®æ–‡ä»¶ï¼Œé‡Œé¢éœ€è¦é…ç½®frpcç›‘å¬å’Œè½¬å‘åˆ°ä¸­è½¬æœåŠ¡å™¨çš„ç«¯å£ï¼Œè®°å¾—æ‰“å¼€ä¸­è½¬æœåŠ¡å™¨çš„é˜²ç«å¢™æ”¾è¡Œè¯¥ç«¯å£ã€‚æˆ‘è¿™è¾¹æ¼”ç¤ºä½¿ç”¨8389ç«¯å£ã€‚</p>
<p>frpc.inié…ç½®ç¤ºä¾‹</p>
<figure class="highlight ini"><table><tr><td class="code"><pre><code class="hljs ini"><span class="hljs-section">[common]</span><br><span class="hljs-attr">server_addr</span> = YOUR_IP<br><span class="hljs-attr">server_port</span> = <span class="hljs-number">7000</span><br><span class="hljs-attr">token</span> = YOUR_TOKEN<br><br><span class="hljs-section">[ss]</span><br><span class="hljs-attr">type</span> = tcp<br><span class="hljs-attr">local_ip</span> = <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><br><span class="hljs-attr">local_port</span> = <span class="hljs-number">8388</span><br><span class="hljs-attr">remote_port</span> = <span class="hljs-number">8389</span><br></code></pre></td></tr></table></figure>
<p>è¿è¡Œfrpc</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><code class="hljs awk">docker run  -d \<br>						--name frpc \<br>						--network host \ <br> 						-v <span class="hljs-regexp">/etc/</span>frp<span class="hljs-regexp">/frpc.ini:/</span>etc<span class="hljs-regexp">/frp/</span>frpc.ini \<br>						snowdreamtech/frpc<br></code></pre></td></tr></table></figure>
<h2 id="é…ç½®shadowrocketå°ç«ç®­">é…ç½®Shadowrocketå°ç«ç®­</h2>
<p>è¿›å…¥å°ç«ç®­ç‚¹å‡»å³ä¸Šè§’çš„åŠ å·</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027144752017.png" alt="image-20221027144752017" style="zoom: 25%;"></p>
<p>å¡«å†™å†…å®¹ï¼Œéœ€è¦å¯¹åº”ssæœåŠ¡å™¨ä¸Šçš„é…ç½®å¡«å†™</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027145506511.png" alt="image-20221027145506511" style="zoom: 25%;"></p>
<p>ç„¶åå¯ä»¥åœ¨é¦–é¡µçš„æœ¬åœ°èŠ‚ç‚¹ä¸­çœ‹åˆ°åˆšæ·»åŠ çš„èŠ‚ç‚¹</p>
<p>ç‚¹å‡»è¿é€šæ€§æµ‹è¯•æŸ¥çœ‹æ˜¯å¦ç½‘ç»œå·²æ‰“é€š</p>
<p>ä¹‹åæˆ‘ä»¬ä»¥å¤–ç½‘çš„ç¯å¢ƒå¼€å§‹æµ‹è¯•èƒ½å¦è®¿é—®å†…ç½‘ï¼Œæˆ‘è¿™é‡Œçš„å†…ç½‘ä½¿ç”¨çš„ç½‘æ®µæ˜¯192.168.31.0/24ï¼Œè€Œå°ç«ç®­é»˜è®¤æ˜¯ä¸è½¬å‘192.168.0.0/16ç½‘æ®µçš„æ•°æ®çš„ï¼ˆå› ä¸ºå†…ç½‘ä¸éœ€è¦è§„åˆ™è½¬å‘ï¼‰ï¼Œæ­¤å¤„éœ€è¦ä¿®æ”¹æˆ‘ä»¬çš„è§„åˆ™ï¼Œå»ºè®®å…ˆå¯¼å‡ºä¿å­˜ä¸€ä»½</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027150207562.png" alt="image-20221027150207562" style="zoom:25%;"></p>
<p>è¿›å…¥åç‚¹å‡»é€šç”¨</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027150257581.png" alt="image-20221027150257581" style="zoom:25%;"></p>
<p>æˆ‘åˆ é™¤è¿™é‡Œçš„ä¸¤ä¸ª192.168.0.0/16ç½‘æ®µï¼Œä½ éœ€è¦æ ¹æ®è‡ªå·±çš„å†…ç½‘ç½‘æ®µåˆ é™¤ã€‚</p>
<p>ç„¶åå‡†å¤‡æ·»åŠ é…ç½®æ–‡ä»¶ï¼Œç›®çš„æ˜¯å°†ä½ è‡ªå·±çš„å†…ç½‘IPé€šè¿‡ssæœåŠ¡å™¨è½¬å‘åˆ°å†…ç½‘ä¸­ã€‚ï¼ˆè¿™ä¸€æ­¥å»ºè®®å°†é»˜è®¤confé…ç½®æ–‡ä»¶å¤‡ä»½å¥½ï¼‰æˆ‘è¿™é‡Œè¿›å…¥default.confï¼Œç‚¹å‡»æµ‹è¯•è§„åˆ™ï¼Œæµ‹è¯•ä½ çš„å†…ç½‘IPã€‚</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027171319764.png" alt="image-20221027171319764" style="zoom:25%;"></p>
<p>æˆ‘è¿™é‡Œæµ‹è¯•æˆ‘çš„å†…ç½‘ç½‘å…³</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027171655099.png" alt="image-20221027171655099" style="zoom:25%;"></p>
<p>å¯ä»¥çœ‹åˆ°å®ƒæˆåŠŸæµ‹è¯•å‡ºäº†è¿™æ¡ç½‘å…³åœ°å€CIDRå‰ç¼€æ˜¯24ï¼Œå¹¶é€‰æ‹©ä½¿ç”¨PROXYè§„åˆ™è½¬å‘ç»™ä»£ç†æœåŠ¡å™¨ã€‚å¦‚æœæ— è¯¯å¯ä»¥ç›´æ¥ç‚¹å‡»<strong>æ·»åŠ IPåˆ°è§„åˆ™</strong>ã€‚</p>
<p>æˆ–è€…ä½ å¯ä»¥åƒæˆ‘ä¸€æ ·æ·»åŠ æ•´ä¸ªç½‘æ®µã€‚</p>
<figure>
<img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027171938222.png" alt="image-20221027171938222">
<figcaption aria-hidden="true">image-20221027171938222</figcaption>
</figure>
<p>è¿™æ ·å°±å¯ä»¥ç›´æ¥è®¿é—®å­ç½‘ä¸‹çš„æ‰€æœ‰è®¾å¤‡äº†ï¼Œæˆ‘è¿™é‡Œå¼€å¯è¿æ¥ssä»£ç†åå°±èƒ½ç›´æ¥è®¿é—®å†…ç½‘ä¸­çš„nas</p>
<p><img src="/2022/10/27/shi-yong-zhong-zhuan-fu-wu-qi-dai-li-fang-wen-nei-wang-byssindocker/image-20221027172217114.png" alt="image-20221027172217114" style="zoom: 25%;"></p>
<p>åé¢åªéœ€è¦åœ¨éœ€è¦è®¿é—®å†…ç½‘æ—¶å¼€å¯å°ç«ç®­ä»£ç†å°±å¯ä»¥äº†ï¼</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>ä»£ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Bertè¿›è¡Œä¸­æ–‡NERå‘½åå®ä½“è¯†åˆ«feat.fastNLPï¼ˆä¸Šï¼šæ¨¡å‹ç¯‡ï¼‰</title>
    <url>/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/</url>
    <content><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<blockquote>
<p>é¡¹ç›®å·¥ç¨‹åœ°å€ï¼šhttps://github.com/Ash-one/ChineseBert-finetuned-NER</p>
</blockquote>
<p>chatGPTçš„å¤§ç«è®©å¾ˆå¤šNLPå·¥ä½œè€…çš„ç ”ç©¶éƒ½é™·å…¥åƒµå±€ï¼ŒNERè¿™ç§ä¼ ç»Ÿä»»åŠ¡å¯¹äºè¿™ç§LLMå·²ç»å¯ä»¥è¯´æ˜¯å°èœä¸€ç¢Ÿã€‚</p>
<figure>
<img src="/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/newbingner.png" alt="NewBingè¿›è¡Œner">
<figcaption aria-hidden="true">NewBingè¿›è¡Œner</figcaption>
</figure>
<p>è™½ç„¶æ²¡èƒ½åŠ›æä¸ªGPTå‡ºæ¥ï¼Œæä¸ªç®€å•çš„Bertå¾®è°ƒè¿˜æ˜¯å¯ä»¥åšåˆ°çš„ã€‚</p>
<p>æœ¬æ–‡å¯¹äºNERå‘½åå®ä½“è¯†åˆ«ä»»åŠ¡ï¼Œä½¿ç”¨å¤æ—¦å¤§å­¦çš„fastNLPå·¥å…·åŒ…å¿«é€Ÿå®ŒæˆBertå¾®è°ƒå’Œé¢„æµ‹ä»»åŠ¡ï¼Œè¿˜å®ç°äº†Bert+BiLSTM+CRFçš„æ¨¡å‹æé«˜é¢„æµ‹å‡†ç¡®ç‡ï¼Œæœ€ç»ˆéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šå¯è§†åŒ–å‘ˆç°ã€‚</p>
<figure>
<img src="https://s2.loli.net/2023/03/25/e53mHihFl8JENqV.png" alt="ç»“æœå±•ç¤º">
<figcaption aria-hidden="true">ç»“æœå±•ç¤º</figcaption>
</figure>
<p>fastNLP<a href="http://document.fastnlp.top/docs/fastNLP/">æ–‡æ¡£</a>å’Œ<a href="https://gitee.com/fastnlp/fastNLP">giteeä»“åº“</a>æœ€è¿‘æ›´æ–°åœ¨äº”ä¸ªæœˆå‰ï¼Œè¿˜æ¯”è¾ƒæ´»è·ƒã€‚fastNLPåœ¨æ‰‹å†Œä¸Šæœ‰åºåˆ—æ ‡æ³¨çš„<a href="http://www.fastnlp.top/docs/fastNLP/master/tutorials/torch/fastnlp_torch_tutorial_seq_labeling.html">æºç å®ç°</a>ï¼Œæœ¬æ–‡åŸºäºæ­¤è¿›è¡Œæ”¹å†™ã€‚</p>
<h1 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h1>
<h2 id="ä½¿ç”¨å†…ç½®çš„dataloaderåŠ è½½weiboæ•°æ®é›†">ä½¿ç”¨å†…ç½®çš„dataloaderåŠ è½½Weiboæ•°æ®é›†</h2>
<p>fastNLPè‡ªå¸¦åº“ä¸­æœ‰è®¸å¤šå†…ç½®æ•°æ®é›†ï¼Œè¿™é‡Œé€‰æ‹©å¾®åšæ•°æ®é›†å±•ç¤ºï¼Œå…¶å®ä½“ç±»åˆ«åˆ†ä¸ºäººç‰©ï¼Œæœºæ„ç»„ç»‡ï¼Œåœ°å€å’Œåœ°ç¼˜æ”¿æ²»å®ä½“å››ä¸ªç±»åˆ«ï¼Œä¸”æ¯ä¸ªç±»åˆ«å¯ç»†åˆ†ä¸ºç‰¹æŒ‡ï¼ˆNAMï¼Œå¦‚â€œå¼ ä¸‰â€æ ‡ç­¾ä¸ºâ€œPER.NAMâ€ï¼‰å’Œæ³›æŒ‡ï¼ˆNOMï¼Œå¦‚â€œç”·äººâ€æ ‡ç­¾ä¸ºâ€œPER.NOMâ€ï¼‰ã€‚æ€»æ•°æ®é‡1890æ¡ã€‚</p>
<table>
<thead>
<tr class="header">
<th>å«ä¹‰</th>
<th>æ ‡ç­¾</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>åœ°åŒºåç‰¹æŒ‡ï¼Œå¦‚æ·±åœ³</td>
<td>B-GPE.NAM I-GPE.NAM</td>
</tr>
<tr class="even">
<td>åœ°åç‰¹æŒ‡ï¼Œå¦‚åå…‹å±±åº„</td>
<td>B-LOC.NAM I-LOC.NAM</td>
</tr>
<tr class="odd">
<td>åœ°åæ³›æŒ‡ï¼Œå¦‚å¯ºåº™</td>
<td>B-LOC.NOM I-LOC.NOM</td>
</tr>
<tr class="even">
<td>ç»„ç»‡åç‰¹æŒ‡</td>
<td>B-ORG.NAM I-ORG.NAM</td>
</tr>
<tr class="odd">
<td>ç»„ç»‡åæ³›æŒ‡</td>
<td>B-ORG.NOM I-ORG.NOM</td>
</tr>
<tr class="even">
<td>äººåç‰¹æŒ‡ï¼Œå¦‚æ–¹è¿›ç‰</td>
<td>B-PER.NAM I-PER.NAM</td>
</tr>
<tr class="odd">
<td>äººåæ³›æŒ‡ï¼Œå¦‚ç”·äºº</td>
<td>B-PER.NOM I-PER.NOM</td>
</tr>
<tr class="even">
<td>å…¶ä»–</td>
<td>O</td>
</tr>
</tbody>
</table>
<p>17ä¸ªæ ‡ç­¾çš„åˆ†å¸ƒå¦‚å›¾æ‰€ç¤ºï¼š</p>
<figure>
<img src="/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/æ•°æ®é›†æ ‡ç­¾æ€»è§ˆ.png" alt="æ•°æ®é›†æ ‡ç­¾æ€»è§ˆ">
<figcaption aria-hidden="true">æ•°æ®é›†æ ‡ç­¾æ€»è§ˆ</figcaption>
</figure>
<p>æ¥ä¸‹æ¥å¼€å§‹ä½¿ç”¨fastNLPåº“çš„loaderä¸‹è½½å¹¶åŠ è½½æ•°æ®åˆ°<code>data_bundle</code>ä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP.io <span class="hljs-keyword">import</span> WeiboNERLoader<br>data_bundle = WeiboNERLoader().load()<br><span class="hljs-built_in">print</span>(data_bundle)<br><span class="hljs-built_in">print</span>(data_bundle.get_dataset(<span class="hljs-string">&#x27;train&#x27;</span>)[:<span class="hljs-number">4</span>])<br></code></pre></td></tr></table></figure>
<p><code>data_bundle</code>å’Œå®ƒçš„åå­—ä¸€æ ·ï¼Œæ˜¯è®­ç»ƒé›†ã€éªŒè¯é›†ã€æµ‹è¯•é›†çš„æ‰“åŒ…ï¼Œéœ€è¦åˆ†åˆ«æå–ã€‚</p>
<figure class="highlight lasso"><table><tr><td class="code"><pre><code class="hljs lasso"><span class="hljs-keyword">In</span> total <span class="hljs-number">3</span> datasets:<br>        dev has <span class="hljs-number">270</span> instances.<br>        test has <span class="hljs-number">270</span> instances.<br>        train has <span class="hljs-number">1350</span> instances.<br><br>+------------------------------------------+------------------------------------------+<br>| raw_chars                                | target                                   |<br>+------------------------------------------+------------------------------------------+<br>| <span class="hljs-meta">[</span><span class="hljs-string">&#x27;ç§‘&#x27;</span>, <span class="hljs-string">&#x27;æŠ€&#x27;</span>, <span class="hljs-string">&#x27;å…¨&#x27;</span>, <span class="hljs-string">&#x27;æ–¹&#x27;</span>, <span class="hljs-string">&#x27;ä½&#x27;</span>, <span class="hljs-string">&#x27;èµ„&#x27;</span>, <span class="hljs-params">...</span> | <span class="hljs-meta">[</span><span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;... |</span><br><span class="hljs-string">| [&#x27;</span>å¯¹<span class="hljs-string">&#x27;, &#x27;</span>ï¼Œ<span class="hljs-string">&#x27;, &#x27;</span>è¾“<span class="hljs-string">&#x27;, &#x27;</span>ç»™<span class="hljs-string">&#x27;, &#x27;</span>ä¸€<span class="hljs-string">&#x27;, &#x27;</span>ä¸ª<span class="hljs-string">&#x27;, ... | [&#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>B<span class="hljs-params">-PER...</span> |<br>| <span class="hljs-meta">[</span><span class="hljs-string">&#x27;ä»Š&#x27;</span>, <span class="hljs-string">&#x27;å¤©&#x27;</span>, <span class="hljs-string">&#x27;ä¸‹&#x27;</span>, <span class="hljs-string">&#x27;åˆ&#x27;</span>, <span class="hljs-string">&#x27;èµ·&#x27;</span>, <span class="hljs-string">&#x27;æ¥&#x27;</span>, <span class="hljs-params">...</span> | <span class="hljs-meta">[</span><span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;O&#x27;</span>, <span class="hljs-string">&#x27;... |</span><br><span class="hljs-string">| [&#x27;</span>ä»Š<span class="hljs-string">&#x27;, &#x27;</span>å¹´<span class="hljs-string">&#x27;, &#x27;</span>æ‹œ<span class="hljs-string">&#x27;, &#x27;</span>å¹´<span class="hljs-string">&#x27;, &#x27;</span>ä¸<span class="hljs-string">&#x27;, &#x27;</span>çŸ­<span class="hljs-string">&#x27;, ... | [&#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span>O<span class="hljs-string">&#x27;, &#x27;</span><span class="hljs-params">...</span> |<br>+------------------------------------------+------------------------------------------+<br></code></pre></td></tr></table></figure>
<h2 id="è®¡ç®—æ•°æ®é›†ä¸­çš„å±æ€§">è®¡ç®—æ•°æ®é›†ä¸­çš„å±æ€§</h2>
<p>ä½¿ç”¨BertTokenizerå’ŒBPEç®—æ³•å¤„ç†æ–‡æœ¬ï¼Œå¾—åˆ°<code>input_ids|input_len | first| seq_len | new_target</code>è¿™å‡ åˆ—ï¼Œå…¶ä¸­<code>first</code>è¡¨ç¤º<code>bpe</code>ç®—æ³•çš„ç»“æœï¼Œåœ¨åé¢çš„æ¨¡å‹ä¸­ä¼šä½¿ç”¨ï¼Œè¿™é‡Œä½¿ç”¨<code>new_target</code>ä½œä¸ºæœ€ç»ˆlabelçš„ç¼–ç è¡¨ç¤ºã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertTokenizer<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> cache_results, Vocabulary<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_data</span>(<span class="hljs-params">data_bundle, model_name</span>):<br>    tokenizer = BertTokenizer.from_pretrained(model_name)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">bpe</span>(<span class="hljs-params">raw_words</span>):<br>        bpes = [tokenizer.cls_token_id]<br>        first = [<span class="hljs-number">0</span>]<br>        first_index = <span class="hljs-number">1</span>  <span class="hljs-comment"># è®°å½•ç¬¬ä¸€ä¸ªbpeçš„ä½ç½®</span><br>        <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> raw_words:<br>            bpe = tokenizer.encode(word, add_special_tokens=<span class="hljs-literal">False</span>)<br>            bpes.extend(bpe)<br>            first.append(first_index)<br>            first_index += <span class="hljs-built_in">len</span>(bpe)<br>        bpes.append(tokenizer.sep_token_id)<br>        first.append(first_index)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;input_ids&#x27;</span>: bpes, <span class="hljs-string">&#x27;input_len&#x27;</span>: <span class="hljs-built_in">len</span>(bpes), <span class="hljs-string">&#x27;first&#x27;</span>: first, <span class="hljs-string">&#x27;seq_len&#x27;</span>: <span class="hljs-built_in">len</span>(raw_words)&#125;<br>    <span class="hljs-comment"># å¯¹data_bundleä¸­æ¯ä¸ªdatasetçš„æ¯ä¸€æ¡æ•°æ®ä¸­çš„raw_charsä½¿ç”¨bpeå‡½æ•°ï¼Œå¹¶ä¸”å°†è¿”å›çš„ç»“æœåŠ å…¥åˆ°æ¯æ¡æ•°æ®ä¸­ã€‚</span><br>    data_bundle.apply_field_more(bpe, field_name=<span class="hljs-string">&#x27;raw_chars&#x27;</span>, num_proc=<span class="hljs-number">4</span>)<br>		<span class="hljs-comment"># --------------------------------------------è¿™é‡Œéœ€è¦æ³¨æ„field_name</span><br>    <span class="hljs-comment"># tagçš„è¯è¡¨ï¼Œç”±äºè¿™æ˜¯è¯è¡¨ï¼Œæ‰€ä»¥ä¸éœ€è¦æœ‰paddingå’Œunk</span><br>    tag_vocab = Vocabulary(padding=<span class="hljs-literal">None</span>, unknown=<span class="hljs-literal">None</span>)<br>    <span class="hljs-comment"># ä» train æ•°æ®çš„ raw_target ä¸­è·å–å»ºç«‹è¯è¡¨</span><br>    tag_vocab.from_dataset(data_bundle.get_dataset(<span class="hljs-string">&#x27;train&#x27;</span>), field_name=<span class="hljs-string">&#x27;target&#x27;</span>)<br>    <span class="hljs-comment"># ä½¿ç”¨è¯è¡¨å°†æ¯ä¸ª dataset ä¸­çš„targetè½¬ä¸ºæ•°å­—ï¼Œå¹¶ä¸”å°†å†™å…¥åˆ°new_targetè¿™ä¸ªfieldä¸­</span><br>    tag_vocab.index_dataset(data_bundle.datasets.values(), field_name=<span class="hljs-string">&#x27;target&#x27;</span>, new_field_name=<span class="hljs-string">&#x27;new_target&#x27;</span>)<br>    <br>    <span class="hljs-comment"># å¯ä»¥å°† vocabulary ç»‘å®šåˆ° data_bundle ä¸Šï¼Œæ–¹ä¾¿ä¹‹åä½¿ç”¨ã€‚</span><br>    data_bundle.set_vocab(tag_vocab, field_name=<span class="hljs-string">&#x27;new_target&#x27;</span>)<br>    <br>    <span class="hljs-keyword">return</span> data_bundle, tokenizer<br><br>data_bundle, tokenizer = process_data(data_bundle, <span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>)<br><span class="hljs-built_in">print</span>(data_bundle)<br><span class="hljs-built_in">print</span>(data_bundle.get_dataset(<span class="hljs-string">&quot;train&quot;</span>)[:<span class="hljs-number">4</span>])<br></code></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹å‡º<code>input_len</code>æ¯”<code>seq_len</code>å¤šä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ä¸€å¤´ä¸€å°¾ä¸¤ä¸ªtokenã€‚</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><code class="hljs jboss-cli">[08<span class="hljs-function">:23</span><span class="hljs-function">:40</span> AM] INFO     In total 3 datasets:                                  1356482314.py<span class="hljs-function">:35</span><br>                               dev has 270 instances.                                        <br>                               test has 270 instances.                                       <br>                               train has 1350 instances.                                     <br>                       In total 1 vocabs:                                                    <br>                               new_target has 17 entries.                                    <br>                                                                                             <br>              INFO     +<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+- 1356482314.py<span class="hljs-function">:36</span><br>                       <span class="hljs-params">----------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">---------</span>+<span class="hljs-params">---------------</span>                 <br>                       -+                                                                    <br>                       | raw_chars      | target         | input_ids      |                  <br>                       input_len | first          | seq_len | new_target                     <br>                       |                                                                 <br>                       +<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+-                 <br>                       <span class="hljs-params">----------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">---------</span>+<span class="hljs-params">---------------</span>                 <br>                       -+                                                                    <br>                       | [&#x27;ç§‘&#x27;, &#x27;æŠ€&#x27;<span class="hljs-string">...</span> | [&#x27;O&#x27;, &#x27;O&#x27;, <span class="hljs-string">...</span> | [101, 4906,<span class="hljs-string">...</span> |                  <br>                       28        | [0, 1, 2, 3.<span class="hljs-string">..</span> | 26      | [0, 0, 0, 0.<span class="hljs-string">..</span>                 <br>                       |                                                                     <br>                       | [&#x27;å¯¹&#x27;, &#x27;ï¼Œ&#x27;<span class="hljs-string">...</span> | [&#x27;O&#x27;, &#x27;O&#x27;, <span class="hljs-string">...</span> | [101, 2190,<span class="hljs-string">...</span> |                  <br>                       17        | [0, 1, 2, 3.<span class="hljs-string">..</span> | 15      | [0, 0, 0, 0.<span class="hljs-string">..</span>                 <br>                       |                                                                     <br>                       | [&#x27;ä»Š&#x27;, &#x27;å¤©&#x27;<span class="hljs-string">...</span> | [&#x27;O&#x27;, &#x27;O&#x27;, <span class="hljs-string">...</span> | [101, 791, <span class="hljs-string">...</span> |                  <br>                       81        | [0, 1, 2, 3.<span class="hljs-string">..</span> | 79      | [0, 0, 0, 0.<span class="hljs-string">..</span>                 <br>                       |                                                                     <br>                       | [&#x27;ä»Š&#x27;, &#x27;å¹´&#x27;<span class="hljs-string">...</span> | [&#x27;O&#x27;, &#x27;O&#x27;, <span class="hljs-string">...</span> | [101, 791, <span class="hljs-string">...</span> |                  <br>                       20        | [0, 1, 2, 3.<span class="hljs-string">..</span> | 18      | [0, 0, 0, 0.<span class="hljs-string">..</span>                 <br>                       |                                                                     <br>                       +<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">----------------</span>+-                 <br>                       <span class="hljs-params">----------</span>+<span class="hljs-params">----------------</span>+<span class="hljs-params">---------</span>+<span class="hljs-params">---------------</span>                 <br>                       -+ <br></code></pre></td></tr></table></figure>
<h2 id="å°†è®¡ç®—åçš„æ•°æ®æ”¾å…¥dataloader">å°†è®¡ç®—åçš„æ•°æ®æ”¾å…¥dataloader</h2>
<p>åˆ¶ä½œdataloaderæ–¹ä¾¿éå†ï¼Œbså¤§å°256å¤§çº¦å ç”¨20Gæ˜¾å­˜ã€‚</p>
<p><strong>å¯¹è¾“å…¥å’Œè¾“å‡ºåˆ†åˆ«è¿›è¡Œpadding</strong></p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> prepare_torch_dataloader<br><br>dataloaders = prepare_torch_dataloader(data_bundle, batch_size=<span class="hljs-number">256</span>)<br><br><span class="hljs-keyword">for</span> dl <span class="hljs-keyword">in</span> dataloaders.values():<br>    <span class="hljs-comment"># å¯ä»¥é€šè¿‡ set_pad ä¿®æ”¹ padding çš„è¡Œä¸ºã€‚</span><br>    dl.set_pad(<span class="hljs-string">&#x27;input_ids&#x27;</span>, pad_val=tokenizer.pad_token_id)<br>    dl.set_pad(<span class="hljs-string">&#x27;new_target&#x27;</span>, pad_val=-<span class="hljs-number">100</span>)<br></code></pre></td></tr></table></figure>
<h1 id="bertæ¨¡å‹å¾®è°ƒ">Bertæ¨¡å‹å¾®è°ƒ</h1>
<p>Bertæ¨¡å‹çš„æä¾›è€…ä»¬å¾€å¾€æä¾›çš„æ˜¯é¢„è®­ç»ƒæ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨é¢„è®­ç»ƒæ¨¡å‹ä¹‹åæ·»åŠ å…¶ä»–æ¨¡å‹æˆ–å±‚æ¥æ”¹å˜è¾“å‡ºï¼Œè€Œå°†Bertçš„éƒ¨åˆ†å½“ä½œå¯¹æ–‡å­—ç¼–ç çš„éƒ¨åˆ†ä½¿ç”¨ã€‚è¿™é‡Œåæ¥MLPä½œä¸ºNERä»»åŠ¡çš„baselineåšå‚è€ƒï¼Œç„¶ååœ¨Bertåæ·»åŠ BiLSTMå’ŒCRFè¿›è¡Œå¯¹æ¯”ã€‚</p>
<h2 id="è®¾è®¡bertmlpæ¨¡å‹">è®¾è®¡Bert+MLPæ¨¡å‹</h2>
<p>fastNLPçš„æ¨¡å‹åŸºäºtorchï¼Œæ‰€ä»¥å†™æ³•æ˜¯ä¸€æ ·çš„ï¼›åŒæ—¶å†…ç½®çš„transformeråº“ä¹Ÿæ˜¯huggingfaceçš„ç›´æ¥è¿ç§»ï¼Œç”¨æ³•ä¸Šå®Œå…¨ä¸€æ ·ï¼Œåªæ˜¯é»˜è®¤çš„æ¨¡å‹åŠ è½½è·¯å¾„å’Œhuggingfaceçš„transformeråº“ä¸ä¸€æ ·ï¼Œå¦‚æœåŒæ—¶ä½¿ç”¨å¯èƒ½ä¼šå‘ç°ç¼“å­˜ä½ç½®ä¸åŒè€Œé‡å¤ä¸‹è½½ã€‚</p>
<ul>
<li>è¿™é‡Œä½¿ç”¨<code>hfl/rbt3</code>è¿™ä¸ªä¸­æ–‡Bertæ¨¡å‹ï¼Œå¤§å°çº¦500Mï¼Œ<code>BertModel.from_pretrained()</code>å‡½æ•°ä¼šä»è¿œç¨‹æ‹‰å–è¯¥æ¨¡å‹ä¿å­˜åœ¨ç¼“å­˜ååŠ è½½ï¼ˆå¤æ—¦æºï¼Œå›½å†…å¾ˆå¿«ï¼‰ã€‚</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertModel<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> seq_len_to_mask<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BertNER</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name, num_class</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.bert = BertModel.from_pretrained(model_name)<br>        self.mlp = nn.Sequential(nn.Linear(self.bert.config.hidden_size, self.bert.config.hidden_size),<br>                                nn.Dropout(<span class="hljs-number">0.3</span>),<br>                                nn.Linear(self.bert.config.hidden_size, num_class))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, input_ids, input_len, first</span>):<br>        attention_mask = seq_len_to_mask(input_len)<br>        outputs = self.bert(input_ids=input_ids, attention_mask=attention_mask)<br>        last_hidden_state = outputs.last_hidden_state<br>        first = first.unsqueeze(-<span class="hljs-number">1</span>).repeat(<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, last_hidden_state.size(-<span class="hljs-number">1</span>))<br>        first_bpe_state = last_hidden_state.gather(dim=<span class="hljs-number">1</span>, index=first)<br>        first_bpe_state = first_bpe_state[:, <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]  <span class="hljs-comment"># åˆ é™¤ cls å’Œ sep</span><br><br>        pred = self.mlp(first_bpe_state)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;pred&#x27;</span>: pred&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train_step</span>(<span class="hljs-params">self, input_ids, input_len, first, target</span>):<br>        pred = self(input_ids, input_len, first)[<span class="hljs-string">&#x27;pred&#x27;</span>]<br>        loss = F.cross_entropy(pred.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>), target)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;loss&#x27;</span>: loss&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_step</span>(<span class="hljs-params">self, input_ids, input_len, first</span>):<br>        pred = self(input_ids, input_len, first)[<span class="hljs-string">&#x27;pred&#x27;</span>].argmax(dim=-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;pred&#x27;</span>: pred&#125;<br>    <br>model = BertNER(<span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>, <span class="hljs-built_in">len</span>(data_bundle.get_vocab(<span class="hljs-string">&#x27;new_target&#x27;</span>)))<br></code></pre></td></tr></table></figure>
<p><code>forward</code>å‡½æ•°å’Œtorchå†™æ³•ç›¸åŒï¼Œ<code>train_step</code>ä¼šè¢«åé¢å£°æ˜çš„trainerå¯¹è±¡è°ƒç”¨ï¼Œè®¡ç®—è®­ç»ƒçš„æ¯ä¸€æ­¥lossï¼Œ<code>evaluate_step</code>ä¼šè¢«åé¢å£°æ˜çš„evaluatorå¯¹è±¡è°ƒç”¨ï¼Œç›¸å½“äºé¢„æµ‹å‡½æ•°ï¼Œè¿”å›çš„æ˜¯é¢„æµ‹æ ‡ç­¾å¯¹åº”çš„æ•°å­—indexã€‚</p>
<h2 id="è®¾è®¡bertbilstmcrfæ¨¡å‹">è®¾è®¡Bert+BiLSTM+CRFæ¨¡å‹</h2>
<p>è¿™é‡Œéœ€è¦è€ƒè™‘çš„æ˜¯ä¸‰ä¸ªæ¨¡å‹ä¹‹é—´çš„è¾“å…¥è¾“å‡ºè¦åŒ¹é…ï¼Œå»æ‰äº†bpeç®—æ³•éƒ¨åˆ†æ–¹ä¾¿å°†bertç»“æœè¾“å…¥LSTMï¼Œå¦å¤–åœ¨CRFæ¨¡å‹çš„è¾“å…¥ä¸­maskå¤§å°ä¸æ˜¯Bertè¾“å…¥çš„å¸¦æœ‰å‰åæ ‡è®°çš„attention
maskï¼Œè€Œæ˜¯æœ€ç®€å•çš„é•¿åº¦maskï¼Œæ‰€ä»¥é‡æ–°åˆ¶ä½œäº†maskè¾“å…¥crfä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">from</span> fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertModel<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> seq_len_to_mask<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><span class="hljs-keyword">from</span> fastNLP.modules.torch <span class="hljs-keyword">import</span> ConditionalRandomField<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BertBilstmCrfNER</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, model_name,num_class, embedding_dim = <span class="hljs-number">768</span>,hidden_size=<span class="hljs-number">512</span>,dropout=<span class="hljs-number">0.5</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.bert = BertModel.from_pretrained(model_name)<br>        <br>        self.lstm = nn.LSTM(<br>            input_size=embedding_dim,<br>            num_layers=<span class="hljs-number">2</span>,<br>            hidden_size=hidden_size,<br>            bidirectional=<span class="hljs-literal">True</span>,<br>            batch_first=<span class="hljs-literal">True</span>)<br>        self.dropout = nn.Dropout(dropout)<br>        self.fc = nn.Linear(hidden_size * <span class="hljs-number">2</span>, num_class)<br>        self.crf = ConditionalRandomField(num_class)<br>        <br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, input_ids, input_len,target=<span class="hljs-literal">None</span></span>):<br>        attention_mask = seq_len_to_mask(input_len)<br>        <span class="hljs-keyword">with</span> torch.no_grad():<br>            outputs = self.bert(input_ids=input_ids, attention_mask=attention_mask)<br>        last_hidden_state = outputs.last_hidden_state<br><br>        first_bpe_state = last_hidden_state[:, <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]<br>        feats, _ = self.lstm(first_bpe_state) <span class="hljs-comment"># è¾“å…¥lstm</span><br>        feats = self.fc(feats)<br>        feats = self.dropout(feats)<br>        logits = F.log_softmax(feats, dim=-<span class="hljs-number">1</span>)<br>        <br>        mask = seq_len_to_mask(input_len-<span class="hljs-number">2</span>)<br>        <br>        <span class="hljs-keyword">if</span> target <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            pred, _ = self.crf.viterbi_decode(logits, mask)<br>            <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;pred&#x27;</span>: pred&#125;<br>        <span class="hljs-keyword">else</span>:<br>            loss = self.crf(logits, target, mask).mean()<br>            <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;loss&#x27;</span>: loss&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train_step</span>(<span class="hljs-params">self, input_ids, input_len, target</span>):<br>        <span class="hljs-comment"># &#123;&#x27;loss&#x27;:loss&#125;</span><br>        <span class="hljs-keyword">return</span> self(input_ids, input_len,target)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_step</span>(<span class="hljs-params">self, input_ids, input_len</span>):<br>        <span class="hljs-comment">#  &#123;&#x27;pred&#x27;: pred&#125;</span><br>        <span class="hljs-keyword">return</span> self(input_ids, input_len)<br><br>model = BertBilstmCrfNER(<span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>, <span class="hljs-built_in">len</span>(data_bundle.get_vocab(<span class="hljs-string">&#x27;new_target&#x27;</span>)))<br></code></pre></td></tr></table></figure>
<h2 id="å¼€å§‹è®­ç»ƒ">å¼€å§‹è®­ç»ƒ</h2>
<p>è¿™é‡Œæˆ‘ä»¬å‡†å¤‡Trainerå¯¹è±¡çš„å„ä¸ªå‚æ•°ï¼Œå…·ä½“ç»†èŠ‚ä¸åšæ·±å…¥è§£é‡Šï¼Œçœ‹åå­—å¾ˆå¥½ç†è§£ã€‚</p>
<p><strong>å…¶ä¸­Trainerå¯¹è±¡é»˜è®¤è°ƒç”¨æ•°æ®çš„æ ‡ç­¾çš„è¡¨å¤´æ˜¯targetï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è¿™ä¸ªå‡½æ•°å°†æˆ‘ä»¬è‡ªå·±è®¾è®¡çš„new_targetåˆ—è°ƒæ•´ã€‚</strong>å¦‚æœä½ å’Œæˆ‘ä¸€æ ·æ˜¯æŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„å†™æ³•ï¼Œç›´æ¥è°ƒç”¨å®˜æ–¹loaderåŠ è½½ï¼Œåœ¨è¿™é‡Œå°±éœ€è¦è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºåœ¨æ–‡æ¡£é‡Œçš„ipythonç»“æœæ˜¯ä»æ–‡ä»¶è¯»å–çš„ï¼Œåˆ—åç§°å’ŒloaderåŠ è½½çš„ä¸åŒã€‚</p>
<p>å®é™…è®­ç»ƒä¸­CRFæ¨¡å‹è®­ç»ƒéœ€è¦è°ƒå¤§å­¦ä¹ ç‡ï¼Œå¦åˆ™è½¬ç§»çŸ©é˜µçš„å­¦ä¹ ç»“æœä¼šå¾ˆå·®ï¼Œå®é™…ä½¿ç”¨çš„lrä¸º2e-2ï¼Œæ˜¯mlpæ¨¡å‹çš„ä¸€åƒå€ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> optim<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> Trainer, LoadBestModelCallback, TorchWarmupCallback<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> SpanFPreRecMetric<br><br>optimizer = optim.Adam(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<br>callbacks = [<br>    LoadBestModelCallback(),<br>    TorchWarmupCallback(),<br>]<br>metrics = &#123;<br>    <span class="hljs-string">&quot;f&quot;</span>: SpanFPreRecMetric(tag_vocab=data_bundle.get_vocab(<span class="hljs-string">&#x27;new_target&#x27;</span>)),<br>&#125;<br><br><span class="hljs-comment"># â€”â€”â€”â€”é‡è¦å‡½æ•°----Trainerå¯¹è±¡é»˜è®¤è°ƒç”¨æ•°æ®çš„æ ‡ç­¾çš„è¡¨å¤´æ˜¯targetï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦è¿™ä¸ªå‡½æ•°å°†æˆ‘ä»¬è‡ªå·±è®¾è®¡çš„new_targetåˆ—è°ƒæ•´</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">input_mapping</span>(<span class="hljs-params">data</span>):<br>    data[<span class="hljs-string">&#x27;target&#x27;</span>] = data[<span class="hljs-string">&#x27;new_target&#x27;</span>]<br>    <span class="hljs-keyword">return</span> data<br><br>trainer = Trainer(model=model, train_dataloader=dataloaders[<span class="hljs-string">&#x27;train&#x27;</span>], optimizers=optimizer,<br>                  evaluate_dataloaders=dataloaders[<span class="hljs-string">&#x27;dev&#x27;</span>],<br>                  metrics=metrics, n_epochs=<span class="hljs-number">50</span>, callbacks=callbacks,<br>                  monitor=<span class="hljs-string">&#x27;f#f&#x27;</span>,device=<span class="hljs-string">&#x27;cuda&#x27;</span>,driver=<span class="hljs-string">&quot;torch&quot;</span>,input_mapping=input_mapping)<br>trainer.run()<br></code></pre></td></tr></table></figure>
<ul>
<li>Bert+MLPæ¨¡å‹ï¼š50è½®è·‘å®Œç»“æœå¦‚ä¸‹ï¼Œè‡ªåŠ¨å°†æœ€ä½³æ¨¡å‹åŠ è½½åˆ°modelå¯¹è±¡ï¼Œè¿™é‡Œåœ¨éªŒè¯é›†ä¸Šçš„F1å€¼æœ‰0.573477ï¼Œä¸ç®—å¾ˆé«˜ï¼Œå› ä¸ºBertç›´æ¥å¾®è°ƒæ•ˆæœæœ‰é™ï¼Œä½†æ˜¯é¢„æµ‹ç»“æœæœ‰ä¸€å®šçš„å‚è€ƒä»·å€¼äº†ã€‚</li>
</ul>
<figure class="highlight smali"><table><tr><td class="code"><pre><code class="hljs smali">[11:36:55 AM] INFO     The best performance for<span class="hljs-built_in"> monitor </span>f<span class="hljs-comment">#f:0.573477  progress_callback.py:37</span><br>                       was achieved in Epoch:47, Global Batch:282.                           <br>                       The evaluation result:                                                <br>                       &#123;&#x27;f<span class="hljs-comment">#f&#x27;: 0.573477, &#x27;pre#f&#x27;: 0.535714, &#x27;rec#f&#x27;:                         </span><br>                       0.616967&#125;                                                             <br>              INFO     Loading best model from buffer with    load_best_model_callback.py:120<br>                       f<span class="hljs-comment">#f: 0.573477 (achieved in Epoch: 47,                                 </span><br>                       Global Batch: 282) ... <br></code></pre></td></tr></table></figure>
<ul>
<li><p>Bert+BiLSTM+CRFæ¨¡å‹ï¼šF1å€¼æœ‰0.705416ï¼Œæå‡æ˜æ˜¾ã€‚</p>
<figure>
<img src="/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/ä¸‰æ®µæ¨¡å‹ç»“æœ.png" alt="Bert+BiLSTM+CRFæ¨¡å‹ç»“æœ">
<figcaption aria-hidden="true">Bert+BiLSTM+CRFæ¨¡å‹ç»“æœ</figcaption>
</figure></li>
</ul>
<h2 id="æ¨¡å‹ä¿å­˜å’ŒåŠ è½½">æ¨¡å‹ä¿å­˜å’ŒåŠ è½½</h2>
<p>è®­ç»ƒå¥½æ¨¡å‹ä¹‹åéœ€è¦è¿›è¡Œä¿å­˜ï¼Œè¿™é‡Œä½¿ç”¨torchçš„ä¿å­˜ï¼ŒfastNLPä¹Ÿæœ‰è‡ªå·±çš„ä¿å­˜æ–¹æ³•ï¼Œæ˜¯ç›¸åŒçš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> os<br>torch.save(model,<span class="hljs-string">&#x27;rbt3-mlp-ner.pth&#x27;</span>)<br>ner_model = torch.load(<span class="hljs-string">&#x27;rbt3-mlp-ner.pth&#x27;</span>)<br></code></pre></td></tr></table></figure>
<h1 id="ä½¿ç”¨æ¨¡å‹é¢„æµ‹">ä½¿ç”¨æ¨¡å‹é¢„æµ‹</h1>
<p>ç”±äºåç»­éœ€è¦éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šè¿›è¡Œä½¿ç”¨ï¼Œè¿™é‡Œéœ€è¦æ„å»ºå¥½æ•´ä¸ªé¢„æµ‹æµç¨‹ï¼ŒfastNLPå·¥å…·åŒ…æœ¬èº«æ²¡æœ‰è¿™ä¸ªåŠŸèƒ½ï¼Œåªæ˜¯ç”¨æ¥å¿«é€Ÿæ„å»ºæ¨¡å‹éªŒè¯ï¼Œä½†æ˜¯é¢„æµ‹æµç¨‹æœ¬èº«ä¸è®­ç»ƒæµç¨‹ç›¸åŒï¼Œå¹¶ä¸å¤æ‚ã€‚</p>
<ul>
<li>å°†é¢„æµ‹æ–‡æœ¬æ”¾å…¥datasetï¼Œå†æ”¾å…¥databundleï¼Œç»è¿‡bpeè®¡ç®—ï¼Œ</li>
<li>æ”¾å…¥dataloaderï¼Œäº¤ç»™evaluatorè°ƒç”¨é¢„æµ‹å‡½æ•°å¾—åˆ°é¢„æµ‹ç»“æœã€‚</li>
</ul>
<h2 id="æ„å»ºdataset">æ„å»ºdataset</h2>
<p>å…¶å®æ˜¯æ„å»ºä¸€ä¸ªåªæœ‰ä¸€æ¡æ•°æ®çš„çš„datasetå†æ”¾å…¥databundleå¯¹è±¡ä¸­ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP.io <span class="hljs-keyword">import</span> DataBundle<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> DataSet, Instance<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">text2dataset</span>(<span class="hljs-params">text:<span class="hljs-built_in">str</span></span>):<br>    ds = DataSet()<br>    <span class="hljs-keyword">if</span> text != <span class="hljs-string">&#x27;&#x27;</span>:  <br>        ds.append(Instance(raw_words = <span class="hljs-built_in">list</span>(text)))<br>    <span class="hljs-keyword">return</span> ds<br><br>text = <span class="hljs-string">&#x27;æˆ‘ä»Šå¤©å°±è¦åœ¨ä¸­å›½ä¼ åª’å¤§å­¦åƒä¸Šå´”æ°¸å…ƒçœŸé¢ï¼&#x27;</span><br><br>predict_data_bundle = DataBundle(datasets=&#123;<br>    <span class="hljs-string">&quot;predict&quot;</span>: text2dataset(text),<br>&#125;)<br><span class="hljs-built_in">print</span>(predict_data_bundle)<br><span class="hljs-built_in">print</span>(predict_data_bundle.get_dataset(<span class="hljs-string">&quot;predict&quot;</span>))<br></code></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼Œè¿™é‡ŒInstanceå¯¹è±¡èµ‹ç»™è¾“å…¥çš„åˆ—åæ˜¯<code>raw_words</code>ï¼Œå’Œå‰é¢é»˜è®¤loaderåŠ è½½æ˜¯ä¸åŒçš„ã€‚</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><code class="hljs ada"><span class="hljs-comment">--------------------------+| raw_words|+---------------------------------------+                                           </span><br>| [<span class="hljs-string">&#x27;æˆ‘&#x27;</span>, <span class="hljs-string">&#x27;ä»Š&#x27;</span>, <span class="hljs-string">&#x27;å¤©&#x27;</span>, <span class="hljs-string">&#x27;å°±&#x27;</span>, <span class="hljs-string">&#x27;è¦&#x27;</span>, <span class="hljs-string">&#x27;åœ¨&#x27;</span>, <span class="hljs-string">&#x27;ä¸­&#x27;</span>, <span class="hljs-string">&#x27;å›½&#x27;</span>, <span class="hljs-string">&#x27;ä¼ &#x27;</span>, <span class="hljs-string">&#x27;åª’&#x27;</span>, <span class="hljs-string">&#x27;å¤§&#x27;</span>, <span class="hljs-string">&#x27;å­¦&#x27;</span>, ... |                                         <br>+<span class="hljs-comment">------------------------------------------------------------------------------+ </span><br></code></pre></td></tr></table></figure>
<h2 id="æ„å»ºdataloader">æ„å»ºdataloader</h2>
<p>å…¶å®å°±æ˜¯æŠŠå‰é¢çš„å‡½æ•°æ”¹ä¸€æ”¹ï¼Œç”šè‡³å¯ä»¥å°†å‰é¢çš„å‡½æ•°åŠ å‚æ•°é‡æ„ï¼Œé‡å¤ä½¿ç”¨ã€‚<strong>éœ€è¦æ³¨æ„çš„æ˜¯loaderçš„åˆ—åä¸ä¸€æ ·</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertTokenizer<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> cache_results, Vocabulary<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">process_predict_data</span>(<span class="hljs-params">data_bundle, model_name</span>):<br><br>    tokenizer = BertTokenizer.from_pretrained(model_name)<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">bpe</span>(<span class="hljs-params">raw_words</span>):<br>        bpes = [tokenizer.cls_token_id]<br>        first = [<span class="hljs-number">0</span>]<br>        first_index = <span class="hljs-number">1</span>  <span class="hljs-comment"># è®°å½•ç¬¬ä¸€ä¸ªbpeçš„ä½ç½®</span><br>        <span class="hljs-keyword">for</span> word <span class="hljs-keyword">in</span> raw_words:<br>            bpe = tokenizer.encode(word, add_special_tokens=<span class="hljs-literal">False</span>)<br>            bpes.extend(bpe)<br>            first.append(first_index)<br>            first_index += <span class="hljs-built_in">len</span>(bpe)<br>        bpes.append(tokenizer.sep_token_id)<br>        first.append(first_index)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;input_ids&#x27;</span>: bpes, <span class="hljs-string">&#x27;input_len&#x27;</span>: <span class="hljs-built_in">len</span>(bpes), <span class="hljs-string">&#x27;first&#x27;</span>: first, <span class="hljs-string">&#x27;seq_len&#x27;</span>: <span class="hljs-built_in">len</span>(raw_words)&#125;<br>    <span class="hljs-comment"># å¯¹data_bundleä¸­æ¯ä¸ªdatasetçš„æ¯ä¸€æ¡æ•°æ®ä¸­çš„raw_wordsä½¿ç”¨bpeå‡½æ•°ï¼Œå¹¶ä¸”å°†è¿”å›çš„ç»“æœåŠ å…¥åˆ°æ¯æ¡æ•°æ®ä¸­ã€‚</span><br>    data_bundle.apply_field_more(bpe, field_name=<span class="hljs-string">&#x27;raw_words&#x27;</span>, num_proc=<span class="hljs-number">1</span>)<br><br>    <span class="hljs-keyword">return</span> data_bundle, tokenizer<br><br>predict_data_bundle, predict_tokenizer = process_predict_data(predict_data_bundle, <span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>)<br><br><span class="hljs-built_in">print</span>(predict_data_bundle)<br><span class="hljs-built_in">print</span>(predict_data_bundle.get_dataset(<span class="hljs-string">&quot;predict&quot;</span>))<br><br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> prepare_torch_dataloader<br><br>predict_dataloaders = prepare_torch_dataloader(predict_data_bundle, batch_size=<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>ç»“æœå¦‚ä¸‹ï¼Œå’Œå‰é¢çš„loaderç›¸æ¯”åªæ˜¯å°‘äº†targetä¸€åˆ—ï¼Œä¸è¿‡å› ä¸ºæ˜¯åšé¢„æµ‹æœ¬èº«ä¹Ÿç”¨ä¸åˆ°ã€‚</p>
<figure class="highlight jboss-cli"><table><tr><td class="code"><pre><code class="hljs jboss-cli">+<span class="hljs-params">---------------------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">-----------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">---------</span>+<br>| raw_words | input_ids | input_len | first | seq_len |<br>+<span class="hljs-params">---------------------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">-----------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">---------</span>+<br>| [&#x27;æˆ‘&#x27;, &#x27;ä»Š&#x27;, &#x27;å¤©<span class="hljs-string">...</span> | [101, 2769, 791.<span class="hljs-string">..</span> | 22 | [0, 1, 2, 3, 4,<span class="hljs-string">...</span> | 20 |                                      <br>+<span class="hljs-params">---------------------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">-----------</span>+<span class="hljs-params">--------------------</span>+<span class="hljs-params">---------</span>+ <br></code></pre></td></tr></table></figure>
<h2 id="è¿›è¡Œé¢„æµ‹">è¿›è¡Œé¢„æµ‹</h2>
<h3 id="ç¬¬ä¸€ç§æ–¹æ³•evaluatorå¯¹è±¡è¿›è¡Œé¢„æµ‹">ç¬¬ä¸€ç§æ–¹æ³•ï¼šEvaluatorå¯¹è±¡è¿›è¡Œé¢„æµ‹</h3>
<p>é€šå¸¸çš„é¢„æµ‹æ–¹æ³•æ˜¯æ„å»ºä¸€ä¸ªevaluatorå¯¹è±¡ç”¨äºè°ƒç”¨æ¨¡å‹çš„é¢„æµ‹å‡½æ•°ï¼Œ<strong>è¿™é‡Œéœ€è¦åŠ è½½æ•°æ®é›†ä¸­çš„vocabç”¨äºè¿›è¡Œidx2word</strong>ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">predict_output_labeling</span>(<span class="hljs-params">evaluator, batch</span>):<br>    outputs = evaluator.evaluate_step(batch)[<span class="hljs-string">&quot;pred&quot;</span>]<br>    raw_words = batch[<span class="hljs-string">&quot;raw_words&quot;</span>]<br>    <span class="hljs-keyword">for</span> words, output <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(raw_words, outputs):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;sentence:&quot;</span>, words)<br>        labels = [data_bundle.get_vocab(<span class="hljs-string">&quot;new_target&quot;</span>).idx2word[idx] <span class="hljs-keyword">for</span> idx <span class="hljs-keyword">in</span> output[:<span class="hljs-built_in">len</span>(words)].tolist() ]<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;labels:&quot;</span>, labels)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;outputs:&#x27;</span>,outputs)<br>predictor = Evaluator(model=ner_model, dataloaders=predict_dataloaders[<span class="hljs-string">&quot;predict&quot;</span>],<br>                      device=<span class="hljs-number">0</span>, evaluate_batch_step_fn=predict_output_labeling)<br>predictor.run(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>é¢„æµ‹ç»“æœå¦‚ä¸‹ï¼š</p>
<figure>
<img src="/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/é¢„æµ‹ç»“æœ.png" alt="é¢„æµ‹ç»“æœ">
<figcaption aria-hidden="true">é¢„æµ‹ç»“æœ</figcaption>
</figure>
<p>è¿™ç§æ–¹æ³•æŸ¥çœ‹é¢„æµ‹ç»“æœæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯evaluatoræ²¡æœ‰è®¾ç½®è¿”å›çš„å‚æ•°ï¼Œæˆ‘ä»¬æ— æ³•ä¿å­˜é¢„æµ‹çš„ç»“æœç”¨äºåé¢éƒ¨ç½²å¯è§†åŒ–å±•ç¤ºã€‚</p>
<h3 id="ç¬¬äºŒç§æ–¹æ³•æ‰‹åŠ¨è°ƒç”¨æ¨¡å‹ä¸­çš„evaluate_stepæ–¹æ³•">ç¬¬äºŒç§æ–¹æ³•ï¼šæ‰‹åŠ¨è°ƒç”¨æ¨¡å‹ä¸­çš„<code>evaluate_step</code>æ–¹æ³•</h3>
<p>è€ƒè™‘åˆ°æˆ‘ä»¬éƒ¨ç½²çš„éœ€æ±‚ï¼Œéœ€è¦æå‰å°†labelå’Œidxçš„å¯¹åº”å…³ç³»æå–å‡ºæ¥ï¼Œåœ¨é¢„æµ‹åå¾—åˆ°outputsåˆ—è¡¨åç¿»è¯‘æˆlabelã€‚ä¸‹é¢æ˜¯ä¸€äº›å·¥å…·å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">label_idx_list = <span class="hljs-built_in">list</span>(data_bundle.get_vocab(<span class="hljs-string">&quot;new_target&quot;</span>))<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">write_list_into_text</span>(<span class="hljs-params">path,label_idx_list</span>):<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        <span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> label_idx_list:<br>            f.writelines(<span class="hljs-built_in">str</span>(pair[<span class="hljs-number">0</span>])+<span class="hljs-string">&#x27;,&#x27;</span>+<span class="hljs-built_in">str</span>(pair[<span class="hljs-number">1</span>]))<br>            f.write(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;write over!&#x27;</span>)<br>        <br><span class="hljs-keyword">def</span> <span class="hljs-title function_">read_list_from_text</span>(<span class="hljs-params">path</span>):<br>    final_list = []<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(path,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        lines = f.readlines()<br>        <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> lines:<br>            line = line.strip().split(<span class="hljs-string">&#x27;,&#x27;</span>)<br>            final_list.append((line[<span class="hljs-number">0</span>],<span class="hljs-built_in">int</span>(line[<span class="hljs-number">1</span>])))<br>    <span class="hljs-keyword">return</span> final_list<br>    <br>write_list_into_text(<span class="hljs-string">&#x27;label_idx_list.txt&#x27;</span>,label_idx_list)<br>label_idx_list = read_list_from_text(<span class="hljs-string">&#x27;label_idx_list.txt&#x27;</span>)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">idx2label</span>(<span class="hljs-params">label_idx_list:<span class="hljs-built_in">list</span>,idx:<span class="hljs-built_in">int</span></span>):<br>    <span class="hljs-comment"># [(&#x27;O&#x27;,0),(label,idx)...]</span><br>    <span class="hljs-comment"># ç”¨äºidxå’Œlabelè½¬æ¢</span><br>    <span class="hljs-comment"># return label</span><br>    label = <span class="hljs-literal">None</span><br>    <span class="hljs-keyword">for</span> pair <span class="hljs-keyword">in</span> label_idx_list:<br>        <span class="hljs-keyword">if</span> pair[<span class="hljs-number">1</span>] == idx:<br>             label = pair[<span class="hljs-number">0</span>]<br>    <span class="hljs-keyword">return</span> label<br></code></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥å¾ˆç®€å•ï¼Œå°†åˆ¶ä½œå¥½çš„è¾“å…¥æ•°æ®æ•´ç†æˆtensorï¼Œè°ƒç”¨æ¨¡å‹çš„<code>evaluate_step</code>æ–¹æ³•è¿›è¡Œé¢„æµ‹ã€‚</p>
<blockquote>
<p>âš ï¸è¿™é‡Œç”±äºæ‰‹åŠ¨è°ƒç”¨æ¨¡å‹ï¼Œä¸€å®šè®°å¾—ä½¿ç”¨evalå‡½æ•°å°†æ¨¡å‹è®¾ç½®ä¸ºè¯„ä¼°æ¨¡å¼ï¼Œå…³é—­dropoutçš„å½±å“ã€‚</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python">dev = <span class="hljs-built_in">next</span>(ner_model.parameters()).device<br>ner_model.<span class="hljs-built_in">eval</span>()<br><br><span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> predict_dataloaders[<span class="hljs-string">&#x27;predict&#x27;</span>]:<br>    input_ids = torch.LongTensor(data[<span class="hljs-string">&#x27;input_ids&#x27;</span>]).to(dev)<br>    input_len = torch.LongTensor(data[<span class="hljs-string">&#x27;input_len&#x27;</span>]).to(dev)<br>    first =     torch.LongTensor(data[<span class="hljs-string">&#x27;first&#x27;</span>]).to(dev)<br><br>    result = ner_model.evaluate_step(input_ids,input_len,first)[<span class="hljs-string">&#x27;pred&#x27;</span>]<br></code></pre></td></tr></table></figure>
<p>é¢„æµ‹ç»“æœå¦‚ä¸‹ï¼š</p>
<figure>
<img src="/2023/03/18/shi-yong-bert-jin-xing-ner-ming-ming-shi-ti-shi-bie-feat-fastnlp/æ‰‹åŠ¨é¢„æµ‹ç»“æœ.png" alt="æ‰‹åŠ¨é¢„æµ‹çš„ç»“æœ">
<figcaption aria-hidden="true">æ‰‹åŠ¨é¢„æµ‹çš„ç»“æœ</figcaption>
</figure>
<h2 id="å‡†å¤‡éƒ¨ç½²">å‡†å¤‡éƒ¨ç½²</h2>
<p>å°†æ¨¡å‹å’Œtxtæ–‡ä»¶ä¿å­˜å¥½ï¼Œåˆ°æ­¤ä¸ºæ­¢æ¨¡å‹çš„æ–¹é¢æå®šäº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç”¨flaskæ­å»ºç½‘é¡µæœåŠ¡å™¨çš„å†…å®¹ï¼Œå†…å®¹å¤ªé•¿ï¼Œä¸‹ä¸€ç¯‡ç»§ç»­ï½</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Bert</tag>
        <tag>NLP</tag>
        <tag>NER</tag>
      </tags>
  </entry>
  <entry>
    <title>å¾®è°ƒBertæ¨¡å‹å®Œæˆæ–‡æœ¬åˆ†ç±»feat.fastNLP</title>
    <url>/2023/03/31/wei-diao-bert-mo-xing-wan-cheng-wen-ben-fen-lei-feat-fastnlp/</url>
    <content><![CDATA[<h1 id="fine-tuned-bert-for-textclassification">Fine-tuned Bert for
TextClassification</h1>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>æ–‡æœ¬åˆ†ç±»ä¹Ÿæ˜¯NLPé¢†åŸŸçš„ä¼ ç»Ÿä»»åŠ¡ï¼Œåœ¨Bertæ¨¡å‹çš„åŠ æŒä¸‹å¯ä»¥è½»æ¾è¾¾åˆ°è¾ƒé«˜çš„å‡†ç¡®ç‡ï¼Œç›¸æ¯”ä¹‹å‰çš„NERä»»åŠ¡ä»æ•°æ®åˆ°æ¨¡å‹ä¸Šéƒ½è¦ç®€å•ã€‚</p>
<p>å¦‚æœç›´æ¥æ‰‹å†™è®­ç»ƒå‡½æ•°ï¼Œå¯ä»¥åœ¨æ¨¡å‹ä¸Šè°ƒç”¨huggingfaceçš„<code>BertForSequenceClassification</code>ç±»ï¼Œå®ƒæ˜¯åœ¨<code>BertModel</code>çš„åé¢æ¥ä¸Šdropoutå’Œä¸€å±‚åˆ†ç±»å¤´ï¼Œç›´æ¥è¾“å‡ºlosså’Œlogitsï¼Œå…¶ä»–è¾“å‡ºè¯¦æƒ…åœ¨huggingface<a href="https://huggingface.co/docs/transformers/main/en/model_doc/bert#transformers.BertForSequenceClassification">å®˜æ–¹æ–‡æ¡£</a>ã€‚è¿™é‡Œä½¿ç”¨fastNLPæ¡†æ¶ï¼Œå‡å»äº†æ‰‹å†™è®­ç»ƒå‡½æ•°å’ŒéªŒè¯å‡½æ•°çš„æ­¥éª¤ï¼Œå°±éœ€è¦å°†æ¨¡å‹å•ç‹¬å®ç°ï¼Œæ€è·¯å’Œå‰é¢ä¸€æ ·ï¼Œä½†éœ€è¦å˜æ¢ä¸‹BertModelçš„è¾“å‡ºã€‚</p>
<h2 id="å¤–å–æ•°æ®é¢„å¤„ç†">å¤–å–æ•°æ®é¢„å¤„ç†</h2>
<p>è¿™æ¬¡çš„æ•°æ®é›†ä½¿ç”¨çš„æ˜¯å¤–å–å¹³å°çš„è¯„è®ºæ•°æ®é›†ï¼Œä¸¤ä¸ªç±»åˆ«è¡¨ç¤ºæ­£å‘è¯„è®ºå’Œè´Ÿå‘è¯„è®ºï¼Œæ•°æ®é›†æŒ‰ç…§
<strong>è®­ç»ƒ:éªŒè¯:æµ‹è¯•=7:1.5:1.5</strong>åˆ‡åˆ†ï¼Œæ€»æ•°æ®é‡çº¦11800æ¡ã€‚</p>
<p>éœ€è¦ç”¨åˆ°tokenizerï¼Œæ‰€ä»¥åœ¨ä¸€å¼€å§‹å°±å¯¼å…¥Bertæ¨¡å‹åŠ è½½BertTokenizerï¼ŒBertModelã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span>  fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertTokenizer<br><span class="hljs-keyword">from</span> fastNLP.transformers.torch <span class="hljs-keyword">import</span> BertModel<br><br>tokenizer = BertTokenizer.from_pretrained(<span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>)<br>bert_model = BertModel.from_pretrained(<span class="hljs-string">&#x27;hfl/rbt3&#x27;</span>)<br></code></pre></td></tr></table></figure>
<p>é¢„å¤„ç†æ¯”è¾ƒç®€å•ï¼Œæ•°æ®é›†ç»è¿‡æ¸…æ´—ï¼Œç›´æ¥äº¤ç»™tokenizeråšä¸‹encodeï¼Œå¾—åˆ°<code>input_ids</code>ã€‚</p>
<figure>
<img src="/2023/03/31/wei-diao-bert-mo-xing-wan-cheng-wen-ben-fen-lei-feat-fastnlp/dataset.png" alt="æ•°æ®é›†">
<figcaption aria-hidden="true">æ•°æ®é›†</figcaption>
</figure>
<p>ç„¶åæ”¾è¿›databundleï¼ŒæŒ‡å®švocabï¼ˆå…¶å®åªæœ‰ä¸¤ä¸ªç±»ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨åšvocabï¼‰ï¼Œæ”¾å…¥dataloaderåšä¸‹paddingï¼Œè¿™æ˜¯fastNLPçš„æ•°æ®å¤„ç†å®šç•ªäº†ï¼Œæ¯”ä¹‹å‰NERçš„è¿˜æ˜¯ç®€å•äº†ä¸å°‘ã€‚</p>
<h2 id="æ¨¡å‹æ­å»º">æ¨¡å‹æ­å»º</h2>
<p>è¿™é‡Œæ­å»ºçš„æ¨¡å‹è·Ÿå‰è¨€æåˆ°çš„ä¸€æ ·ï¼Œå°±æ˜¯åœ¨Bertçš„è¾“å‡ºååŠ ä¸Šå…¨è¿æ¥åšåˆ†ç±»å¤´ã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> torch<br><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> nn<br><span class="hljs-keyword">import</span> torch.nn.functional <span class="hljs-keyword">as</span> F<br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">BertClassifier</span>(nn.Module):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self,bert_model,num_class</span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.bert = bert_model<br>        self.mlp = nn.Sequential(nn.Linear(self.bert.config.hidden_size, self.bert.config.hidden_size),<br>                                nn.Dropout(<span class="hljs-number">0.5</span>),<br>                                nn.Linear(self.bert.config.hidden_size, num_class))<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, input_ids</span>):<br>      	<span class="hljs-comment"># å†»ç»“bertå‚æ•°</span><br>        <span class="hljs-keyword">with</span> torch.no_grad():<br>            outputs = self.bert(input_ids=input_ids)<br>        last_hidden_state = outputs.last_hidden_state <span class="hljs-comment"># last_hidden_stateçš„shapeä¸º[batch,seq_len,num_class]</span><br>        last_hidden_state = last_hidden_state[:, <span class="hljs-number">1</span>:-<span class="hljs-number">1</span>]  <span class="hljs-comment"># åˆ é™¤ cls å’Œ sep</span><br><br>        last_hidden_state = last_hidden_state.mean(dim=<span class="hljs-number">1</span>) <span class="hljs-comment"># ç¬¬ä¸€ç§å†™æ³•ï¼šè¿™é‡Œå»æ‰ä¸­é—´ä¸€ç»´ï¼Œä¸éœ€è¦seq_lenï¼Œåœ¨seq_lenç»´åº¦æ±‚å‡å€¼ï¼Œæ•°æ®è¿›å…¥num_class</span><br>        <span class="hljs-comment"># last_hidden_state = outputs.pooler_output # ç¬¬äºŒç§å†™æ³•ï¼špooler_outputä¹Ÿæ˜¯outputsä¸­çš„è¾“å‡º</span><br>        pred = self.mlp(last_hidden_state)<br><br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;pred&#x27;</span>: pred&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">train_step</span>(<span class="hljs-params">self, input_ids, target</span>):<br>        pred = self(input_ids)[<span class="hljs-string">&#x27;pred&#x27;</span>]<br>        loss = F.cross_entropy(pred, target) <span class="hljs-comment"># æŸå¤±å‡½æ•°åœ¨è¿™é‡Œ</span><br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;loss&#x27;</span>: loss&#125;<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">evaluate_step</span>(<span class="hljs-params">self, input_ids</span>):<br>        pred = self(input_ids)[<span class="hljs-string">&#x27;pred&#x27;</span>].argmax(dim=-<span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> &#123;<span class="hljs-string">&#x27;pred&#x27;</span>: pred&#125;<br><br>model = BertClassifier(bert_model, <span class="hljs-built_in">len</span>(data_bundle.get_vocab(<span class="hljs-string">&#x27;label&#x27;</span>)))<br><br></code></pre></td></tr></table></figure>
<h2 id="æ¨¡å‹è®­ç»ƒ">æ¨¡å‹è®­ç»ƒ</h2>
<p>å’ŒNERæ–‡ç« ä¸­çš„ä¸€æ ·ï¼Œä½¿ç”¨fastNLPæ¡†æ¶è®­ç»ƒå¾ˆç®€å•ï¼Œåªéœ€è¦å‡†å¤‡å¥½æ•°æ®çš„æ ¼å¼å’Œåˆ—åã€‚</p>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> torch <span class="hljs-keyword">import</span> optim<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> Trainer, LoadBestModelCallback, TorchWarmupCallback<br><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> Accuracy<br><br>optimizer = optim.AdamW(model.parameters(), lr=<span class="hljs-number">2e-5</span>)<br>callbacks = [<br>    LoadBestModelCallback(),<br>    TorchWarmupCallback(),<br>]<br>metrics = &#123;<br>    <span class="hljs-string">&quot;acc&quot;</span>: Accuracy(),<br>&#125;<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">input_mapping</span>(<span class="hljs-params">data</span>):<br>    data[<span class="hljs-string">&#x27;target&#x27;</span>] = data[<span class="hljs-string">&#x27;label&#x27;</span>]<br>    <span class="hljs-keyword">return</span> data<br><br>trainer = Trainer(model=model, train_dataloader=dataloaders[<span class="hljs-string">&#x27;train&#x27;</span>], optimizers=optimizer,<br>                  evaluate_dataloaders=dataloaders[<span class="hljs-string">&#x27;dev&#x27;</span>],<br>                  metrics=metrics, n_epochs=<span class="hljs-number">50</span>, callbacks=callbacks,<br>                  monitor=<span class="hljs-string">&#x27;acc#acc&#x27;</span>,device=<span class="hljs-string">&#x27;cuda&#x27;</span>,driver=<span class="hljs-string">&quot;torch&quot;</span>,input_mapping=input_mapping)<br>trainer.run()<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œmetricä¸­æŒ‡å®šçš„æ˜¯<code>Accuracy</code>ï¼Œå¯¹åˆ†ç±»ä»»åŠ¡æ±‚å‡†ç¡®ç‡ï¼Œéœ€è¦è¾“å…¥åˆ—åä¸ºtargetå’Œpredçš„æ•°æ®ï¼Œæ‰€ä»¥å¤šäº†ä¸€ä¸ª<code>input_mapping</code>å‡½æ•°åšé¢„å¤„ç†ï¼Œä¹Ÿå¯ä»¥æå‰åœ¨datasetæˆ–è€…dataloaderæ—¶åšå¥½å¤„ç†ã€‚</p>
<blockquote>
<p>fastNLPåœ¨evaluateè¿‡ç¨‹ä¸­å¯ä»¥ç›´æ¥è¾“å…¥å½¢å¦‚<code>[batch,]</code>çš„labelæ•°æ®ï¼Œæ‰€ä»¥å‰æœŸä¸ç”¨æ‰‹åŠ¨å°†labelè½¬ä¸ºone-hotå‘é‡ï¼Œè¿™ä¸€ç‚¹æ–¹ä¾¿äº†å¾ˆå¤šã€‚</p>
</blockquote>
<p>è®­ç»ƒç»“æŸåç”±äº<code>LoadBestModelCallback</code>ä¼šè‡ªåŠ¨åŠ è½½æœ€ä½³æ¨¡å‹åˆ°modelä¸­ã€‚</p>
<figure>
<img src="/2023/03/31/wei-diao-bert-mo-xing-wan-cheng-wen-ben-fen-lei-feat-fastnlp/è®­ç»ƒå®Œæˆ.png" alt="è®­ç»ƒå®Œæˆ">
<figcaption aria-hidden="true">è®­ç»ƒå®Œæˆ</figcaption>
</figure>
<p>æœ€åå¾—åˆ°åœ¨éªŒè¯é›†ä¸Šçš„å‡†ç¡®ç‡0.836485</p>
<h2 id="æ¨¡å‹æµ‹è¯•">æ¨¡å‹æµ‹è¯•</h2>
<figure class="highlight python"><table><tr><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">from</span> fastNLP <span class="hljs-keyword">import</span> Evaluator<br><br>evaluator = Evaluator(model=model, dataloaders=dataloaders[<span class="hljs-string">&quot;test&quot;</span>],metrics=metrics,callbacks=callbacks,<br>                      device=<span class="hljs-number">0</span>, input_mapping=input_mapping,evaluate_batch_step_fn=<span class="hljs-literal">None</span>)<br>evaluator.run(<span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure>
<p>è¾“å‡ºæµ‹è¯•é›†ä¸Šå‡†ç¡®ç‡ï¼šè¿™ä¸ªæ¨¡å‹ç»“æœä¸º0.8125</p>
<h2 id="tnewsæ•°æ®é›†æµ‹è¯•">TNEWS'æ•°æ®é›†æµ‹è¯•</h2>
<p>æœ€åç”¨<a href="https://github.com/CLUEbenchmark/CLUE">CLUE</a>ä¸Šçš„åŸºå‡†æ•°æ®é›†åšä¸‹æµ‹è¯•ï¼Œä½¿ç”¨ä»Šæ—¥å¤´æ¡æ–°é—»æ•°æ®é›†TNEWS'ã€‚å…±æœ‰15ä¸ªç±»ï¼Œè¡¨ç¤ºæ–°é—»çš„ä¸åŒç±»åˆ«ï¼Œè®­ç»ƒé›†53kï¼ŒéªŒè¯é›†10kå¤§å°ã€‚æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight json"><table><tr><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;102&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;label_desc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;news_entertainment&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;sentence&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ±Ÿç–å½±ç”œç”œåœˆè‡ªæ‹ï¼Œè¿·ä¹‹è§’åº¦ç«Ÿè¿™ä¹ˆå¥½çœ‹ï¼Œç¾å¸å¼•ä¸€åˆ‡äº‹ç‰©&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;keywords&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;æ±Ÿç–å½±,ç¾å°‘å¥³,ç»çºªäºº,ç”œç”œåœˆ&quot;</span><span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#123;</span><span class="hljs-attr">&quot;label&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;110&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;label_desc&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;news_military&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;sentence&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ä»¥è‰²åˆ—å¤§è§„æ¨¡ç©ºè¢­å¼€å§‹ï¼ä¼Šæœ—å¤šä¸ªå†›äº‹ç›®æ ‡é­é‡æ‰“å‡»ï¼Œèª“è¨€å¯¹ç­‰åå‡»&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-attr">&quot;keywords&quot;</span><span class="hljs-punctuation">:</span> <span class="hljs-string">&quot;ä¼Šæœ—,åœ£åŸå†›,å™åˆ©äºš,ä»¥è‰²åˆ—å›½é˜²å†›,ä»¥è‰²åˆ—&quot;</span><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>
<p>éªŒè¯é›†ä¸Šæœ€ç»ˆå‡†ç¡®ç‡ä¸º0.5112ï¼Œç›¸æ¯”äºŒåˆ†ç±»éš¾åº¦ç¡®å®æ›´å¤§ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Bert</tag>
        <tag>NLP</tag>
        <tag>æ–‡æœ¬åˆ†ç±»</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘ çº¿æ€§ä»£æ•°</title>
    <url>/2022/07/24/ji-qi-xue-xi-shu-xue-ji-chu-xian-xing-dai-shu/</url>
    <content><![CDATA[<h1 id="æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘ çº¿æ€§ä»£æ•°">æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘ çº¿æ€§ä»£æ•°</h1>
<p>çº¿æ€§ä»£æ•°çš„æ ¸å¿ƒé—®é¢˜æ˜¯å°†ä¸€ä¸ªå‘é‡ç©ºé—´çš„å­ç©ºé—´æ˜ å°„åˆ°å¦ä¸€ä¸ªå‘é‡ç©ºé—´çš„å­ç©ºé—´,
è¿™ä¸ªè¿‡ç¨‹ä½¿ç”¨è¿‡çš„æ–¹æ³•å«<strong>çº¿æ€§å˜æ¢</strong>,
è€Œ<strong>çŸ©é˜µ</strong>å°±æ˜¯ä¸¤ä¸ªå‘é‡ç©ºé—´ä¹‹é—´çº¿æ€§å˜æ¢çš„è¡¨è¾¾å½¢å¼</p>
<h2 id="åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</h2>
<ul>
<li><p>çŸ©é˜µ</p></li>
<li><p>å‘é‡</p></li>
<li><p>çŸ©é˜µä¹˜æ³•: ç‚¹ç§¯</p></li>
<li><p>çŸ©é˜µè½¬ç½®</p></li>
<li><p>é€†çŸ©é˜µ: ä¸¤ä¸ªæ–¹é˜µç›¸ä¹˜ç»“æœä¸ºå•ä½é˜µ, è®°ä¸º<span class="math inline">\(A^{-1}\)</span>,ç§°<span class="math inline">\(A\)</span>ä¸ºå¯é€†çŸ©é˜µ</p></li>
<li><p>æ­£äº¤: å‘é‡<span class="math inline">\(x\)</span>ä¸<span class="math inline">\(y\)</span>æ­£äº¤, åˆ™<span class="math inline">\(x
\cdot y=0\)</span>, æ„å‘³ç€å‚ç›´</p></li>
<li><p>æ­£äº¤çŸ©é˜µ: å¯¹äºæ–¹é˜µ<span class="math inline">\(A \in \mathbb{R}^{n
\times n}\)</span>, è‹¥æœ‰<span class="math inline">\(AA^T=I_n=A^TA\)</span>, å…¶ä¸­<span class="math inline">\(A^{-1}=A^T\)</span>, æ„å‘³ç€å…¶è½¬ç½®ç­‰äºå…¶é€†çš„çŸ©é˜µ,
å³<strong>æ­£äº¤çŸ©é˜µ</strong></p></li>
<li><p>å¯¹è§’çŸ©é˜µ</p></li>
<li><p>æ­£å®šçŸ©é˜µ: æœ‰<span class="math inline">\(n\times
n\)</span>å®å¯¹ç§°çŸ©é˜µ<span class="math inline">\(A\)</span>å’Œnç»´éé›¶å‘é‡<span class="math inline">\(x\)</span>, å¦‚æœ<span class="math inline">\(x^TAx&gt;0\)</span>åˆ™ç§°<span class="math inline">\(A\)</span>ä¸º<strong>æ­£å®šçŸ©é˜µ</strong>, å¦‚æœ<span class="math inline">\(x^TAx\geqslant 0\)</span>åˆ™ç§°<span class="math inline">\(A\)</span>ä¸º<strong>åŠæ­£å®šçŸ©é˜µ</strong>.</p>
<blockquote>
<p>æ­£å®šçŸ©é˜µ<span class="math inline">\(A\)</span>ä¿è¯å˜æ¢åçš„å‘é‡<span class="math inline">\(Ax\)</span>ä¸åŸå‘é‡<span class="math inline">\(x\)</span>éƒ½ä½äºè¶…å¹³é¢çš„åŒä¸€ä¾§.</p>
</blockquote></li>
</ul>
<h2 id="é‡è¦æ¦‚å¿µ">é‡è¦æ¦‚å¿µ</h2>
<h3 id="èŒƒæ•°">èŒƒæ•°</h3>
<p>å‘é‡çš„èŒƒæ•°å°±æ˜¯å‘é‡çš„é•¿åº¦æˆ–å¤§å°, é€šé¡¹å…¬å¼ä¸º<span class="math inline">\(||\vec
x||=(\Sigma_{i=1}^{n}|x^i|^p)^{1/p}\)</span></p>
<p><em>åœ¨MLä¸­å¸¸ç”¨æ¥é™åˆ¶æ¨¡å‹å¤æ‚åº¦, é˜²æ­¢è¿‡æ‹Ÿåˆç­‰</em></p>
<p>å…¶ä¸­pä¸ºèŒƒæ•°çš„é˜¶, MLä¸­å¸¸ç”¨ä¸¤ä¸ª:</p>
<ul>
<li>p=1,ç§°ä¸ºä¸€é˜¶èŒƒæ•°<span class="math inline">\(l_1\)</span>èŒƒæ•°
L1æ­£åˆ™åŒ–, <span class="math inline">\(||\vec
x||=\Sigma_{i=1}^{n}|x^i|\)</span>, è¡¨ç¤ºå‘é‡<span class="math inline">\(x\)</span>ä¸­çš„å„å…ƒç´ ç»å¯¹å€¼çš„å’Œ</li>
<li>p=2, ç§°ä¸ºäºŒé˜¶èŒƒæ•°<span class="math inline">\(l_2\)</span>èŒƒæ•°
L2æ­£åˆ™åŒ–,<span class="math inline">\(||\vec x||=\sqrt{
\Sigma_{i=1}^{n}|x^i|^2}\)</span>, è¡¨ç¤ºå‘é‡ä¸­çš„å…ƒç´ å¹³æ–¹å’Œå†å¼€å¹³æ–¹</li>
</ul>
<h3 id="æŸ¯è¥¿ä¸ç­‰å¼">æŸ¯è¥¿ä¸ç­‰å¼</h3>
<p>ç”±ä½™å¼¦å®šç†<span class="math inline">\(\vec a \cdot \vec b=|\vec
a||\vec b|\cos \theta\)</span>å¾—: <span class="math display">\[
|\vec a \cdot \vec b|\leqslant |\vec a||\vec b|
\]</span></p>
<h2 id="çŸ©é˜µè¿ç®—å¸¸ç”¨æŠ€å·§">çŸ©é˜µè¿ç®—å¸¸ç”¨æŠ€å·§</h2>
<ol type="1">
<li><p>è‹¥<span class="math inline">\(A\)</span>å’Œ<span class="math inline">\(B\)</span>æ˜¯né˜¶æ–¹é˜µ, ä¸”<span class="math inline">\(A+B\)</span>å¯é€†, æœ‰: <span class="math display">\[
A(A+B)^{-1}B=B(A+B)^{-1}A
\]</span></p></li>
<li><p><strong>çŸ©é˜µæŒ‡æ•°</strong> <span class="math inline">\(A\)</span>å’Œ<span class="math inline">\(B\)</span>æ˜¯né˜¶æ–¹é˜µ, æœ‰:</p>
<ul>
<li><p><span class="math display">\[
  e^{A^{T}}=(e^A)^T
  \]</span></p></li>
<li><p>è‹¥<span class="math inline">\(AB=BA\)</span>, åˆ™</p></li>
</ul>
<p><span class="math display">\[
e^Ae^B = e^Be^A = e^{A+B}
\]</span></p></li>
</ol>
<h2 id="å¼ é‡å’Œå¼ é‡ç§¯">å¼ é‡å’Œå¼ é‡ç§¯</h2>
<p><strong>å¼ é‡</strong>æ˜¯åœ¨MLä¸­å¸¸ç”¨çš„æ¦‚å¿µ,
å¯ç†è§£ä¸ºå­˜åœ¨[æ ‡é‡,å‘é‡,çŸ©é˜µ...]ç­‰å½¢å¼çš„ä¸€ç§æ•°æ®ç»“æ„ å¼ é‡ç§¯(tensor
product)åˆç§°å…‹ç½—å†…å…‹ç§¯(Kronecker product)</p>
<h3 id="å®šä¹‰">å®šä¹‰</h3>
<p><span class="math inline">\(A=(a_{ij})_{m\times n}\)</span> , <span class="math inline">\(B\)</span> ä¸º<span class="math inline">\(p\times
q\)</span>çŸ©é˜µ, å¼ é‡ç§¯<span class="math inline">\(A\otimes
B\)</span>æ˜¯ä¸€ä¸ª<span class="math inline">\(mp\times nq\)</span>çŸ©é˜µ: $$
AB =</p>
<p>$$</p>
<h2 id="ç‰¹å¾åˆ†è§£">ç‰¹å¾åˆ†è§£</h2>
<p>æ˜¯æŒ‡å°†çŸ©é˜µåˆ†ä¸ºä¸€ç»„ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼</p>
<h3 id="ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼">ç‰¹å¾å‘é‡å’Œç‰¹å¾å€¼</h3>
<p>ä¸€ä¸ªå¯å¯¹è§’åŒ–çš„çŸ©é˜µ<span class="math inline">\(A\)</span>çš„<strong>ç‰¹å¾å‘é‡</strong><span class="math inline">\(v\)</span> æœ‰: <span class="math display">\[
Av= \lambda v
\]</span></p>
<blockquote>
<p>ä¸€ä¸ªæ–¹é˜µä¸ç‰¹å¾å‘é‡ç›¸ä¹˜ ç›¸å½“äº å¯¹ç‰¹å¾å‘é‡è¿›è¡Œç¼©æ”¾.</p>
</blockquote>
<p>æ ‡é‡<span class="math inline">\(\lambda\)</span>å°±æ˜¯è¿™ä¸ªç‰¹å¾å‘é‡çš„<strong>ç‰¹å¾å€¼</strong></p>
<h3 id="å¥‡å¼‚å€¼åˆ†è§£svd">å¥‡å¼‚å€¼åˆ†è§£(SVD)</h3>
<p>ç”±äºç‰¹å¾åˆ†è§£è¦æ±‚çŸ©é˜µ<span class="math inline">\(A\)</span>æ˜¯ä¸€ä¸ªå¯å¯¹è§’åŒ–çš„çŸ©é˜µ, è¦æ±‚å¾ˆé«˜</p>
<p>ä¸ºå°†ç‰¹å¾åˆ†è§£è¿›è¡Œæ¨å¹¿, ä½¿ç”¨çš„æ–¹æ³•å«"çŸ©é˜µçš„å¥‡å¼‚å€¼åˆ†è§£", å¯¹äºä¸€ä¸ª<span class="math inline">\(m \times n\)</span>çš„çŸ©é˜µ<span class="math inline">\(A\)</span>: <span class="math display">\[
A= UDV^T
\]</span> <span class="math inline">\(U\)</span>æ˜¯<span class="math inline">\(m\times m\)</span>æ–¹é˜µ, <span class="math inline">\(D\)</span>æ˜¯<span class="math inline">\(m\times
n\)</span>çŸ©é˜µ, <span class="math inline">\(V\)</span>æ˜¯<span class="math inline">\(n\times n\)</span>æ–¹é˜µ</p>
<p><span class="math inline">\(UV\)</span>éƒ½æ˜¯æ­£äº¤çŸ©é˜µ, <span class="math inline">\(D\)</span>æ˜¯å¯¹è§’çŸ©é˜µ, <span class="math inline">\(D\)</span>çš„å¯¹è§’çº¿ä¸Šçš„å…ƒç´ å°±æ˜¯çŸ©é˜µ<span class="math inline">\(A\)</span>çš„<strong>å¥‡å¼‚å€¼</strong>,<span class="math inline">\(U\)</span>çš„åˆ—å‘é‡è¢«ç§°ä¸º<strong>å·¦å¥‡å¼‚å‘é‡</strong>,
<span class="math inline">\(V\)</span>çš„åˆ—å‘é‡è¢«ç§°ä¸º<strong>å³å¥‡å¼‚å‘é‡</strong></p>
<h2 id="è·ç¦»è®¡ç®—">è·ç¦»è®¡ç®—</h2>
<p>è®¡ç®—ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„è·ç¦», å¯ä»¥åæ˜ ä¹‹é—´çš„ç›¸ä¼¼ç¨‹åº¦</p>
<p>ç°æœ‰ä¸¤ä¸ªnç»´å˜é‡ <span class="math display">\[
A= [x_{11},x_{12},\dots,x_{1n}]\\
B= [x_{21},x_{22},\dots,x_{2n}]
\]</span></p>
<h3 id="æ›¼å“ˆé¡¿è·ç¦»">1. æ›¼å“ˆé¡¿è·ç¦»</h3>
<p>è¡¨ç¤ºå‘é‡å¯¹åº”å…ƒç´ çš„è·ç¦»å’Œ <span class="math display">\[
d_{12} = \sum \limits _{k=1}^n |x_{1k}-x_{2k}|
\]</span></p>
<h3 id="æ¬§æ°è·ç¦»">2. æ¬§æ°è·ç¦»</h3>
<p>å°±æ˜¯L2èŒƒæ•°, è¡¨ç¤ºå¯¹åº”å…ƒç´ çš„è·ç¦»çš„å¹³æ–¹å’Œçš„å¼€æ–¹ <span class="math display">\[
d_{12} = \sqrt{\sum \limits _{k=1}^n (x_{1k}-x_{2k})^2}
\]</span></p>
<h3 id="åˆ‡æ¯”é›ªå¤«è·ç¦»">3. åˆ‡æ¯”é›ªå¤«è·ç¦»</h3>
<p>ä¹Ÿæ˜¯æ— ç©·èŒƒæ•°, è¡¨ç¤ºå„å…ƒç´ ä¸Šè·ç¦»ä¸­çš„æœ€å¤§å€¼ <span class="math display">\[
d_{12} = \max (|x_{1k}-x_{2k}|)
\]</span></p>
<h3 id="ä½™å¼¦è·ç¦»">4. ä½™å¼¦è·ç¦»</h3>
<p>ä¸¤ä¸ªæ–¹å‘çš„å¤¹è§’ä½™å¼¦å–å€¼èŒƒå›´ä¸º[-1,1]</p>
<p>å¤¹è§’ä½™å¼¦è¶Šå¤§,è¡¨ç¤ºä¸¤ä¸ªå‘é‡å¤¹è§’è¶Šå°; æ–¹å‘é‡åˆçš„ä¸¤ä¸ªå‘é‡,
ä½™å¼¦å€¼ä¸º1;æ–¹å‘ç›¸åæ—¶, ä½™å¼¦å€¼ä¸º-1 <span class="math display">\[
\begin{aligned}
\cos \theta&amp;= \frac {AB}{|A||B|} \\
&amp;= \frac {\sum \limits _{k=1}^{n}x_{1k}x_{2k}}{\sqrt {\sum \limits
_{k=1}^{n}x_{1k}^2}\sqrt {\sum \limits _{k=1}^{n}x_{2k}^2}}
\end{aligned}
\]</span></p>
<h3 id="æ±‰æ˜è·ç¦»">5. æ±‰æ˜è·ç¦»</h3>
<p>å®šä¹‰ä¸¤ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä¸åŒä½æ•°çš„æ•°ç›®</p>
<p><span class="math inline">\(e.g.\)</span>
å­—ç¬¦ä¸²<code>1111</code>å’Œ<code>1001</code>çš„æ±‰æ˜è·ç¦»ä¸º2</p>
<h3 id="æ°å¡å¾·ç›¸ä¼¼ç³»æ•°">6. æ°å¡å¾·ç›¸ä¼¼ç³»æ•°</h3>
<p>ä¸¤ä¸ªé›†åˆABçš„äº¤é›†å…ƒç´ åœ¨å¹¶é›†ä¸­çš„æ¯”ä¾‹ <span class="math display">\[
J(A,B) = \frac {|A\cap B|}{|A\cup B|}
\]</span></p>
<h3 id="æ°å¡å¾·è·ç¦»">7. æ°å¡å¾·è·ç¦»</h3>
<p>ä¸æ°å¡å¾·ç›¸ä¼¼ç³»æ•°è¡¨ç¤ºçš„å†…å®¹ç›¸å <span class="math display">\[
J_{\sigma}=1 - J(A,B) = 1- \frac {|A\cap B|}{|A\cup B|}
\]</span></p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>çº¿æ€§ä»£æ•°</tag>
        <tag>ML</tag>
        <tag>DL</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘¡æ¦‚ç‡è®ºå’Œä¿¡æ¯è®º</title>
    <url>/2022/07/26/ji-qi-xue-xi-shu-xue-ji-chu-gai-lu-lun-he-xin-xi-lun/</url>
    <content><![CDATA[<h1 id="æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘¡æ¦‚ç‡è®ºä¸ä¿¡æ¯è®º">æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘¡æ¦‚ç‡è®ºä¸ä¿¡æ¯è®º</h1>
<h1 id="åŸºç¡€æ¦‚å¿µ">åŸºç¡€æ¦‚å¿µ</h1>
<ul>
<li><p>éšæœºå˜é‡:å¯ä»¥æ˜¯è¿ç»­çš„ä¹Ÿå¯ä»¥æ˜¯ç¦»æ•£çš„</p></li>
<li><p>æ¦‚ç‡åˆ†å¸ƒ:ç¬¦åˆéšæœºå˜é‡å–å€¼èŒƒå›´çš„æŸä¸ªå¯¹è±¡å±äºæŸä¸ªç±»åˆ«æˆ–æœä»æŸç§è¶‹åŠ¿çš„å¯èƒ½æ€§</p></li>
<li><p>è”åˆæ¦‚ç‡åˆ†å¸ƒ:<span class="math inline">\(P(\mathrm x =x,\mathrm
y=y)\)</span>è¡¨ç¤ºx=<span class="math inline">\(x\)</span>å’Œy=<span class="math inline">\(y\)</span>åŒæ—¶å‘ç”Ÿçš„æ¦‚ç‡,ç®€å†™ä¸º<span class="math inline">\(P(x,y)\)</span></p></li>
<li><p>æ¦‚ç‡å‡½æ•°å’Œä¼¼ç„¶å‡½æ•°</p>
<ul>
<li><p>Note:åŒºåˆ«</p>
<p>å¯¹äºä¸€ä¸ªå‡½æ•°<span class="math inline">\(P(x|\theta)\)</span>,å…¶ä¸­xè¡¨ç¤ºä¸€ä¸ªå…·ä½“çš„æ•°æ®,<span class="math inline">\(\theta\)</span>è¡¨ç¤ºæ¨¡å‹çš„å‚æ•°.</p>
<p>å¦‚æœ<span class="math inline">\(\theta\)</span>å·²çŸ¥,xä¸ºå˜é‡,è¿™ä¸ªå‡½æ•°å°±æ˜¯<strong>æ¦‚ç‡å‡½æ•°</strong>.è¡¨ç¤ºå¯¹äºä¸åŒçš„æ ·æœ¬ç‚¹x,å…¶å‡ºç°çš„æ¦‚ç‡æ˜¯å¤šå°‘.</p>
<p>å¦‚æœxå·²çŸ¥,<span class="math inline">\(\theta\)</span>ä¸ºå˜é‡,è¿™ä¸ªå‡½æ•°å°±æ˜¯<strong>ä¼¼ç„¶å‡½æ•°</strong>.è¡¨ç¤ºå¯¹äºä¸åŒçš„å‚æ•°,å‡ºç°xæ ·æœ¬ç‚¹çš„æ¦‚ç‡æ˜¯å¤šå°‘.</p></li>
</ul></li>
<li><p>æœŸæœ›:<span class="math inline">\(E(X)=\sum \limits
_{k=1}^{n}x_kP(x_k), E(x)=\int xf(x)dx\)</span></p></li>
<li><p>æ–¹å·®:å„ä¸ªæ ·æœ¬æ•°æ®åˆ†åˆ«ä¸å¹³å‡æ•°ä¹‹å·®çš„å¹³æ–¹å’Œçš„å¹³å‡æ•°<span class="math inline">\(Var(x)\)</span></p></li>
<li><p>åæ–¹å·®:è¡¡é‡éšæœºå˜é‡Xå’ŒYä¹‹é—´çš„æ€»ä½“è¯¯å·®<span class="math inline">\(Cov(X,Y)\)</span></p></li>
</ul>
<h1 id="é‡è¦æ¦‚å¿µ">é‡è¦æ¦‚å¿µ</h1>
<ul>
<li><strong>æ¡ä»¶æ¦‚ç‡</strong>:å¯¹äºç»™å®š<span class="math inline">\(X=x\)</span>æ—¶å‘ç”Ÿ<span class="math inline">\(Y=y\)</span>çš„æ¦‚ç‡è®°ä¸º<span class="math inline">\(P(Y=y|X=x)\)</span>,è®¡ç®—å…¬å¼ä¸º<span class="math inline">\(P(Y=y|X=x)=\frac {P(x,y)}{P(X=x)}\)</span></li>
<li><strong>å…ˆéªŒæ¦‚ç‡å’ŒåéªŒæ¦‚ç‡</strong></li>
<li><strong>è´å¶æ–¯å…¬å¼</strong>:åˆ©ç”¨å…ˆéªŒæ¦‚ç‡è®¡ç®—åéªŒæ¦‚ç‡
<ul>
<li><p>Note:è´å¶æ–¯å…¬å¼æ¨å¯¼</p>
<p><span class="math display">\[
  P(B|A)=\frac {P(AB)}{P(A)}, P(A|B)=\frac {P(AB)}{P(B)}
  \]</span></p>
<p><span class="math display">\[
  P(AB)=P(B|A)P(A)=P(A|B)P(B)
  \]</span></p>
<p><span class="math display">\[
  P(B|A)=\frac {P(B|A)P(B)}{P(A)}
  \]</span></p>
<p>å…¨æ¦‚ç‡å…¬å¼æ±‚<span class="math inline">\(P(A)\)</span></p>
<p><span class="math display">\[
  P(A)=\sum \limits _{i=1}^{N}P(A|B_i)P(B_i)
  \]</span></p>
<p>ä»£å…¥å¾—åˆ°è´å¶æ–¯å…¬å¼:</p>
<p><span class="math display">\[
  P(B_i|A)=\frac {P(A|B_i)P(B_i)}{\sum \limits _{i=1}^{N}P(A|B_i)P(B_i)}
  \]</span></p></li>
</ul></li>
<li><strong>æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE):</strong>åœ¨â€æ¨¡å‹å·²å®š,å‚æ•°<span class="math inline">\(\theta\)</span>æœªçŸ¥â€çš„æƒ…å†µä¸‹,é€šè¿‡è§‚æµ‹æ•°æ®æ¥ä¼°è®¡æœªçŸ¥å‚æ•°<span class="math inline">\(\theta\)</span>çš„ä¸€ç§æ–¹æ³•,è¦æ±‚æ‰€æœ‰é‡‡æ ·éƒ½æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒ.
<ul>
<li>Note:æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ä½¿ç”¨
<ol type="1">
<li>å†™å‡ºä¼¼ç„¶å‡½æ•°</li>
<li>å¯¹ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°</li>
<li>ä¸¤è¾¹åŒæ—¶æ±‚å¯¼(å¤šä¸ªå˜é‡å°±æ±‚åå¯¼)</li>
<li>ä»¤å¯¼æ•°ä¸º0,è§£å‡ºä¼¼ç„¶æ–¹ç¨‹</li>
</ol>
<ul>
<li><p>ä¾‹å­</p>
<figure>
<img src="https://s2.loli.net/2022/07/26/yXuBHYVrIP5LpNZ.png" alt="ä¾‹é¢˜">
<figcaption aria-hidden="true">ä¾‹é¢˜</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2022/07/26/LFjf2RnIMZbyuOo.png" alt="ä¾‹é¢˜è§£ç­”">
<figcaption aria-hidden="true">ä¾‹é¢˜è§£ç­”</figcaption>
</figure></li>
</ul></li>
</ul></li>
</ul>
<h1 id="å¸¸è§åˆ†å¸ƒå‡½æ•°">å¸¸è§åˆ†å¸ƒå‡½æ•°</h1>
<ol type="1">
<li><p>0-1åˆ†å¸ƒ</p>
<p><span class="math display">\[
P(X=1)=p \\ P(X=0)=1-p
\]</span></p></li>
<li><p>å‡ ä½•åˆ†å¸ƒ</p>
<p>ç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒ.åœ¨næ¬¡ä¼¯åŠªåˆ©è¯•éªŒä¸­,å‰k-1æ¬¡å¤±è´¥,ç¬¬kæ¬¡æˆåŠŸçš„æ¦‚ç‡,å…¶æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ä¸º:<span class="math inline">\(P(X=k)=(1-p)^{k-1}p\)</span></p>
<p><span class="math display">\[
E(X)=\frac {1}{p} \\ Var(X)=\frac {1-p}{p^2}
\]</span></p></li>
<li><p>äºŒé¡¹åˆ†å¸ƒ</p>
<p>næ¬¡ä¼¯åŠªåˆ©è¯•éªŒä¸­,æ¯æ¬¡è¯•éªŒåªæœ‰ä¸¤ç§å¯èƒ½ç»“æœ,å¹¶ä¸”ä¸¤ç§ç»“æœç›¸äº’ç‹¬ç«‹.åœ¨næ¬¡é‡å¤ç‹¬ç«‹è¯•éªŒä¸­äº‹ä»¶å‘ç”Ÿkæ¬¡çš„æ¦‚ç‡ä¸º:<span class="math inline">\(P(X=k)=C_n^kp^k(1-p)^{n-k}\)</span> <span class="math display">\[
E(X)=np \\ Var(X)=np(1-p)
\]</span></p></li>
<li><p>é«˜æ–¯åˆ†å¸ƒ/æ­£æ€åˆ†å¸ƒ</p>
<p>MLä¸­æœ€å¸¸ç”¨çš„æ¦‚ç‡åˆ†å¸ƒ.å…¶ä¸­ <span class="math inline">\(\mu\)</span>å†³å®šåˆ†å¸ƒä¸­å¿ƒçš„ä½ç½®,<span class="math inline">\(\sigma\)</span> æ ‡å‡†å·®å†³å®šæ­£æ€åˆ†å¸ƒçš„å¹…åº¦.</p>
<figure>
<img src="https://s2.loli.net/2022/07/26/EXJlHW7oDNhqCbI.png" alt="æ­£æ€åˆ†å¸ƒä¾‹å›¾">
<figcaption aria-hidden="true">æ­£æ€åˆ†å¸ƒä¾‹å›¾</figcaption>
</figure>
<p><span class="math display">\[
X \sim N(\mu,\sigma^2)
\]</span></p></li>
<li><p>æŒ‡æ•°åˆ†å¸ƒ</p>
<p>æŒ‡æ•°åˆ†å¸ƒæ˜¯ä¸€ç§è¿ç»­æ¦‚ç‡åˆ†å¸ƒ,å¯ä»¥ç”¨æ¥è¡¨ç¤ºç‹¬ç«‹éšæœºäº‹ä»¶å‘ç”Ÿçš„æ—¶é—´é—´éš”.å…¶ä¸­<span class="math inline">\(\lambda
&gt;0\)</span>è¡¨ç¤ºæ¯å•ä½æ—¶é—´å†…å‘ç”Ÿäº‹ä»¶çš„æ¬¡æ•°.</p>
<figure>
<img src="https://s2.loli.net/2022/07/26/afSYlZeE3C8jOKy.png" alt="æŒ‡æ•°åˆ†å¸ƒä¾‹å›¾">
<figcaption aria-hidden="true">æŒ‡æ•°åˆ†å¸ƒä¾‹å›¾</figcaption>
</figure>
<p><span class="math display">\[
X\sim Exp(\lambda)
\]</span></p>
<p>æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º:</p>
<p><span class="math display">\[
f(x;\lambda)=
\left\{
\begin{aligned}
&amp;\lambda e^{-\lambda x} &amp;x\geq0 \\
&amp;0&amp;x&lt;0
\end{aligned}
\right.
\]</span></p>
<p>ç‰¹ç‚¹ä¸ºæ— è®°å¿†æ€§,åœ¨ä»»æ„æ—¶é—´æ®µå†…æŸä¸ªäº‹ä»¶å‘ç”Ÿçš„æ¦‚ç‡ç›¸åŒ,ç»“åˆæœŸæœ›ç†è§£.æœŸæœ›ä¸º:<span class="math inline">\(E(x)=\frac {1}{\lambda}\)</span>.</p></li>
<li><p>æ³Šæ¾åˆ†å¸ƒ</p>
<p>æ³Šæ¾åˆ†å¸ƒæ˜¯ä¸€ç§å¸¸è§çš„ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒ.é€‚åˆæè¿°å•ä½æ—¶é—´å†…éšæœºäº‹ä»¶å‘ç”Ÿçš„æ¬¡æ•°çš„æ¦‚ç‡åˆ†å¸ƒ.å‚æ•°<span class="math inline">\(\lambda\)</span>æ˜¯éšæœºäº‹ä»¶å‘ç”Ÿæ¬¡æ•°çš„æ•°å­¦æœŸæœ›.</p>
<figure>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/16/Poisson_pmf.svg/650px-Poisson_pmf.svg.png" alt="æ³Šæ¾åˆ†å¸ƒä¾‹å›¾">
<figcaption aria-hidden="true">æ³Šæ¾åˆ†å¸ƒä¾‹å›¾</figcaption>
</figure>
<p>æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸º:</p>
<p><span class="math display">\[
P(X=k)=\frac {e^{-\lambda}\lambda^k}{k!}
\]</span></p>
<p>æ³Šæ¾åˆ†å¸ƒè¡¨ç¤ºä¸º:</p>
<p><span class="math display">\[
X \sim Pois(\lambda)
\]</span></p>
<p>æ€§è´¨æœ‰</p>
<ol type="1">
<li><p>æœŸæœ›ä¸æ–¹å·®ç›¸ç­‰,éƒ½ç­‰äºå‚æ•°<span class="math inline">\(\lambda\)</span></p></li>
<li><p>ä¸¤ä¸ªç‹¬ç«‹ä¸”æœä»æ³Šæ¾åˆ†å¸ƒçš„éšæœºå˜é‡,å…¶å’Œä»ç„¶æœä»æ³Šæ¾åˆ†å¸ƒ</p>
<p><span class="math display">\[
X \sim Poisson(\lambda_1),Y \sim Possion(\lambda_2)\\
X+Y \sim Poisson(\lambda_1+\lambda_2)
\]</span></p></li>
</ol></li>
</ol>
<h1 id="ä¿¡æ¯è®º">ä¿¡æ¯è®º</h1>
<p><strong>è‡ªä¿¡æ¯:</strong></p>
<p>ä¸€ä¸ªäº‹ä»¶x=<span class="math inline">\(x\)</span>çš„è‡ªä¿¡æ¯ä¸º<span class="math inline">\(I(x)=-\log P(x)\)</span></p>
<p><strong>é¦™å†œç†µ:</strong></p>
<p>ä¸€ä¸ªåˆ†å¸ƒP(x)çš„äº‹ä»¶äº§ç”Ÿçš„ä¿¡æ¯æ€»é‡çš„æœŸæœ›</p>
<p><span class="math display">\[
H(x)=\mathbb{E}_{X\sim P}[I(x)]=-\mathbb{E}_{X\sim P}[\log P(x)]
\]</span></p>
<p><strong>KLæ•£åº¦(KL divergence):</strong></p>
<p>è¡¡é‡ä¸¤ä¸ªå•ç‹¬çš„æ¦‚ç‡åˆ†å¸ƒP(x)å’ŒQ(x)çš„å·®å¼‚.KLæ•£åº¦éè´Ÿ,ä¸º0æ—¶è¡¨ç¤ºåˆ†å¸ƒç›¸åŒ.</p>
<p><span class="math display">\[
D_{KL}(P||Q)=\mathbb{E}_{X\sim P}\left[ \log \frac {P(x)}{Q(x)}
\right]=\mathbb{E}_{X\sim P}[\log P(x)- \log Q(x)]
\]</span></p>
<aside>
ğŸ’¡ KLæ•£åº¦ä¸­çš„Påˆ†å¸ƒå’ŒQåˆ†å¸ƒä¸èƒ½äº¤æ¢é¡ºåº
</aside>
<p><strong>äº¤å‰ç†µ(cross-entropy):</strong></p>
<p><span class="math display">\[
H(P,Q)=H(P)+D_{KL}(P||Q)=-\mathbb{E}_{X\sim P}\log Q(x)
\]</span></p>
<aside>
ğŸ’¡ åœ¨ä¿¡æ¯è®ºä¸­0log0ç»“æœå–0
</aside>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ML</tag>
        <tag>æ¦‚ç‡</tag>
      </tags>
  </entry>
  <entry>
    <title>æœºå™¨å­¦ä¹ æ•°å­¦åŸºç¡€â‘¢æ•°å€¼è®¡ç®—å’Œæœ€ä¼˜åŒ–ç†è®º</title>
    <url>/2022/07/30/ji-qi-xue-xi-shu-xue-ji-chu-shu-zhi-ji-suan-he-zui-you-hua-li-lun/</url>
    <content><![CDATA[<h1 id="æ•°å€¼è®¡ç®—">æ•°å€¼è®¡ç®—</h1>
<h2 id="ä¸Šæº¢å’Œä¸‹æº¢">ä¸Šæº¢å’Œä¸‹æº¢</h2>
<p>åœ¨æ•°å­—è®¡ç®—æœºä¸­æˆ‘ä»¬éœ€è¦é€šè¿‡æœ‰é™çš„ä½æ•°è¡¨ç¤ºæ— é™å¤šçš„å®æ•°,è¿™æ„å‘³ç€ä¼šå¼•å…¥è¯¯å·®.</p>
<ul>
<li><strong>ä¸‹æº¢(underflow):</strong>å½“æ¥è¿‘é›¶çš„æ•°è¢«å››èˆäº”å…¥ä¸ºé›¶æ—¶å‘ç”Ÿä¸‹æº¢ã€‚è®¸å¤šå‡½æ•°ä¼šåœ¨å…¶å‚æ•°ä¸ºé›¶è€Œä¸æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ­£æ•°æ—¶æ‰ä¼šè¡¨ç°å‡ºè´¨çš„ä¸åŒã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬é€šå¸¸è¦é¿å…è¢«é›¶é™¤<strong>ã€‚</strong></li>
<li><strong>ä¸Šæº¢(overflow):</strong>å½“å¤§é‡çº§çš„æ•°è¢«è¿‘ä¼¼ä¸º<span class="math inline">\(\infin\)</span>æˆ–<span class="math inline">\(-\infin\)</span>æ—¶å‘ç”Ÿä¸Šæº¢ã€‚è¿›ä¸€æ­¥çš„è¿ç®—é€šå¸¸å°†è¿™äº›æ— é™å€¼å˜ä¸ºéæ•°å­—ã€‚</li>
</ul>
<p>é¿å…æ•°å€¼ä¸Šæº¢æˆ–è€…ä¸‹æº¢çš„æ–¹æ³•å¸¸ç”¨softmaxå‡½æ•°.</p>
<figure>
<img src="/2022/07/30/ji-qi-xue-xi-shu-xue-ji-chu-shu-zhi-ji-suan-he-zui-you-hua-li-lun/softmaxå‡½æ•°.png" alt="softmaxå‡½æ•°">
<figcaption aria-hidden="true">softmaxå‡½æ•°</figcaption>
</figure>
<p>softmaxå‡½æ•°èƒ½å¤Ÿå°†ä¸Šä¸‹æ¥è¿‘æº¢å‡ºçš„æ•°æ®<em>å‹ç¼©</em>è‡³0-1çš„èŒƒå›´å†….</p>
<h1 id="æœ€ä¼˜åŒ–">æœ€ä¼˜åŒ–</h1>
<h2 id="æœ€ä¼˜åŒ–ç†è®º">æœ€ä¼˜åŒ–ç†è®º</h2>
<p><strong>ç»éªŒé£é™©æœ€å°åŒ–</strong></p>
<p>ç”¨æœ€å°çš„ä»£ä»·å–å¾—æœ€å¤§çš„æ”¶ç›Š.ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä»Šå¤©å¸¸è¯´çš„ç®—æ³•.</p>
<h2 id="å‡¸é›†ä¸å‡¸é›†åˆ†ç¦»å®šç†">å‡¸é›†ä¸å‡¸é›†åˆ†ç¦»å®šç†</h2>
<h3 id="å‡¸é›†">1.å‡¸é›†</h3>
<p>åœ¨å®æ•°åŸŸçš„å‘é‡ç©ºé—´ä¸­.å¦‚æœä¸€ä¸ªé›†åˆä¸­ä»»æ„ä¸¤ç‚¹çš„è¿çº¿ä¸Šçš„ç‚¹éƒ½åœ¨è¯¥é›†åˆä¸­,åˆ™è¯¥é›†åˆä¸º<strong>å‡¸é›†</strong>.</p>
<figure>
<img src="https://pic1.zhimg.com/v2-608f89f47688c41e4c3f83cfad095c84_r.jpg" alt="å‡¸é›†å’Œéå‡¸é›†">
<figcaption aria-hidden="true">å‡¸é›†å’Œéå‡¸é›†</figcaption>
</figure>
<p>æ•°å­¦å®šä¹‰: ä¸€ä¸ªé›†åˆ<span class="math inline">\(S\subset
R^T\)</span>,è‹¥å¯¹äºä»»æ„ä¸¤ç‚¹<span class="math inline">\(x,y \in
S\)</span>,ä»¥åŠå®æ•°<span class="math inline">\(\lambda(0\leqslant
\lambda \leqslant 1)\)</span>,éƒ½æœ‰<span class="math inline">\(\lambda
x+(1-\lambda )y \in S\)</span>,åˆ™ç§°é›†åˆSä¸ºå‡¸é›†.</p>
<h3 id="è¶…å¹³é¢å’ŒåŠç©ºé—´">2.è¶…å¹³é¢å’ŒåŠç©ºé—´</h3>
<p>ä¸‰ç»´ç©ºé—´çš„<strong>è¶…å¹³é¢</strong>å°±æ˜¯ä¸€ä¸ªé¢(æ›²é¢),äºŒç»´ç©ºé—´çš„è¶…å¹³é¢å°±æ˜¯ä¸€æ¡çº¿(æ›²çº¿),æ¨å¹¿åˆ°nç»´ç©ºé—´.</p>
<p>è¶…å¹³é¢çš„æŸä¸€ä¸ªæ–¹å‘çš„æ‰€æœ‰æ ·æœ¬ç»„æˆ<strong>åŠç©ºé—´.</strong></p>
<h3 id="å‡¸é›†åˆ†ç¦»å®šç†">3.å‡¸é›†åˆ†ç¦»å®šç†</h3>
<p>æ‰€è°“ä¸¤ä¸ªå‡¸é›†åˆ†ç¦»ï¼Œç›´è§‚åœ°çœ‹æ˜¯æŒ‡ä¸¤ä¸ªå‡¸é›†åˆæ²¡æœ‰äº¤å‰å’Œé‡åˆçš„éƒ¨åˆ†ï¼Œå› æ­¤å¯ä»¥ç”¨ä¸€å¼ è¶…å¹³é¢å°†ä¸¤è€…éš”åœ¨ä¸¤è¾¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<figure>
<img src="https://pic2.zhimg.com/80/v2-4116a3bda12faa5e2421ce27efb7fb71_1440w.jpg" alt="å‡¸é›†åˆ†ç¦»">
<figcaption aria-hidden="true">å‡¸é›†åˆ†ç¦»</figcaption>
</figure>
<h3 id="å‡¸å‡½æ•°">4.å‡¸å‡½æ•°</h3>
<p>å‡¸å‡½æ•°æ˜¯ä¸€ä¸ªå®šä¹‰åŸŸåœ¨æŸä¸ªå‘é‡ç©ºé—´çš„å‡¸å­é›†ä¸Šçš„å®å€¼å‡½æ•°.</p>
<figure>
<img src="https://pic3.zhimg.com/80/v2-f1b39d0aad4388433158679221f813d2_1440w.jpg" alt="å‡¸å‡½æ•°">
<figcaption aria-hidden="true">å‡¸å‡½æ•°</figcaption>
</figure>
<aside>
ğŸ’¡ åœ¨å›¾ä¸­ç›´çº¿å§‹ç»ˆåœ¨å‡¸å‡½æ•°æ›²çº¿ä¸Šæ–¹
</aside>
<p>æ•°å­¦å®šä¹‰:å¯¹äºå‡½æ•°f(x),å¦‚æœå…¶å®šä¹‰åŸŸCæ˜¯å‡¸é›†,ä¸”å¯¹äº<span class="math inline">\(\forall x,y \in C, 0\leqslant \alpha \leqslant
1\)</span>,æœ‰:</p>
<p><span class="math display">\[
f(\theta x+(1-\theta )y)\leqslant \theta f(x)+(1-\theta )f(y)
\]</span></p>
<p><strong>å¦‚æœä¸€ä¸ªå‡½æ•°æ˜¯å‡¸å‡½æ•°,åˆ™å…¶å±€éƒ¨æœ€ä¼˜ç‚¹å°±æ˜¯å…¶å…¨å±€æœ€ä¼˜ç‚¹.</strong></p>
<p>å› ä¸ºåœ¨MLä¸­æˆ‘ä»¬å°±æ˜¯åœ¨æ±‚æ¨¡å‹çš„å…¨å±€æœ€ä¼˜ç‚¹,æ‰€ä»¥ä¸€æ—¦è¯æ˜MLæ¨¡å‹ä¸­çš„æŸå¤±å‡½æ•°ä¸ºå‡¸å‡½æ•°,ç›¸å½“äºæˆ‘ä»¬åªéœ€è¦æ±‚å®ƒçš„å±€éƒ¨æœ€ä¼˜ç‚¹.</p>
<aside>
ğŸ’¡ æ±‚è§£éå‡¸å‡½æ•°çš„å…¨å±€æœ€ä¼˜ç‚¹ä¹Ÿå°±æˆäº†ç¥ç»ç½‘ç»œä¸­çš„å¸¸è§éš¾é¢˜.
</aside>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ML</tag>
      </tags>
  </entry>
  <entry>
    <title>æ¸…æ²³æ‘æ”¯æ•™å›å¿†</title>
    <url>/2021/09/23/qing-he-cun-zhi-jiao-hui-yi/</url>
    <content><![CDATA[<p><em>æˆæ–‡äº2021å¹´8æœˆ11æ—¥ç¦»å¼€æ¸…æ²³æ‘ã€‚</em><br>
â€ƒâ€ƒå¤§åŒ…å°åŒ…çš„è¡Œæï¼Œé¢ é¢ ç°¸ç°¸çš„å±±è·¯ï¼Œå‡ºå‘å‰å¿å¿å¿‘å¿‘çš„å¿ƒæƒ…åœ¨è¿›å…¥æ¸…æ²³æ‘åç»ˆäºæœ‰æ‰€å¹³å¤ï¼Œæ·±å±±ã€å…¬è·¯ã€è™«é¸£ã€é¸Ÿå«ï¼Œä¸ä»”ç»†è§‚å¯Ÿå¾ˆéš¾å‘ç°è¿™åº§éšè—åœ¨å±±å³¦é—´çš„å®Œå…¨å°å­¦ã€‚è®¾æ–½è½åã€ç¯å¢ƒç³Ÿç³•ã€èšŠè™«å›°æ‰°ã€é¥®é£Ÿä¸åŒï¼Œå®Œå…¨ç¬¦åˆä¸€ä¸ªåŸå¸‚äººå¯¹å†œæ‘çš„å°è±¡ã€‚å†œæ‘ç”Ÿæ´»è¿‡çš„æˆ‘è‡ªè®¤ä¸ºå¯¹ç¯å¢ƒè¦æ±‚ä¸é«˜ï¼Œåˆ°äº†è¿™é‡Œä¹Ÿéš¾å…æœ‰äº›çƒ¦é—·ã€‚<br>
<img src="https://i.loli.net/2021/09/24/1mYu6dJgSeHTXDx.jpg" alt="æ¸…æ²³æ‘å®Œå…¨å°å­¦çš„æ¸…æ™¨"> <img src="https://i.loli.net/2021/09/24/aDiCOMYG7mFnoRQ.jpg" alt="å±±">
â€ƒâ€ƒé—²æ—¶æ— äº‹ï¼Œæ£èµ·ç›¸æœºï¼Œæ²¿ç€æ–°ä¿®çš„é“è·¯åœ¨æ‘é‡Œæ¼«æ­¥ï¼Œæ‰å‘ç°è¿™é‡Œçš„ä¸€åˆ‡éƒ½ä¸æ˜¯æƒ³è±¡ä¸­çš„é‚£æ ·ã€‚é“è·¯ä¸Šæ‘©æ‰˜è½¦å’Œå¤§è´§è½¦ä¸æ–­ï¼Œå³ä½¿æ€¥è½¬æˆ–é™¡å¡ä¹Ÿéƒ½è½»æ¾é€šè¿‡ï¼Œå±±è·¯ä¸¤æ—éƒ½æ˜¯æ‘æ°‘ç§æ¤çš„èŒ¶æ ‘ï¼Œæ—¶ä¸æ—¶æœ‰ä¸ªæ–—ç¬ å†’å‡ºæ¥ï¼Œé‡‡æ‘˜ç€æœ€æ–°é²œçš„ä¸‰ç‰‡èŒ¶å¶ã€‚æ‘ä¸­é‚»é‡Œç›¸äº’ååˆ†ç†Ÿæ‚‰ï¼ŒæŠ±ç€å°å­©ï¼ŒèƒŒç€èœç­ï¼Œåœ¨æ‘å…¬æ‰€é—¨å£æ‘†ç€é¾™é—¨é˜µï¼Œçˆ½æœ—çš„ç¬‘å£°è€è¿œå¤–å°±èƒ½å¬åˆ°ã€‚æœ€è®©æˆ‘æ„å¤–çš„å°±æ˜¯è„±è´«æ´å»ºå»ºè®¾çš„ç½‘ç»œè®¾æ–½å·²ç»æˆä¸ºäº†æ‘æ°‘ä»¬æœ€ä½³çš„ä¼‘é—²æ–¹å¼ï¼Œåœ¨è·¯è¾¹æ—¶ä¸æ—¶å°±èƒ½å¬åˆ°çŸ­è§†é¢‘å¹³å°çš„ç¥æ›²ï¼Œæƒ³å¿…ä¸å°‘æ‘æ°‘ä¹Ÿæ˜¯æŸäº›å¹³å°çš„å¤§Vã€‚</p>
<p><img src="https://i.loli.net/2021/09/24/idPy38m9OIn6hea.jpg" alt="æ¸…æ²³æ‘çš„æ™šéœ"> <img src="https://i.loli.net/2021/09/24/qpxP5ImXbkTgFwz.jpg" alt="æ¸…æ²³æ‘çš„æ™šéœ"></p>
<p>â€ƒâ€ƒè¿™é‡Œç¦»å¤©å¾ˆè¿‘ï¼Œæˆ–è€…è¯´è¿™é‡Œå°±åœ¨æ‰€è°“çš„â€œå¤©ä¸Šâ€ï¼Œâ€œå¤©ä¸Šâ€å°å­¦çš„å­¦ç”Ÿè‡ªç„¶éƒ½æ˜¯â€œå¤©å…µå¤©å°†â€ã€‚è¿™æ¬¡æ¢¦æƒ³æ•™å®¤æ•™æˆçš„å¯¹è±¡æ˜¯å››å¹´çº§çš„å°å­¦ç”Ÿï¼Œè¿™å¤©æ—©ä¸Š8ç‚¹å¤šæˆ‘ä»¬è¿˜åœ¨ç¡¬æ¿åºŠä¸Šåšç€æ¢¦ï¼Œâ€œå¤©å…µå¤©å°†â€å·²ç»å†²è¿›äº†å¤§é—¨ï¼Œåœ¨æ°´æ³¥æ“åœºä¸Šæ’’æ¬¢äº†ã€‚å³ä½¿å¾ˆå¤šâ€œå¤©å…µå¤©å°†â€ç©¿ç€ç›¸åŒçš„â€œåˆ¶æœâ€å’Œâ€œç›”ç”²â€ï¼Œæ˜äº®çš„çœ¼ç¥å´åœ¨é»é»‘çš„çš®è‚¤ä¸­æ›´æ˜¾è€€çœ¼ã€‚æˆ–è®¸æ˜¯å¯¹æœªçŸ¥äº‹ç‰©çš„ä¸€ä¸ä¸ææƒ§ï¼Œæ¯å½“æˆ‘ç”¨é•œå¤´æƒ³è¦æ•æ‰åˆ°ä¸€å¼ å¼ ç¬‘è„¸æ—¶ï¼Œä»–ä»¬ä¼šç”¨è¿œè¶…æˆ‘æŒ‰ä¸‹å¿«é—¨çš„é€Ÿåº¦è¡¨æ¼”ä¸€ä¸ªå˜è„¸ï¼Œè¿…é€Ÿæ¿èµ·è¡¨æƒ…ï¼Œæˆ‘ä¹Ÿåªèƒ½æ‚»æ‚»åœ°æ”¾ä¸‹ç›¸æœºã€‚
<img src="https://i.loli.net/2021/09/24/d5Iw9AcqlbP6NyT.jpg" alt="å°å­¦">
â€ƒâ€ƒå¯¹ç›¸æœºæœ‰æ‰€é¡¾å¿Œçš„å­¦ç”Ÿä»¬å¯¹å¾…çŸ¥è¯†çš„æ€åº¦å°±å®Œå…¨ä¸åŒäº†ï¼Œå³ä½¿è¯¾ä¸Šå¸¸å¸¸æåˆ°é™Œç”Ÿçš„æ¦‚å¿µä»–ä»¬ä¹Ÿååˆ†æ„¿æ„è†å¬å­¦ä¹ ï¼Œå¸¸å¸¸æ˜¯ä¸€æé—®å°±å¥½å¤šåŒå°æ‰‹åœ¨ç©ºä¸­æŒ¥èˆã€‚ä¸Šè¿‡å‡ å¤©è¯¾åé€æ¸æœ‰å­¦ç”Ÿä¸æ€•æˆ‘çš„é•œå¤´äº†ï¼Œä¸‹è¯¾æœŸé—´å‡ ä¸ªå¥½äº‹çš„å°ç”·ç”Ÿä¸Šæ¥æ‘†å¼„æˆ‘è„šæ¶ä¸Šçš„ç›¸æœºå¿«é—¨ï¼Œå¸å¼•äº†å…¶ä»–åŒå­¦çš„æ³¨æ„ï¼Œâ€œå¤©å…µå¤©å°†â€ä¾¿çº·çº·åœ¨ç›¸æœºé‡Œç•™ä¸‹è‡ªå·±çš„é¬¼è„¸ã€‚æœ€åä¸€å¤©ï¼Œå°å­©å­ä»¬æ‹¿ç€çº¸ç¬”ä¸€ä¸ªä¸€ä¸ªé—®æˆ‘ä»¬çš„ç”µè¯å·ç ï¼Œçœ‹ç€ä¸€å¼ å¼ æœŸå¾…çš„å°è„¸ï¼Œä¸€ç¬é—´æˆ‘å°±æ‰­è¿‡äº†å¤´ï¼Œå±å®æ˜¯ä¸èƒ½è¢«çœ‹è§çœ¼çº¢å•Šã€‚<br>
<img src="https://i.loli.net/2021/09/24/KBYmuUxLbeMypRw.jpg" alt="å±±è·¯">
â€ƒâ€ƒæ€»æœ‰äººè¯´ï¼Œä¸è¦å»æ”¯æ•™ï¼Œå³ä½¿å»æ•™è¿™äº›å¤§å±±ä¸­çš„å­©å­ï¼Œç»™ä»–ä»¬çœ‹äº†å¤–ç•Œçš„ç¾å¥½ï¼Œä»–ä»¬ä¹Ÿèµ°ä¸å‡ºå»ï¼Œæˆ–æ˜¯å› ä¸ºèƒ½åŠ›ï¼Œæˆ–æ˜¯å› ä¸ºå®¶åº­ï¼Œæ”¯æ•™çš„æ•…äº‹åªæ˜¯ç»™ä»–ä»¬å¾’å¢çƒ¦æ¼ç½¢äº†ã€‚å¯¹å¾…çŸ­æœŸæ”¯æ•™ï¼Œæˆ‘æ›´æƒ³åšçš„æ˜¯ç»™ä»–ä»¬é€å»æ–°é²œçš„æ€æƒ³ï¼Œå‘Šè¯‰ä»–ä»¬â€œç»¿æ°´é’å±±å°±æ˜¯é‡‘å±±é“¶å±±â€ï¼Œå‘Šè¯‰ä»–ä»¬æ¢¦æƒ³ç»ä¸æ¸ºå°ï¼Œæ¢¦æƒ³æ°¸è¿œä¼Ÿå¤§ã€‚<br>
<img src="https://i.loli.net/2021/09/24/hnegQSNylC7tz25.jpg" alt="é“¶æ²³"></p>
<p>â€ƒâ€ƒæˆ‘ä»ä¸è®¤ä¸ºè‡ªå·±æ˜¯ä¸€ä¸ªè¿æ°”å¾ˆå¥½çš„äººï¼Œä½†æ˜¯æˆ‘ä¸ºèƒ½æ¥åˆ°è¿™åº§æ·±å±±ä¸­çš„å°å°æ‘åº„å€æ„Ÿè£å¹¸ã€‚<br>
<img src="https://i.loli.net/2021/09/24/AT6KXrjhfLvO7Rb.jpg" alt="æ‘é‡Œçš„å…”å…”"> <img src="https://i.loli.net/2021/09/24/BTdOIXhmJCYlViM.jpg" alt="é“¶æ²³"></p>
]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>æ”¯æ•™</tag>
        <tag>éšç¬”</tag>
      </tags>
  </entry>
  <entry>
    <title>çˆ±å¿«è·¯ç”±ä¸‹æ— æ³•æ­£å¸¸è§£æDNSçš„é—®é¢˜</title>
    <url>/2022/03/04/ai-kuai-lu-you-xia-wu-fa-zheng-chang-jie-xi-dns-de-wen-ti/</url>
    <content><![CDATA[<blockquote>
<p>æœ€åŸå§‹çš„é—®é¢˜æ˜¯å‘ç°300Mçš„ç”µä¿¡å®½å¸¦åœ¨ç»è¿‡è½¯è·¯ç”±åä¸‹è¡Œåªæœ‰30M,
è€Œä¸Šè¡Œè¿˜ä¿æŒæ­£å¸¸, åœ¨æ’æŸ¥ä¸­å‡ºç°äº†å¦å¤–çš„é—®é¢˜: ç›´è¿çˆ±å¿«è½¯è·¯ç”±DNSè§£æå¤±è´¥,
æœ¬æ–‡è§£å†³äº†è¿™ä¸¤ä¸ªé—®é¢˜</p>
</blockquote>
<p>å…ˆè¯´ç»“è®º:</p>
<p>åœ¨å®¢æˆ·æœºDNSæœåŠ¡å™¨è®¾ç½®ä¸ºç½‘å…³(ikuai)çš„æƒ…å†µä¸‹,
å¿…é¡»è®¾ç½®çˆ±å¿«çš„DNSåŠ é€ŸæœåŠ¡ä¸­ä½¿ç”¨ä»£ç†æ¨¡å¼æ‰èƒ½ç”Ÿæ•ˆ,
åŒæ—¶è¦å¼€å¯å¼ºåˆ¶å®¢æˆ·ç«¯DNSä»£ç†,
è€Œæ­¤æ—¶ä½¿ç”¨çˆ±å¿«çš„DNSç¼“å­˜æ¨¡å¼æ— æ³•æ­£å¸¸è§£æDNS</p>
<p><img src="https://s2.loli.net/2022/03/04/nbLDmNeuoryJIFv.png"></p>
<hr>
<p>ä»¥ä¸‹æ˜¯å®Œæ•´ç‰ˆ:</p>
<p>å®¶ä¸­ç¨³å®šè¿è¡ŒåŠå¹´çš„ç½‘ç»œé…ç½®å¦‚å›¾æ‰€ç¤º, å‡ºç°é—®é¢˜åå¼€å§‹æ’æŸ¥é—®é¢˜ä½ç½®</p>
<p>â‘ æŸ¥çœ‹æ˜¯å¦æ˜¯è¿è¥å•†é™åˆ¶äº†ä¸‹è¡Œå¸¦å®½:
æµ‹è¯•å®¶ä¸­ç½‘ç»œç¡¬è·¯ç”±éƒ¨åˆ†çš„é€Ÿç‡å‘ç°ä¸€åˆ‡æ­£å¸¸, æ‰€ä»¥é—®é¢˜å‡ºåœ¨è½¯è·¯ç”±</p>
<p>â‘¡é€ä¸ªæ’æŸ¥è½¯è·¯ç”±å†…å„éƒ¨åˆ†: ä¾æ¬¡å…³é—­adg, openwrtæ²¡æœ‰æ”¹å–„é—®é¢˜,
æ‰€ä»¥é—®é¢˜å¯èƒ½åœ¨ikuaiä¸Š</p>
<figure>
<img src="https://s2.loli.net/2022/03/04/7X6kQ9LiKyqpxIu.png" alt="å®¶ä¸­åŸå§‹ç½‘ç»œæ‹“æ‰‘å›¾, åˆ†ä¸ºç»è¿‡è½¯è·¯ç”±çš„æ”¹é€ éƒ¨åˆ†å’Œåˆå§‹è·¯ç”±å™¨éƒ¨åˆ†">
<figcaption aria-hidden="true">å®¶ä¸­åŸå§‹ç½‘ç»œæ‹“æ‰‘å›¾,
åˆ†ä¸ºç»è¿‡è½¯è·¯ç”±çš„æ”¹é€ éƒ¨åˆ†å’Œåˆå§‹è·¯ç”±å™¨éƒ¨åˆ†</figcaption>
</figure>
<p>å°†ç”µè„‘ç›´è¿ikuai, æ‰‹åŠ¨è®¾ç½®IP, DNSå’Œç½‘å…³å‡ä¸ºikuai,
åœ¨æœªåšå…¶ä»–ä¿®æ”¹çš„æƒ…å†µä¸‹å‡ºç°äº†æ— æ³•è§£æDNSçš„æƒ…å†µ</p>
<figure>
<img src="https://s2.loli.net/2022/03/04/qJOzB1orpgMm54n.png" alt="7X6kQ9LiKyqpxIu">
<figcaption aria-hidden="true">7X6kQ9LiKyqpxIu</figcaption>
</figure>
<blockquote>
<p>qqå’Œå¾®ä¿¡éƒ½æ˜¯ä¸éœ€è¦è§£æDNSçš„è½¯ä»¶,
å¦‚æœè¿™ä¸¤ä¸ªè½¯ä»¶èƒ½æ­£å¸¸ä½¿ç”¨è€Œç½‘é¡µæ— æ³•æ‰“å¼€å°±èƒ½ç¡®å®šDNSå‡ºé—®é¢˜</p>
</blockquote>
<p>å…ˆåä¿®æ”¹äº†ikuaiå’Œç”µè„‘çš„DNSæœåŠ¡å™¨, ä»openwrtå†…åˆ°ikuaiå†åˆ°é˜¿é‡Œè…¾è®¯,
å‡ä¸èƒ½æ­£å¸¸ä¸Šç½‘</p>
<figure>
<img src="https://s2.loli.net/2022/03/04/brmS398LFOdwzJC.jpg" alt="ikuaiå†…çš„è®¾ç½®, æ— æ³•è§£æDNS">
<figcaption aria-hidden="true">ikuaiå†…çš„è®¾ç½®, æ— æ³•è§£æDNS</figcaption>
</figure>
<p>ikuaiå†…çš„è®¾ç½®, æ— æ³•è§£æDNS</p>
<p>ç„¶åæ€€ç–‘æ˜¯ä¸æ˜¯ikuaiæœ¬èº«å°±æ— æ³•æ­£å¸¸ä¸Šç½‘,
ä½¿ç”¨ikuaiå†…çš„æµ‹è¯•å·¥å…·å‘ç°èƒ½å¤Ÿpingé€šåŸŸå</p>
<p><img src="https://s2.loli.net/2022/03/04/OAGZUVnaegkl3Xi.jpg"></p>
<p>åˆ°è¿™é‡Œå®Œå…¨æ²¡æœ‰æ€è·¯, ä¹‹å‰ä¹Ÿæ²¡è§è¿‡è·¯ç”±èƒ½è§£æDNSä½†ä¸»æœºä¸èƒ½çš„æƒ…å†µ,
åœ¨ç½‘ä¸Šå’Œè®ºå›æœç´¢äº†å¾ˆä¹…éƒ½æ²¡æœ‰æ‰¾åˆ°ç›¸å…³çš„æƒ…å†µ</p>
<p>æœ€åçš„æœ€ååœ¨ikuaiå®˜æ–¹çš„æ‰‹å†Œé‡Œæ‰¾åˆ°äº†ç­”æ¡ˆ</p>
<p><a href="https://www.ikuai8.com/index.php?option=com_content&amp;view=article&amp;id=129:dns&amp;catid=39&amp;Itemid=228">https://www.ikuai8.com/index.php?option=com_content&amp;view=article&amp;id=129:dns&amp;catid=39&amp;Itemid=228</a></p>
<p><img src="https://s2.loli.net/2022/03/04/r9JVAwTgPLbYpqu.jpg"></p>
<p>æ‰€ä»¥ä¿®æ”¹äº†ä»£ç†æ¨¡å¼, å¼€å¯äº†å¼ºåˆ¶ä»£ç†, é—®é¢˜è§£å†³</p>
<p><img src="https://s2.loli.net/2022/03/04/BHkuZeJ2OarSUNR.jpg"></p>
<blockquote>
<p>å›åˆ°æœ€åˆçš„é™é€Ÿé—®é¢˜,
ç»å†äº†iperfæµ‹é€Ÿç­‰9981ç§æ–¹æ³•ä¹Ÿæ²¡æœ‰å¤´ç»ªï¼Œæœ€åç«Ÿç„¶åœ¨V2ä¸Šæ‰¾åˆ°äº†åŒæ ·çš„ç—…å‹ï¼Œæœ€åæ˜¯ä¿®æ”¹äº†WiFiçš„ä¿¡é“å’Œå¸¦å®½...æœç„¶æ²¡å†å‡ºé—®é¢˜ï¼Œå¯èƒ½æ˜¯è¿‡äº†ä¸ªå¹´å‘¨å›´çš„é‚»å±…å˜å¤šäº†å§...</p>
</blockquote>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”Ÿæˆæ¨¡å‹ä¹‹Flow-based Model(1)å‰ç½®çŸ¥è¯†</title>
    <url>/2022/07/08/sheng-cheng-mo-xing-zhi-flow-based-model-1-qian-zhi-zhi-shi/</url>
    <content><![CDATA[<h1 id="flow-based-modelå‰ç½®çŸ¥è¯†">Flow-based Modelå‰ç½®çŸ¥è¯†</h1>
<blockquote>
<p>æµæ¨¡å‹æ˜¯æ•°å­¦ä¸Šä¸¥å¯†æ¨ç†å¾—åˆ°çš„æ¨¡å‹,æœ¬ç¯‡ä¸ºæ•°å­¦ä¸Šçš„å‰ç½®å†…å®¹</p>
</blockquote>
<h2 id="é›…å„æ¯”çŸ©é˜µ-jacobian-matrix">é›…å„æ¯”çŸ©é˜µ Jacobian Matrix</h2>
<p>å¯¹äºä¸¤ä¸ªçŸ©é˜µ<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span><br>
<span class="math display">\[z =
\left[\begin{matrix}z_{1}\\z_{2}\end{matrix}\right]\]</span> <span class="math display">\[x =
\left[\begin{matrix}x_{1}\\x_{2}\end{matrix}\right]\]</span></p>
<p><span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>ä¹‹é—´å­˜åœ¨å…³ç³»:<br>
<span class="math inline">\(x = f(z)\)</span>, <span class="math inline">\(z = f^{-1}(x)\)</span></p>
<p>Jacobian Matrixå®šä¹‰ä¸º:<br>
<span class="math display">\[
J_{f} = \left[ \begin{matrix}
\partial x_{1}/\partial z_{1} &amp;&amp; \partial x_{1}/\partial z_{2}
\\
\partial x_{2}/\partial z_{1} &amp;&amp; \partial x_{2}/\partial z_{2}
\end{matrix} \right]
\]</span></p>
<p><span class="math display">\[
J_{f^{-1}} = \left[ \begin{matrix}
\partial z_{1}/\partial x_{1} &amp;&amp; \partial z_{1}/\partial x_{2}
\\
\partial z_{2}/\partial x_{1} &amp;&amp; \partial z_{2}/\partial x_{2}
\end{matrix} \right]
\]</span></p>
<p><span class="math display">\[
J_{f}J_{f^{-1}}=1
\]</span></p>
<h2 id="è¡Œåˆ—å¼-determinant">è¡Œåˆ—å¼ Determinant</h2>
<p>å¯¹äºä¸€ä¸ªçŸ©é˜µ<span class="math inline">\(A\)</span><br>
<span class="math display">\[
A = \left[ \begin{matrix}a &amp;&amp; b\\c &amp;&amp;
d\end{matrix}\right]
\]</span> å…¶è¡Œåˆ—å¼ç»“æœä¸º:<br>
<span class="math display">\[
\det(A) = ad-bc
\]</span></p>
<p>å¯¹äºä¸€ä¸ªçŸ©é˜µ<span class="math inline">\(B\)</span><br>
<span class="math display">\[
B = \left[ \begin{matrix}a_{1} &amp;&amp; a_{2} &amp;&amp; a_{3}\\a_{4}
&amp;&amp; a_{5} &amp;&amp; a_{6}\\a_{7} &amp;&amp; a_{8} &amp;&amp;
a_{9}\end{matrix}\right]
\]</span> å…¶è¡Œåˆ—å¼ç»“æœä¸º:<br>
<span class="math display">\[
\det(B) =
a_{1}a_{5}a_{9}+a_{2}a_{6}a_{7}+a_{3}a_{4}a_{8}-a_{3}a_{5}a_{7}-a_{2}a_{4}a_{9}-a_{1}a_{6}a_{8}
\]</span></p>
<p>æœ‰å…¬å¼:<br>
<span class="math display">\[
\det (A) = \frac {1}{\det(A^{-1})}
\]</span></p>
<p><span class="math display">\[
\det (J_{f}) = \frac {1}{\det(J_{f^{-1})}}
\]</span></p>
<h2 id="å¯å˜ç†è®º-change-of-variable-theorem">å¯å˜ç†è®º change of variable
theorem</h2>
<p>å¯¹äºæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\pi(z)\)</span>å’Œæ¦‚ç‡åˆ†å¸ƒ<span class="math inline">\(p(x)\)</span><br>
å…¶ä¸­<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>æ»¡è¶³<span class="math inline">\(x=f(z)\)</span></p>
<h3 id="ä¸€ç»´å½¢å¼">ä¸€ç»´å½¢å¼</h3>
<p><span class="math display">\[ p(x&#39;)\Delta x = \pi (z&#39;)\Delta
z\]</span> <span class="math display">\[p(x&#39;) = \pi (z&#39;) |\frac
{\mathrm{d} z}{\mathrm{d} x}| \]</span></p>
<h3 id="äºŒç»´å½¢å¼">äºŒç»´å½¢å¼</h3>
<p><span class="math display">\[p(x&#39;)|det(J_f)|=\pi(z&#39;)\]</span>
<span class="math display">\[p(x&#39;) =
\pi(z&#39;)|det(J_{f^{-1}})|\]</span></p>
<h3 id="å¼•ç”³">å¼•ç”³</h3>
<p>å¦‚æœ<span class="math inline">\(x\)</span>å’Œ<span class="math inline">\(z\)</span>æ»¡è¶³<span class="math inline">\(x=f(z)\)</span>,åˆ™ä»–ä»¬çš„åˆ†å¸ƒä¹‹é—´å…³ç³»å°±æ˜¯ç›¸å·®<span class="math inline">\(|det(J_f)|\)</span></p>
<h2 id="ç”Ÿæˆå™¨generator">ç”Ÿæˆå™¨Generator</h2>
<p>å¯¹äºä¸€ä¸ªç½‘ç»œ<span class="math inline">\(G\)</span>,æˆ‘ä»¬å®šä¹‰ä»–çš„åˆ†å¸ƒä¸º<span class="math inline">\(P_{G}\)</span>,å¯¹äºçœŸå®æ ·æœ¬çš„åˆ†å¸ƒä¸º<span class="math inline">\(P_{data}\)</span><br>
å¯¹äºè¾“å…¥<span class="math inline">\(z\)</span>,ç»è¿‡ç”Ÿæˆå™¨å¾—åˆ°çš„ç»“æœä¸º<span class="math inline">\(x\)</span>,è®°ä¸º<span class="math inline">\(x=G(z)\)</span><br>
è¯´æ˜<span class="math inline">\(x\)</span>æœä»<span class="math inline">\(P_{G}(x)\)</span>åˆ†å¸ƒ
æ˜¾ç„¶ä¸€ä¸ªå¥½çš„ç”Ÿæˆå™¨åº”å½“ä½¿å¾—<span class="math inline">\(P_{G}(x)\)</span>æ¥è¿‘<span class="math inline">\(P_{data}(x)\)</span></p>
<p>å› æ­¤ç†è®ºä¸Šæœ‰æœ€ä¼˜ç”Ÿæˆå™¨<span class="math inline">\(G^{*}\)</span><br>
<span class="math inline">\(G^{*}= argmax_{G}
\sum\limits_{i=1}^{m}logP_{G}(x^{i})\)</span> å…¶ä¸­ <span class="math inline">\({x^i from P_{data}(x)}\)</span></p>
<p><span class="math inline">\(G^{*} \approx argmin_{G}KL(P_{data} ||
P_{G})\)</span><br>
(KLæ•£åº¦è¶Šå°,ä¸¤ä¸ªåˆ†å¸ƒè¶Šæ¥è¿‘)</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”Ÿæˆæ¨¡å‹ä¹‹Flow-based-Model(2)</title>
    <url>/2022/07/09/sheng-cheng-mo-xing-zhi-flow-based-model-2-liu-mo-xing-tui-dao/</url>
    <content><![CDATA[<h1 id="ç”Ÿæˆæ¨¡å‹flow-based-model2æµæ¨¡å‹">ç”Ÿæˆæ¨¡å‹Flow-Based
Modelï¼ˆ2ï¼‰æµæ¨¡å‹</h1>
<h2 id="æ¨å¯¼">æ¨å¯¼</h2>
<p>æ ¹æ®ç”Ÿæˆå™¨ç›¸å…³çŸ¥è¯†å¯çŸ¥ï¼šä¸€ä¸ªæœ€ä½³çš„ç”Ÿæˆå™¨<span class="math inline">\(G^{*}= argmax_{G}
\sum\limits_{i=1}^{m}logP_{G}(x^{i})\)</span></p>
<p>æ ¹æ®å¯å˜ç†è®ºæœ‰ï¼š<span class="math inline">\(P_G(x^i)=\pi(z^i)|\det(J_{G^{-1}})|\)</span>,
å…¶ä¸­<span class="math inline">\(z^i=G^{-1}(x^i)\)</span></p>
<p>ç­‰å·ä¸¤ä¾§å–å¯¹æ•°æœ‰: <span class="math inline">\(logP_G(x^i)=log\pi(G^{-1}(x^i))+log|\det(J_{G^{-1}}|\)</span></p>
<p>ç”±æ­¤å¾—åˆ°æœ€ä½³ç”Ÿæˆå™¨<span class="math inline">\(G^*\)</span>çš„å³å¼,
å³è®©<span class="math inline">\(logP_G(x^i)\)</span>æœ€å¤§,
ä¾¿å¾—åˆ°æœ€ä½³<span class="math inline">\(G^*\)</span></p>
<p>ç„¶è€Œ<span class="math inline">\(z^i=G^{-1}(x^i)\)</span>å¯¹<span class="math inline">\(G\)</span>æå‡ºäº†é™åˆ¶:</p>
<ol type="1">
<li><span class="math inline">\(\det(J_G)\)</span>éœ€è¦å¯è®¡ç®—</li>
<li><span class="math inline">\(G^{-1}\)</span>è¦æ±‚ç”Ÿæˆå™¨<span class="math inline">\(G\)</span>æœ¬èº«å¯é€†, è¾“å…¥è¾“å‡ºçš„å½¢çŠ¶ä¸€æ ·</li>
</ol>
<p>è§£å†³æ–¹æ³•: ä½¿ç”¨å¤šä¸ªç”Ÿæˆå™¨<span class="math inline">\(G\)</span>è¿ç»­ç”Ÿæˆ, ä»¥è¾¾åˆ°æ‹Ÿåˆ<span class="math inline">\(P_{data}\)</span>çš„ç›®çš„</p>
<h2 id="å¤šä¸ªç”Ÿæˆå™¨çš„æƒ…å†µ">å¤šä¸ªç”Ÿæˆå™¨çš„æƒ…å†µ</h2>
<p>å¯¹äºå¤šä¸ª<span class="math inline">\(G\)</span>çš„ç”Ÿæˆç»“æœæœ‰: <span class="math inline">\(\log(P_K(x^i))=log\pi(z^i)+\sum\limits_{i=1}^Klog|\det(J_{G_{K^{-1}}})|\)</span>,
å…¶ä¸­<span class="math inline">\(z^i=G_1^{-1}G_2^{-1}...G_K^{-1}(x^i)\)</span></p>
<blockquote>
<p>ä¾æ—§æ˜¯å–å·¦å¼æœ€å¤§</p>
</blockquote>
<h2 id="æµæ¨¡å‹å®è´¨">æµæ¨¡å‹å®è´¨</h2>
<p>ä»¥ä¸€ä¸ªç”Ÿæˆå™¨ä¸ºä¾‹:</p>
<pre><code class=" mermaid">graph LR
z --&gt; G --&gt; x
</code></pre>
<p><span class="math display">\[
logP_G(x^i)=log\pi(G^{-1}(x^i))+log|\det(J_{G^{-1}})|
\]</span></p>
<p>å‘ç°ä¸ºå¾—åˆ°å·¦å¼ä¸­çš„<span class="math inline">\(G\)</span>,
å³å¼åªæ˜¯ç”¨åˆ°äº†<span class="math inline">\(G^{-1}\)</span>,
å› æ­¤æˆ‘ä»¬ç›´æ¥è®­ç»ƒå‡º<span class="math inline">\(G^{-1}\)</span></p>
<pre><code class=" mermaid">graph RL
x --&gt; G-1 --&gt; z
</code></pre>
<p>å…¶ä¸­, <span class="math inline">\(x^i\)</span>æ˜¯ä»<span class="math inline">\(P_{data}(x)\)</span>ä¸­é‡‡æ ·çš„, <span class="math inline">\(z^i=G^{-1}(x^i)\)</span></p>
<p>æ¬²ä½¿å·¦å¼æœ€å¤§, å³ä¾§ä¸¤é¡¹åº”å°½å¯èƒ½å¤§</p>
<ul>
<li>å³ä¾§ç¬¬ä¸€é¡¹æ˜¯å¯¹æ•°å‡½æ•°, è€Œæ­£æ€åˆ†å¸ƒ<span class="math inline">\(\pi(z^i)\)</span>åœ¨<span class="math inline">\(z^i\)</span>ç­‰äº0å‘é‡æ—¶æœ€å¤§,
å› æ­¤å¯èƒ½å¯¼è‡´è®­ç»ƒå‡ºçš„<span class="math inline">\(G^{-1}\)</span>ä½¿æ‰€æœ‰ç”Ÿæˆçš„<span class="math inline">\(z^i\)</span>éƒ½ä¸ºé›¶å‘é‡, è¿›è€Œå¯¼è‡´<span class="math inline">\(J_{G^{-1}}\)</span>å˜æˆå…¨é›¶çŸ©é˜µ, è¡Œåˆ—å¼<span class="math inline">\(\det(J_{G^{-1}})\)</span>ä¹Ÿä¸º0,
æœ€ç»ˆå³ä¾§ç¬¬äºŒé¡¹å˜ä¸º<span class="math inline">\(-\inf\)</span></li>
</ul>
<p>æ‰€ä»¥æµæ¨¡å‹å®é™…ä¸Šåœ¨åšçš„äº‹æƒ…å°±æ˜¯: åœ¨ç¬¬ä¸€é¡¹è¶‹é›¶çš„æƒ…å†µä¸‹,
ä½¿ç”¨ç¬¬äºŒé¡¹çº¦æŸç»“æœé˜²æ­¢å…¨é›¶, æœ€ç»ˆå¾—åˆ°æœ€ä½³ç”Ÿæˆå™¨</p>
<h2 id="åº”ç”¨-coupling-layer">åº”ç”¨-Coupling Layer</h2>
<figure>
<img src="https://s2.loli.net/2022/07/10/pqBCRzcYLbiu2Uo.png" alt="coupling-layer">
<figcaption aria-hidden="true">coupling-layer</figcaption>
</figure>
<p>å·¦ä¾§ä¸º<span class="math inline">\(z^i\)</span>, å³ä¾§ä¸º<span class="math inline">\(x^i\)</span> <span class="math display">\[
\begin{equation}
\left\{
\begin{aligned}
z_{i\leq d}&amp;=x^i\\
z_{i &gt; d}&amp;=\frac {x^i-\gamma^i}{\beta^i}
\end{aligned}
\right.
\end{equation}
\]</span></p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>Deep Learning</tag>
      </tags>
  </entry>
  <entry>
    <title>ç”Ÿæˆæ¨¡å‹ä¹‹VAE</title>
    <url>/2022/08/02/sheng-cheng-mo-xing-zhi-vae/</url>
    <content><![CDATA[<h1 id="ç”Ÿæˆæ¨¡å‹ä¹‹variational-auto-encoder">ç”Ÿæˆæ¨¡å‹ä¹‹Variational
Auto-Encoder</h1>
<blockquote>
<p>æœ¬ç¯‡å†…å®¹ä¸»è¦å‚è€ƒå°å¤§æå®æ¯…æ•™æˆçš„è§†é¢‘ï¼Œä½œä¸ºç¬”è®°ä½¿ç”¨</p>
<p><a href="https://www.youtube.com/watch?v=3oHlf8-J3Nc">ã€æ©Ÿå™¨å­¸ç¿’2021ã€‘è‡ªç·¨ç¢¼å™¨
(Auto-encoder) (ä¸Š) - åŸºæœ¬æ¦‚å¿µ</a></p>
<p><a href="https://www.youtube.com/watch?v=8zomhgKrsmQ">ML Lecture 18:
Unsupervised Learning - Deep Generative Model (Part II)</a></p>
</blockquote>
<h1 id="auto-encoderè‡ªåŠ¨ç¼–ç å™¨">Auto-Encoderè‡ªåŠ¨ç¼–ç å™¨</h1>
<aside>
ğŸ’¡ å¯ä»¥è®¤ä¸ºæ˜¯è‡ªç›‘ç£å­¦ä¹ çš„ä¸€ç§æ–¹æ³•ï¼Œä¸éœ€è¦æ ‡æ³¨
</aside>
<h2 id="å‹ç¼©è‡ªåŠ¨ç¼–ç å™¨">å‹ç¼©è‡ªåŠ¨ç¼–ç å™¨</h2>
<pre><code class=" mermaid">graph LR
	é«˜ç»´å›¾ç‰‡ --&gt; NN-Encoder --&gt; ä½ç»´å‘é‡ --&gt; NN-Decoder--&gt; ç”Ÿæˆå›¾ --è¶Šæ¥è¿‘è¶Šå¥½--&gt;é«˜ç»´å›¾ç‰‡
</code></pre>
<h2 id="é™å™ªè‡ªåŠ¨ç¼–ç å™¨">é™å™ªè‡ªåŠ¨ç¼–ç å™¨</h2>
<pre><code class=" mermaid">graph LR
	åŸå›¾.-åŸå›¾+å™ªå£°
	åŸå›¾+å™ªå£° --&gt; NN-Encoder --&gt; ä½ç»´å‘é‡ --&gt; NN-Decoder--&gt; ç”Ÿæˆå›¾ --ä¸åŸå›¾è¶Šæ¥è¿‘è¶Šå¥½--&gt;åŸå›¾
	
</code></pre>
<h2 id="è§£ç¼ feature-disentangle">è§£ç¼ ï¼ˆFeature Disentangleï¼‰</h2>
<p>è¾“å…¥ä¿¡æ¯å¸¸å¸¸ç”±å„ç§ä¿¡æ¯çº ç¼ åœ¨ä¸€èµ·ï¼Œå¦‚</p>
<ul>
<li>å›¾ç‰‡ä¸­å­˜åœ¨ç‰©ä½“ã€çº¹ç†</li>
<li>å£°éŸ³ä¸­å­˜åœ¨æ–‡æœ¬å†…å®¹ã€è¯´è¯äººä¿¡æ¯</li>
<li>ä¸€å¥è¯åŒ…å«æ ¼å¼ã€è¯­æ³•</li>
<li>â€¦â€¦</li>
</ul>
<p>è¿™æ—¶å€™éœ€è¦é€šè¿‡è§£ç¼ å¾—åˆ°ä¸åŒç»´åº¦åŒ…å«çš„ä¿¡æ¯</p>
<p>åº”ç”¨ï¼šVoice Conversionè¯­è€…è½¬æ¢</p>
<h1 id="vaeå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨">VAEå˜åˆ†è‡ªåŠ¨ç¼–ç å™¨</h1>
<h2 id="aeå’ŒvaeåŒºåˆ«">AEå’ŒVAEåŒºåˆ«</h2>
<p>Auto-encoder</p>
<pre><code class=" mermaid">graph LR
  é«˜ç»´å›¾ç‰‡ --&gt; NN-Encoder --&gt; ä½ç»´å‘é‡ --&gt; NN-Decoder--&gt; ç”Ÿæˆå›¾
</code></pre>
<p>VAE</p>
<p>æ˜¯åœ¨è‡ªåŠ¨ç¼–ç å™¨çš„åŸºç¡€ä¸Šåšå˜åˆ†å¤„ç†ï¼Œä½¿ç¼–ç å™¨çš„è¾“å‡ºä¸ºç›®æ ‡åˆ†å¸ƒçš„å‡å€¼æ–¹å·®ã€‚</p>
<pre><code class=" mermaid">graph LR
  input --&gt; NN-Encoder --&gt; mu
	NN-Encoder --&gt; sigma
	sigma --exp--&gt; times((ç›¸ä¹˜))
	e --&gt; times
	mu --&gt; plus((ç›¸åŠ ))
	times --&gt;plus
	plus --&gt; z --&gt;

 NN-Decoder--&gt; output
</code></pre>
<p>å…¶ä¸­muã€sigmaã€eã€zå‡ä¸ºå‘é‡ï¼Œå¹¶ä¸”eå†…å…ƒç´ æœä»æ­£æ€åˆ†å¸ƒï¼Œ<span class="math inline">\(z_i=\exp(\sigma_i)\times e_i + \mu_i\)</span></p>
<p>muæ˜¯å‡å€¼ï¼Œeæ˜¯å™ªå£°ï¼Œsigmaä»£è¡¨å™ªå£°çš„å¤§å°å³varianceæ–¹å·®ï¼Œzå°±æ˜¯ç›®æ ‡æ¦‚ç‡åˆ†å¸ƒã€‚ä¸ºé¿å…varianceæ–¹å·®è¢«ç”Ÿæˆä¸º0ï¼Œå³æ²¡æœ‰å™ªå£°ï¼Œéœ€è¦åŠ ä¸Šé™åˆ¶æ¡ä»¶ã€‚</p>
<p>æ‰€ä»¥éœ€è¦æœ€å°åŒ–å¦‚ä¸‹å‡½æ•°ï¼š</p>
<p><span class="math display">\[
\min \sum \limits _{i=1} ^n (\exp(\sigma_i)-(1+\sigma_i)+\mu_i^2)
\]</span></p>
<h2 id="vaeæ¨å¯¼">VAEæ¨å¯¼</h2>
<h3 id="é«˜æ–¯æ··åˆæ¨¡å‹gmm">é«˜æ–¯æ··åˆæ¨¡å‹ï¼ˆGMMï¼‰</h3>
<blockquote>
<p>éƒ¨åˆ†å†…å®¹å‚è€ƒ</p>
<p><a href="http://www.gwylab.com/note-vae.html">ã€å­¦ä¹ ç¬”è®°ã€‘ç”Ÿæˆæ¨¡å‹--å˜åˆ†è‡ªç¼–ç å™¨</a></p>
</blockquote>
<p>é«˜æ–¯æ··åˆæ¨¡å‹æ˜¯å•ä¸€é«˜æ–¯æ¦‚ç‡å¯†åº¦å‡½æ•°çš„å»¶ä¼¸ï¼Œç”±äºGMMèƒ½å¤Ÿå¹³æ»‘çš„è¿‘ä¼¼ä»»æ„å½¢çŠ¶çš„å¯†åº¦åˆ†å¸ƒï¼Œå› æ­¤å¸¸ç”¨åœ¨è¯­éŸ³é¢†åŸŸã€‚</p>
<p>GMMçš„å·¥ä½œå°±æ˜¯å°†å¤æ‚çš„P(x)åˆ†å¸ƒå˜ä¸ºå¤šä¸ªé«˜æ–¯åˆ†å¸ƒçš„æ··åˆï¼Œå½“æ‹†åˆ†çš„è¶Šå¤šæ—¶ï¼Œè¶Šæ¥è¿‘åŸå§‹P(x)åˆ†å¸ƒã€‚</p>
<figure>
<img src="https://s2.loli.net/2022/08/02/JBOLqVHPE9yYFmQ.png" alt="é«˜æ–¯æ··åˆæ¨¡å‹ç¦»æ•£å˜é‡">
<figcaption aria-hidden="true">é«˜æ–¯æ··åˆæ¨¡å‹ç¦»æ•£å˜é‡</figcaption>
</figure>
<p><u>å¦‚æœç”¨æ¯ä¸€ç»„é«˜æ–¯åˆ†å¸ƒçš„å–å€¼ä½œä¸ºä¸€ä¸ªç»´åº¦ï¼Œå°±å¯ä»¥ç”¨mè¡¨ç¤ºç¬¬å‡ ä¸ªç»´åº¦ï¼Œå¦‚æœæœ‰512ç»´ï¼Œmçš„å–å€¼å°±æ˜¯1,2,3â€¦â€¦512</u></p>
<p>ä»å¤šé¡¹å¼åˆ†å¸ƒP(m)ä¸­é‡‡æ ·ä¸€ä¸ªæ•´æ•°mï¼Œè¡¨ç¤ºä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒ<span class="math inline">\(N(\mu^m,\sigma^m)\)</span>ï¼ŒP(x)å¯è¡¨ç¤ºä¸ºæ‰€æœ‰è¿™äº›é«˜æ–¯åˆ†å¸ƒçš„å’Œï¼š</p>
<p><span class="math display">\[
P(x)=\sum \limits _mP(m)P(x|m)
\]</span></p>
<p>å…¶ä¸­ï¼Œ<span class="math inline">\(m\sim P(m)\)</span>ï¼Œ<span class="math inline">\(x|m \sim N(\mu^m,\sigma^m)\)</span></p>
<p>ä¸è¿‡è¿™ç§æ··åˆæ–¹å¼æ˜¯ç¦»æ•£çš„ï¼Œè¿˜å­˜åœ¨å¤±çœŸçš„åœ°æ–¹ï¼Œäºæ˜¯æˆ‘ä»¬å°†å…¶è½¬åŒ–ä¸ºè¿ç»­çš„ã€‚</p>
<figure>
<img src="https://s2.loli.net/2022/08/02/zrjWQXFZgGVYfRP.png" alt="é«˜æ–¯æ··åˆæ¨¡å‹è¿ç»­å˜é‡">
<figcaption aria-hidden="true">é«˜æ–¯æ··åˆæ¨¡å‹è¿ç»­å˜é‡</figcaption>
</figure>
<p>ç°åœ¨å°†ç¦»æ•£å˜é‡mæ”¹ä¸ºè¿ç»­å˜é‡zï¼Œä¾æ—§æ˜¯zçš„æŸä¸€ä¸ªå–å€¼å¯¹åº”ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒã€‚</p>
<aside>
ğŸ’¡
ä¸ç¦»æ•£çš„GMMä¸åŒç‚¹åœ¨äºï¼Œæ­¤æ—¶æˆ‘ä»¬ä¸èƒ½ç›´æ¥å¾—åˆ°zæ‰€å¯¹åº”çš„é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼å’Œæ–¹å·®ï¼Œå› ä¸ºzæœ‰æ— æ•°ä¸ªå–å€¼æ— æ³•ç©·å°½ã€‚
</aside>
<p><span class="math inline">\(z\sim N(0,I)\)</span>ï¼Œ<span class="math inline">\(x|z\sim N(\mu(z),\sigma(z))\)</span>ï¼Œå…¶ä¸­<span class="math inline">\(\mu\)</span>æ˜¯å¾—åˆ°zå‡å€¼çš„å‡½æ•°ï¼Œ<span class="math inline">\(\sigma\)</span>æ˜¯å¾—åˆ°zæ–¹å·®çš„å‡½æ•°ã€‚</p>
<p>äºæ˜¯P(x)çš„åˆ†å¸ƒå°±å¯ä»¥è¡¨ç¤ºä¸º:</p>
<p><span class="math display">\[
P(x)=\int\limits _zP(z)P(x|z)dz
\]</span></p>
<p>æ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡å°±å˜æˆæ±‚è§£ä¸Šé¢è¿™ä¸ªå…¬å¼ã€‚</p>
<h3 id="æ±‚è§£ç›®æ ‡å…¬å¼">æ±‚è§£ç›®æ ‡å…¬å¼</h3>
<p><span class="math display">\[
P(x)=\int\limits _zP(z)P(x|z)dz
\]</span></p>
<p>å…¶ä¸­<span class="math inline">\(P(z)\)</span>å·²çŸ¥ï¼Œ<span class="math inline">\(P(x|z)\)</span>æœªçŸ¥ï¼Œ<span class="math inline">\(P(x|z)\)</span>ä¸­<span class="math inline">\(x|z\sim
N(\mu(z),\sigma(z))\)</span>ï¼Œæ‰€ä»¥æ±‚<strong>è§£<span class="math inline">\(P(x|z)\)</span>è½¬æ¢ä¸ºæ±‚è§£<span class="math inline">\(\mu,\sigma\)</span>ä¸¤ä¸ªå‡½æ•°çš„è¡¨è¾¾å¼</strong>ã€‚</p>
<p><strong>å¦‚ä½•æ±‚è§£<span class="math inline">\(\mu,\sigma\)</span>å‡½æ•°?ä½¿ç”¨ç¥ç»ç½‘ç»œ!</strong></p>
<pre><code class=" mermaid">graph LR
	z --&gt; NN-Decoder --&gt; mu
	NN-Decoder --&gt; sigma
</code></pre>
<p>åŒæ—¶æˆ‘ä»¬å†åŠ ä¸Šä¸€ä¸ª<strong>æ–°çš„å‡½æ•°<span class="math inline">\(q(z|x)\)</span></strong>ç”¨æ¥è¡¨ç¤ºä»»æ„é«˜æ–¯åˆ†å¸ƒï¼Œå…¶ä¸­<span class="math inline">\(z|x \sim
N(\mu&#39;(x),\sigma&#39;(x))\)</span>ï¼Œè¡¨ç¤ºå¯¹äºä¸€ä¸ªè¾“å…¥çš„xï¼Œèƒ½å¤Ÿå¾—åˆ°ä¸€å¯¹å‡å€¼å’Œæ–¹å·®ï¼Œç”¨äºç”Ÿæˆzçš„æ¦‚ç‡åˆ†å¸ƒã€‚</p>
<pre><code class=" mermaid">graph LR
  x --&gt; NN-Encoder --&gt; mu&#x27;
	NN-Encoder --&gt; sigma&#x27;
</code></pre>
<p>å› ä¸ºå®é™…ä¸Šæˆ‘ä»¬æœ‰æ•°æ®xï¼Œç°åœ¨æ˜¯åœ¨æ±‚è§£å‚æ•°ï¼Œæ‰€ä»¥éœ€è¦æ±‚<span class="math inline">\(P(x)\)</span>çš„æœ€å¤§ä¼¼ç„¶å‡½æ•°<span class="math inline">\(L=\sum \limits _x \log P(x)\)</span></p>
<ul>
<li><strong>æœ€å¤§ä¼¼ç„¶ä¼°è®¡(MLE):</strong>åœ¨â€æ¨¡å‹å·²å®š,å‚æ•°<span class="math inline">\(\theta\)</span>æœªçŸ¥â€çš„æƒ…å†µä¸‹,é€šè¿‡è§‚æµ‹æ•°æ®æ¥ä¼°è®¡æœªçŸ¥å‚æ•°<span class="math inline">\(\theta\)</span>çš„ä¸€ç§æ–¹æ³•,è¦æ±‚æ‰€æœ‰é‡‡æ ·éƒ½æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒ.
<ul>
<li>Note:æœ€å¤§ä¼¼ç„¶ä¼°è®¡çš„ä½¿ç”¨
<ol type="1">
<li>å†™å‡ºä¼¼ç„¶å‡½æ•°</li>
<li>å¯¹ä¼¼ç„¶å‡½æ•°å–å¯¹æ•°</li>
<li>ä¸¤è¾¹åŒæ—¶æ±‚å¯¼(å¤šä¸ªå˜é‡å°±æ±‚åå¯¼)</li>
<li>ä»¤å¯¼æ•°ä¸º0,è§£å‡ºä¼¼ç„¶æ–¹ç¨‹</li>
</ol>
<ul>
<li><p>ä¾‹å­</p>
<figure>
<img src="/2022/08/02/sheng-cheng-mo-xing-zhi-vae/Untitled.png" alt="æœ€å¤§ä¼¼ç„¶å‡½æ•°ä¾‹é¢˜">
<figcaption aria-hidden="true">æœ€å¤§ä¼¼ç„¶å‡½æ•°ä¾‹é¢˜</figcaption>
</figure>
<figure>
<img src="https://s2.loli.net/2022/08/02/X48H3Blukqw15Op.png" alt="ä¾‹é¢˜è§£ç­”">
<figcaption aria-hidden="true">ä¾‹é¢˜è§£ç­”</figcaption>
</figure></li>
</ul></li>
</ul></li>
</ul>
<p>ç”±äº<span class="math inline">\(q(z|x)\)</span>æ˜¯ä¸€ä¸ªä»»æ„çš„é«˜æ–¯åˆ†å¸ƒï¼Œäºæ˜¯æœ‰<span class="math inline">\(\int \limits _z
q(z|x)dz=1\)</span>ï¼Œè¡¨ç¤ºæ•´ä¸ªé«˜æ–¯åˆ†å¸ƒçš„é¢ç§¯ä¸º1ã€‚</p>
<p><span class="math display">\[
\begin{aligned}
\log P(x) &amp;=\int \limits _zq(z|x)\log P(x)dz \\ &amp;=\int \limits
_zq(z|x)\log \big(\frac{P(x|z)P(z)}{P(z|x)}\big)dz \\
&amp;=\int \limits _zq(z|x)\log
(\frac{P(x|z)P(z)}{q(z|x)}\cdot\frac{q(z|x)}{p(z|x)})dz \\
&amp;= \int \limits _zq(z|x)\log(\frac{P(x|z)P(z)}{q(z|x)})dz + \int
\limits _zq(z|x)\log(\frac{q(z|x)}{P(z|x)})dz \\
&amp;= \int \limits _zq(z|x)\log(\frac{P(x|z)P(z)}{q(z|x)})dz
+KL(q(z|x)||P(z|x))
\end{aligned}
\]</span></p>
<p>æœ€åå¾—åˆ°ä¸¤é¡¹ï¼Œç¬¬äºŒé¡¹KLæ•£åº¦éè´Ÿï¼Œæ‰€ä»¥ç¬¬ä¸€é¡¹å°±æ˜¯ç»“æœçš„ä¸‹ç•Œ<span class="math inline">\(L_b\)</span></p>
<p><span class="math display">\[
\log P(x) \geqslant \int \limits _z
q(z|x)\log(\frac{P(x|z)P(z)}{q(z|x)})dz
\]</span></p>
<p><span class="math display">\[
\log P(x) = L_b+KL(q(z|x)||P(z|x))
\]</span></p>
<p>è¿™é‡Œå°†åŸæœ¬çš„é—®é¢˜ï¼šæ±‚<span class="math inline">\(P(x|z)\)</span>ä½¿å¾—<span class="math inline">\(\log P(x)\)</span>æœ€å¤§åŒ–</p>
<p>è½¬æ¢ä¸ºäº†<strong>æ–°çš„é—®é¢˜</strong>ï¼š<strong>æ±‚P(x|z)å’Œq(z|x)ä½¿å¾—<span class="math inline">\(\log P(x)\)</span>æœ€å¤§åŒ–</strong></p>
<p>çœ‹èµ·æ¥åƒæ˜¯å¤šäº†ä¸€ä¸ª<span class="math inline">\(q(z|x)\)</span>ï¼Œå…¶å®ä¸ç„¶ï¼Œæˆ‘ä»¬å¼€å§‹è§‚å¯Ÿ<span class="math inline">\(\log P(x)\)</span>è·Ÿè¿™ä¸¤é¡¹çš„å…³ç³»ï¼š</p>
<figure>
<img src="https://s2.loli.net/2022/08/02/CZJpxOlEad8nNh3.jpg" alt="logP(x)å’Œæ–°é—®é¢˜çš„å…³ç³»">
<figcaption aria-hidden="true">logP(x)å’Œæ–°é—®é¢˜çš„å…³ç³»</figcaption>
</figure>
<p>æ ¹æ®<span class="math inline">\(P(x)=\int\limits
_zP(z)P(x|z)dz\)</span>:</p>
<p>å½“æˆ‘ä»¬ä¿æŒ<span class="math inline">\(P(x|z)\)</span>ä¸å˜æ—¶ï¼Œ<span class="math inline">\(P(z)\)</span>ä¸ä¼šå˜ï¼Œ<span class="math inline">\(P(x)\)</span>ä¹Ÿä¸ä¼šå˜ï¼Œ<span class="math inline">\(\log P(x)\)</span>ä¹Ÿä¸ä¼šå˜</p>
<p>å†æ ¹æ®<span class="math inline">\(\log P(x) =
L_b+KL(q(z|x)||P(z|x))\)</span>ï¼š</p>
<p>æ•´ä¸ª<span class="math inline">\(\log P(x)\)</span>çš„å¤§å°ä¸å˜ï¼Œ<span class="math inline">\(L_b\)</span>è¶Šå¤§ï¼ŒKLæ•£åº¦è¶Šå°ï¼Œå½“KLæ•£åº¦å‡å°åˆ°é›¶æ—¶ï¼Œ<span class="math inline">\(\log P(x)=L_b\)</span>ï¼Œ<strong>è€Œ<span class="math inline">\(L_b\)</span>æ­¤æ—¶åªå’Œ<span class="math inline">\(q(z|x)\)</span>æœ‰å…³ã€‚</strong></p>
<p>æ­¤æ—¶æˆ‘ä»¬å‘ç°ï¼š</p>
<p>æ±‚<span class="math inline">\(\max \log P(x)\)</span>ç­‰ä»·äºæ±‚<span class="math inline">\(\max L_b\)</span></p>
<aside>
ğŸ’¡ å®è§‚ä¸Šæˆ‘ä»¬å¯ä»¥å°†æ­¤æ—¶çš„VAEç†è§£ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š è°ƒèŠ‚<span class="math inline">\(P(x|z)\)</span>ï¼Œå°±æ˜¯åœ¨è°ƒèŠ‚NN-Decoder è°ƒèŠ‚<span class="math inline">\(q(z|x)\)</span>ï¼Œå°±æ˜¯åœ¨è°ƒèŠ‚NN-Encoder
</aside>
<blockquote>
<p>VAEç®—æ³•ï¼šDecoderæ¯æ”¹è¿›ä¸€æ¬¡ï¼ŒEncoderå°±è°ƒèŠ‚æˆä¸å…¶ä¸€è‡´ï¼Œåˆ©ç”¨çº¦æŸæ¡ä»¶é€¼è¿«Decoderå‰è¿›</p>
</blockquote>
<p>å¼€å§‹æ±‚è§£<span class="math inline">\(\max L_b\)</span></p>
<p><span class="math display">\[
\begin{aligned}
L_b &amp;= \int \limits _zq(z|x)\log (\frac {P(x|z)P(z)}{q(z|x)})dz \\
&amp;= \int \limits _zq(z|x)\log (\frac {P(z)}{q(z|x)})dz + \int \limits
_zq(z|x)\log P(x|z)dz \\
&amp;=-KL(q(z|x)||P(z))+\int \limits _zq(z|x)\log P(x|z)dz
\end{aligned}
\]</span></p>
<p>è®°ç¬¬ä¸€é¡¹ä¸ºAï¼Œç¬¬äºŒé¡¹ä¸ºBï¼Œç°åœ¨æ±‚è§£<span class="math inline">\(L_b\)</span>çš„æœ€å¤§å€¼ï¼Œéœ€è¦æ±‚Açš„æœ€å¤§å€¼ï¼ˆKLæ•£åº¦çš„æœ€å°å€¼ï¼‰ï¼ŒBçš„æœ€å¤§å€¼</p>
<p>å±•å¼€Aåå¯ä»¥å¾—åˆ°çº¦æŸé¡¹ï¼š<span class="math inline">\(\min \sum \limits
_{i=1} ^n
(\exp(\sigma_i)-(1+\sigma_i)+\mu_i^2)\)</span>ï¼Œè¯æ˜æ–¹æ³•æ¥è‡ªVAEåŸè®ºæ–‡ã€ŠAuto-Encoding
Variational Bayesã€‹</p>
<p>æ±‚Bçš„æœ€å¤§å€¼ï¼š</p>
<p><span class="math display">\[
\max B = \max E_{q(z|x)}[\log P(x|z)]
\]</span></p>
<p>å¯ç†è§£ä¸º<strong>æä¾›ä¸€ä¸ªxçš„å€¼ï¼Œåœ¨<span class="math inline">\(q(z|x)\)</span>è¿™ä¸ªåˆ†å¸ƒä¸‹ï¼Œè®©<span class="math inline">\(\log
P(x|z)\)</span>å€¼è¶Šå¤§è¶Šå¥½ï¼Œè¿™ä»¶äº‹æƒ…å°±æ˜¯NN-Encoderåœ¨åšçš„ã€‚</strong></p>
<pre><code class=" mermaid">graph LR
  x --&gt; NN-Encoder --&gt; mu&#x27;
	NN-Encoder --&gt; sigma&#x27;
	mu&#x27;--&gt;z
	sigma&#x27;--&gt;z
	z--&gt;NN-Decoder--&gt;mu
	NN-Decoder--&gt;sigma
	mu .-è¶Šæ¥è¿‘è¶Šå¥½.-&gt; x

</code></pre>
<p>VAEçš„æŸå¤±å‡½æ•°çš„ä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯é‡å»ºæŸå¤±ï¼ŒäºŒæ˜¯çº¦æŸé¡¹ã€‚</p>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>DL</tag>
        <tag>VAE</tag>
        <tag>ç”Ÿæˆæ¨¡å‹</tag>
      </tags>
  </entry>
  <entry>
    <title>ç¥ç»ç½‘ç»œä¸­çš„ä¼˜åŒ–ç®—æ³•å’Œæ­£åˆ™åŒ–é—®é¢˜</title>
    <url>/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/</url>
    <content><![CDATA[<blockquote>
<p>æœ¬æ–‡ä¸»è¦å‚è€ƒé‚±é”¡é¹è€å¸ˆçš„nndl-bookï¼Œä½œä¸ºç¬”è®°ä½¿ç”¨</p>
<p><a href="https://www.bilibili.com/video/BV19u411d7r3">ç¥ç»ç½‘ç»œä¸æ·±åº¦å­¦ä¹ ï¼ˆç¬¬7-10è®²ï¼‰ï¼ˆæ›´æ–°è‡³ï¼šç¬¬9è®²
æ— ç›‘ç£å­¦ä¹ ï¼‰_å“”å“©å“”å“©_bilibili</a></p>
</blockquote>
<h1 id="éå‡¸ä¼˜åŒ–é—®é¢˜">éå‡¸ä¼˜åŒ–é—®é¢˜</h1>
<p>é«˜ç»´ç©ºé—´ä¸­å¸¸å¸¸é‡åˆ°çš„éƒ½æ˜¯éå‡¸å‡½æ•°</p>
<p>éå‡¸ä¼˜åŒ–é—®é¢˜ä¸­éš¾ç‚¹æœ‰ï¼š</p>
<ul>
<li>å¦‚ä½•é€ƒç¦»éç‚¹</li>
<li>ä¼šå‡ºç°å¹³å¦æœ€å°å€¼</li>
</ul>
<h2 id="éç‚¹">éç‚¹</h2>
<p>åœ¨æŸäº›ç»´åº¦ä¸Šæ˜¯æœ€é«˜ç‚¹,å¦ä¸€äº›ç»´åº¦ä¸Šæ˜¯æœ€ä½ç‚¹.å…¶ä¸€é˜¶å¯¼æ•°ä¸º0,äºŒé˜¶æ¢¯åº¦HessiançŸ©é˜µä¸æ˜¯åŠæ­£å®šçŸ©é˜µ.</p>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled.png" alt="éç‚¹ç¤ºä¾‹">
<figcaption aria-hidden="true">éç‚¹ç¤ºä¾‹</figcaption>
</figure>
<h2 id="å¹³å¦æœ€å°å€¼">å¹³å¦æœ€å°å€¼</h2>
<blockquote>
<p>ç”±äºDLä¸­çš„å‚æ•°éå¸¸å¤šä¸”å…·æœ‰å†—ä½™,å•ä¸ªå‚æ•°å¯¹æœ€ç»ˆçš„æŸå¤±å½±å“æ¯”è¾ƒå°,è¿™ä¼šå¯¼è‡´æŸå¤±å‡½æ•°åœ¨å±€éƒ¨æœ€å°è§£é™„è¿‘é€šå¸¸æ˜¯ä¸€ä¸ªå¹³å¦çš„åŒºåŸŸ</p>
</blockquote>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%201.png" alt="å¹³å¦æœ€å°å€¼å’Œå°–é”æœ€å°å€¼">
<figcaption aria-hidden="true">å¹³å¦æœ€å°å€¼å’Œå°–é”æœ€å°å€¼</figcaption>
</figure>
<ul>
<li>ä¸€ä¸ªå¹³å¦æœ€å°å€¼çš„é‚»åŸŸå†…,æ‰€æœ‰ç‚¹å¯¹åº”çš„è®­ç»ƒæŸå¤±éƒ½æ¯”è¾ƒæ¥è¿‘</li>
<li>å¤§éƒ¨åˆ†å±€éƒ¨æœ€å°è§£æ˜¯ç­‰ä»·çš„</li>
<li>å±€éƒ¨æœ€å°è§£å¯¹åº”çš„è®­ç»ƒæŸå¤±æœ‰å¯èƒ½éå¸¸æ¥è¿‘äºå…¨å±€æœ€å°è§£è®­ç»ƒæŸå¤±</li>
</ul>
<aside>
ğŸ’¡
åœ¨è®­ç»ƒç¥ç»ç½‘ç»œæ—¶,å¯ä»¥ç”¨å±€éƒ¨æœ€å°è§£ä»£æ›¿å…¨å±€æœ€ä¼˜è§£,ä»¥é˜²æ­¢è¿‡æ‹Ÿåˆ,é²æ£’æ€§æ›´å¥½
</aside>
<h1 id="ç¥ç»ç½‘ç»œä¼˜åŒ–ç®—æ³•">ç¥ç»ç½‘ç»œä¼˜åŒ–ç®—æ³•</h1>
<h2 id="éšæœºæ¢¯åº¦ä¸‹é™æ³•sgd">éšæœºæ¢¯åº¦ä¸‹é™æ³•(SGD)</h2>
<p>å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™,æ¯æ¬¡é€‰æ‹©kä¸ªæ ·æœ¬è®¡ç®—åå¯¼æ•°çš„å¹³å‡æ•°,ç„¶ååœ¨æ¢¯åº¦åå‘ä¸Šæ›´æ–°å‚æ•°</p>
<h2 id="æ‰¹é‡å¤§å°è°ƒæ•´">æ‰¹é‡å¤§å°è°ƒæ•´</h2>
<p>ä¸å½±å“æ¢¯åº¦çš„æœŸæœ›,ä½†ä¼šå½±å“æ–¹å·®.</p>
<ul>
<li><p>batchè¶Šå¤§,æ–¹å·®è¶Šå°,å­¦ä¹ ç‡éœ€è¦è®¾ç½®è¾ƒå¤§</p></li>
<li><p>batchè¶Šå°,éœ€è¦è®¾ç½®è¾ƒå°çš„å­¦ä¹ ç‡,å¦åˆ™æ¨¡å‹ä¸ä¼šæ”¶æ•›</p></li>
<li><p>NOTE:batchå’Œå­¦ä¹ ç‡å¯éµå®ˆçº¿æ€§ç¼©æ”¾åŸåˆ™</p>
<p>batchå˜ä¸ºmå€,å­¦ä¹ ç‡å˜ä¸º<span class="math inline">\(1/m\)</span></p></li>
</ul>
<aside>
ğŸ’¡
batchè¶Šå¤§é€šå¸¸è®­ç»ƒçš„æ•ˆç‡è¶Šé«˜,batchè¶Šå°ç”±äºéšæœºæ€§æ›´é«˜,å¯èƒ½ä¼šè·å¾—æ›´å¥½çš„æ³›åŒ–èƒ½åŠ›
</aside>
<h2 id="æ¢¯åº¦ä¼°è®¡ä¿®æ­£">æ¢¯åº¦ä¼°è®¡ä¿®æ­£</h2>
<ul>
<li><p>Momentum Method åŠ¨é‡æ³•</p>
<p>ç”¨ä¹‹å‰ç´¯ç§¯çš„åŠ¨é‡æ¥ä»£æ›¿çœŸæ­£çš„æ¢¯åº¦ï¼ˆè´Ÿæ¢¯åº¦çš„åŠ æƒç§»åŠ¨å¹³å‡ï¼‰</p>
<aside>
<p>ğŸ’¡ æ¯æ¬¡çš„è¿­ä»£æ–¹å‘ç›¸å½“äºåŠ é€Ÿåº¦ï¼Œç±»ä¼¼äºŒé˜¶æ¢¯åº¦</p>
</aside>
<p>å‚æ•°æ›´æ–°çš„å·®å€¼ä¸ºï¼š</p>
<p><span class="math display">\[
  \Delta \theta_t =\rho \Delta \theta_{t-1}-\alpha g_t=-\alpha \sum
\limits _{\tau=1}^{t} \rho^{t-\tau}g_{\tau}
  \]</span></p></li>
<li><p>Nesterov åŠ é€Ÿæ¢¯åº¦</p></li>
<li><p>æ¢¯åº¦æˆªæ–­</p>
<p>å½“æŸä¸ªæ—¶åˆ»æ¢¯åº¦ï¼ˆçš„æ¨¡ï¼‰è¿‡å¤§å¦‚NaNï¼Œå°±æŠŠæ¢¯åº¦çš„æ¨¡é™å®šåœ¨æŸä¸ªåŒºé—´ï¼Œå°†è¶…è¿‡åŒºé—´çš„éƒ¨åˆ†è¿›è¡Œæˆªæ–­</p>
<ul>
<li><p>æŒ‰å€¼æˆªæ–­</p>
<p>ä¾‹å¦‚å–<span class="math inline">\([a,b]\)</span>åŒºé—´çš„å€¼</p>
<p><span class="math display">\[
  g_t=\max(\min(g_t,b),a)
  \]</span></p></li>
<li><p>æŒ‰æ¨¡æˆªæ–­</p>
<p>æŠŠæ¨¡çš„æœ€å¤§å€¼é™å®šä¸ºb</p>
<p><span class="math display">\[
  g_t=\frac{b}{||g_t||}g_t
  \]</span></p></li>
</ul></li>
<li><p>Adamç®—æ³•</p>
<p>ä½¿ç”¨åŠ¨é‡æ³•ä¼˜åŒ–æ¢¯åº¦ï¼ŒåŠ ä¸ŠRMSpropè‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡</p>
<p>å…ˆè®¡ç®—ä¸¤ä¸ªç§»åŠ¨å¹³å‡ï¼š</p>
<p><span class="math display">\[
  M_t = \beta _1M_{t-1}+(1-\beta_1)g_t
  \]</span></p>
<p><span class="math display">\[
  G_t = \beta_2G_{t-1}+(1-\beta_2)g_t \odot g_t
  \]</span></p>
<p>å½“t=1æ—¶ï¼Œ<span class="math inline">\(M_1\)</span>åº”è¯¥ç­‰äº<span class="math inline">\(g_1\)</span>ï¼Œä½†æ˜¯åœ¨ä¸Šè¿°å…¬å¼ä¸­ä¸æ­£ç¡®ï¼Œäºæ˜¯åŠ å…¥åå·®ä¿®æ­£å¦‚ä¸‹ï¼š</p>
<p><span class="math display">\[
  \hat M_t = \frac {M_t}{1-\beta_1^t}
  \]</span></p>
<p><span class="math display">\[
  \hat G_t=\frac{G_t}{1-\beta_2^t}
  \]</span></p>
<p>æ›´æ–°å‚æ•°å†…å®¹ï¼š</p>
<p><span class="math display">\[
  \Delta \theta_t = - \frac{\alpha}{\sqrt {G_t+\epsilon}}\hat M_t
  \]</span></p></li>
</ul>
<h2 id="å­¦ä¹ ç‡è°ƒæ•´">å­¦ä¹ ç‡è°ƒæ•´</h2>
<ul>
<li><p>å­¦ä¹ ç‡è¡°å‡</p>
<ul>
<li>é˜¶æ¢¯è¡°å‡</li>
<li>é€†æ—¶è¡°å‡:<span class="math inline">\(\alpha_t = \alpha_0
\frac{1}{1+\beta \times t}\)</span></li>
<li>æŒ‡æ•°è¡°å‡</li>
<li>ä½™å¼¦è¡°å‡</li>
</ul></li>
<li><p>å‘¨æœŸæ€§å­¦ä¹ ç‡è°ƒæ•´</p>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%202.png" alt="å‘¨æœŸæ€§å­¦ä¹ ç‡è°ƒæ•´">
<figcaption aria-hidden="true">å‘¨æœŸæ€§å­¦ä¹ ç‡è°ƒæ•´</figcaption>
</figure>
<p>è·³å‡ºå±€éƒ¨æœ€ä¼˜æˆ–éç‚¹çš„æƒ…å†µ,æ‰¾åˆ°æ›´å¹³å¦çš„å±€éƒ¨æœ€ä¼˜</p></li>
<li><p>å­¦ä¹ ç‡é¢„çƒ­</p>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%203.png" alt="å­¦ä¹ ç‡é¢„çƒ­ç¤ºä¾‹">
<figcaption aria-hidden="true">å­¦ä¹ ç‡é¢„çƒ­ç¤ºä¾‹</figcaption>
</figure></li>
<li><p>AdaGradç®—æ³•</p>
<p>å€Ÿé‰´L2æ­£åˆ™åŒ–çš„æ€æƒ³ï¼Œåœ¨ç¬¬tæ¬¡è¿­ä»£çš„æ—¶å€™ï¼Œå…ˆè®¡ç®—æ¯ä¸ªå‚æ•°æ¢¯åº¦å¹³æ–¹çš„ç´¯è®¡å€¼ã€‚</p>
<p><span class="math display">\[
  G_t=\sum \limits _{\tau}^{t}g_{\tau}\odot g_{\tau}
  \]</span></p>
<p>å‚æ•°æ›´æ–°çš„å·®å€¼ä¸ºï¼š</p>
<p><span class="math display">\[
  \Delta \theta _{t} = - \frac {\alpha}{\sqrt {G_t+\epsilon}}\odot g_t
  \]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\alpha\)</span>æ˜¯åˆå§‹å­¦ä¹ ç‡ï¼Œ<span class="math inline">\(\epsilon\)</span>æ˜¯ä¸ºä¿æŒæ•°å€¼ç¨³å®šä¸€ä¸ªå°å¸¸æ•°ï¼ˆå¤§å°é€šå¸¸æ˜¯<span class="math inline">\(e^{-7}\sim
e^{-10}\)</span>ï¼‰ï¼Œå…¬å¼å†…çš„è¿ç®—éƒ½æ˜¯æŒ‰å…ƒç´ è¿›è¡Œçš„æ“ä½œã€‚</p>
<blockquote>
<p>from nndl-book:</p>
<p>åœ¨ AdaGrad
ç®—æ³•ä¸­ï¼Œå¦‚æœæŸä¸ªå‚æ•°çš„åå¯¼æ•°ç´¯ç§¯æ¯”è¾ƒå¤§ï¼Œå…¶å­¦ä¹ ç‡ç›¸å¯¹è¾ƒå°;ç›¸åï¼Œå¦‚æœå…¶åå¯¼æ•°ç´¯ç§¯è¾ƒå°ï¼Œå…¶å­¦ä¹ ç‡ç›¸å¯¹è¾ƒå¤§.ä½†æ•´ä½“æ˜¯éšç€è¿­ä»£æ¬¡æ•°çš„å¢åŠ ï¼Œå­¦ä¹ ç‡é€æ¸ç¼©å°.
AdaGrad
ç®—æ³•çš„ç¼ºç‚¹æ˜¯åœ¨ç»è¿‡ä¸€å®šæ¬¡æ•°çš„è¿­ä»£ä¾ç„¶æ²¡æœ‰æ‰¾åˆ°æœ€ä¼˜ç‚¹æ—¶ï¼Œç”±äºè¿™æ—¶çš„å­¦ä¹ ç‡å·²ç»éå¸¸å°ï¼Œå¾ˆéš¾å†ç»§ç»­æ‰¾åˆ°æœ€ä¼˜ç‚¹.</p>
</blockquote></li>
<li><p>RMSpropç®—æ³•</p>
<p>é¿å…AdaGradç®—æ³•ä¸­å­¦ä¹ ç‡ä¸æ–­å•è°ƒä¸‹é™å¯¼è‡´è¿‡æ—©è¡°å‡çš„é—®é¢˜ã€‚</p>
<p>å‚æ•°æ›´æ–°çš„å·®å€¼å’ŒAdaGradç®—æ³•æ˜¯ç›¸åŒçš„ï¼š</p>
<p><span class="math display">\[
  \Delta \theta _{t} = - \frac {\alpha}{\sqrt {G_t+\epsilon}}\odot g_t
  \]</span></p>
<p>åŒºåˆ«åœ¨äºè®¡ç®—<span class="math inline">\(G_t\)</span>:</p>
<p><span class="math display">\[
  \begin{aligned}
  G_{t} &amp;=\beta G_{t-1}+(1-\beta) \boldsymbol{g}_{t} \odot
\boldsymbol{g}_{t} \\
  &amp;=(1-\beta) \sum_{\tau=1}^{t} \beta^{t-\tau} \boldsymbol{g}_{\tau}
\odot \boldsymbol{g}_{\tau}
  \end{aligned}
  \]</span></p>
<p>ç”±äºå‚æ•°çš„å­¦ä¹ ç‡å˜åŒ–ç”±å•è°ƒè¡°å‡å˜æˆäº†æŒ‡æ•°åŠ æƒçš„ç§»åŠ¨å¹³å‡ï¼Œæ—¢å¯ä»¥å˜å¤§ä¹Ÿå¯ä»¥å˜å°ã€‚</p></li>
<li><p>AdaDeltaç®—æ³•</p>
<p>å‚æ•°æ›´æ–°çš„å·®å€¼ä¸ºï¼š</p>
<p><span class="math display">\[
  \Delta \theta_{t}=-\frac{\sqrt{\Delta
X_{t-1}^{2}+\epsilon}}{\sqrt{G_{t}+\epsilon}} \mathbf{g}_{t}
  \]</span></p>
<p>å…¶ä¸­<span class="math inline">\(G_t\)</span>å’ŒRMSpropç®—æ³•ç›¸åŒï¼š</p>
<p><span class="math display">\[
  \begin{aligned}
  G_{t} &amp;=\beta G_{t-1}+(1-\beta) \boldsymbol{g}_{t} \odot
\boldsymbol{g}_{t} \\
  &amp;=(1-\beta) \sum_{\tau=1}^{t} \beta^{t-\tau} \boldsymbol{g}_{\tau}
\odot \boldsymbol{g}_{\tau}
  \end{aligned}
  \]</span></p>
<p>åˆ†å­ä¸Šï¼š</p>
<p><span class="math display">\[
  \Delta X_{t-1}^{2}=\beta_{1} \Delta
X_{t-2}^{2}+\left(1-\beta_{1}\right) \Delta \theta_{t-1} \odot \Delta
\theta_{t-1}
  \]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\beta _1\)</span>æ˜¯è¡°å‡ç‡</p>
<p>ç”±äºå°†åŸæœ¬çš„å­¦ä¹ ç‡ä¿®æ”¹ä¸ºäº†å¸¦è¡°å‡ç‡çš„ç§»åŠ¨å¹³å‡ï¼Œèƒ½å¤ŸæŠ‘åˆ¶ä½å­¦ä¹ ç‡çš„æ³¢åŠ¨ã€‚</p></li>
</ul>
<h2 id="å‚æ•°åˆå§‹åŒ–">å‚æ•°åˆå§‹åŒ–</h2>
<p>å½“ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ä¼˜åŒ–ç½‘ç»œå‚æ•°æ—¶ï¼Œå‚æ•°çš„åˆå§‹å€¼éå¸¸é‡è¦ï¼Œç›´æ¥å½±å“åˆ°ç½‘ç»œçš„ä¼˜åŒ–æ•ˆç‡å’Œæ³›åŒ–èƒ½åŠ›</p>
<p>ç¥ç»ç½‘ç»œçš„å‚æ•°ä¸èƒ½åˆå§‹åŒ–ä¸º0ï¼Œä¼šå‡ºç°å¯¹ç§°æƒé‡é—®é¢˜ï¼Œå¯¼è‡´å±‚å†…æ‰€æœ‰æƒé‡ç›¸åŒã€‚</p>
<p>å› æ­¤å¯¹äºå‚æ•°çš„åˆå§‹åŒ–ä¹Ÿæœ‰è®¸å¤šæ–¹æ³•ã€‚</p>
<ul>
<li>é¢„è®­ç»ƒåˆå§‹åŒ–</li>
<li>éšæœºåˆå§‹åŒ–
<ul>
<li><p>åŸºäºå›ºå®šæ–¹å·®çš„å‚æ•°åˆå§‹åŒ–</p>
<ul>
<li><p>é«˜æ–¯åˆ†å¸ƒåˆå§‹åŒ–</p>
<p>ä½¿ç”¨æ–¹å·®å’Œå‡å€¼çš„é«˜æ–¯åˆ†å¸ƒ</p></li>
<li><p>å‡åŒ€åˆ†å¸ƒåˆå§‹åŒ–</p>
<p>é‡‡ç”¨åœ¨åŒºé—´<span class="math inline">\([-r,r]\)</span>å†…é‡‡ç”¨å‡åŒ€åˆ†å¸ƒè¿›è¡Œåˆå§‹åŒ–</p></li>
</ul></li>
<li><p>åŸºäºæ–¹å·®ç¼©æ”¾çš„å‚æ•°åˆå§‹åŒ–</p>
<p><span class="math inline">\(M_l\)</span>æ˜¯ç¬¬<span class="math inline">\(l\)</span>å±‚çš„ç¥ç»å…ƒä¸ªæ•°</p>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%204.png" alt="åŸºäºæ–¹å·®ç¼©æ”¾çš„å‚æ•°åˆå§‹åŒ–è®¾ç½®">
<figcaption aria-hidden="true">åŸºäºæ–¹å·®ç¼©æ”¾çš„å‚æ•°åˆå§‹åŒ–è®¾ç½®</figcaption>
</figure></li>
<li><p>æ­£äº¤åˆå§‹åŒ–</p>
<p>ç”±äºä¸Šè¿°ä¸¤ç§åˆå§‹åŒ–å¯¹æ¯ä¸ªå‚æ•°éƒ½æ˜¯ç‹¬ç«‹é‡‡æ ·ï¼Œä¾æ—§å­˜åœ¨æ¢¯åº¦æ¶ˆå¤±æˆ–æ¢¯åº¦çˆ†ç‚¸é—®é¢˜ã€‚</p>
<p>æ­¤å¤„æˆ‘ä»¬ä»æœ€å¼€å§‹å°±æ„å»ºä¸€ä¸ªLå±‚çš„ç­‰å®½çº¿æ€§ç½‘ç»œï¼š</p>
<p><span class="math display">\[
  \bold y= \bold W^L \bold W^{L-1} \dots \bold W^1 \bold x
  \]</span></p>
<p>åœ¨åå‘ä¼ æ’­ä¸­è¯¯å·®é¡¹<span class="math inline">\(\delta\)</span>çš„åå‘ä¼ æ’­å…¬å¼ä¸ºï¼š<span class="math inline">\(\delta ^{l-1}=(W^l)^T\delta ^l\)</span></p>
<p><strong>èŒƒæ•°ä¿æŒæ€§ï¼š</strong>æŒ‡è¯¯å·®é¡¹åœ¨åå‘ä¼ æ’­ä¸­çš„èŒƒæ•°ä¿æŒä¸å˜ï¼Œæ»¡è¶³<span class="math inline">\(||\delta^{l-1}||^2=||\delta^l||^2=||(W^l)^T\delta^l||^2\)</span>ã€‚</p>
<p>äºæ˜¯åœ¨åˆå§‹åŒ–å°±å¯ä»¥ä½¿ç”¨å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º<span class="math inline">\(1/M\)</span>çš„é«˜æ–¯åˆ†å¸ƒæ¥åšåˆå§‹åŒ–</p>
<hr>
<p>æˆ–è€…é‡‡ç”¨æ›´ç›´æ¥çš„æ–¹å¼ï¼šç›´æ¥å°† <span class="math inline">\(W^l\)</span>åˆå§‹åŒ–ä¸ºæ­£äº¤çŸ©é˜µï¼Œå³<span class="math inline">\(W^l(W^l)^T=I\)</span></p>
<ol type="1">
<li>yåœ°æ–¹ç”¨å‡å€¼ä¸º0ï¼Œæ–¹å·®ä¸º1çš„é«˜æ–¯åˆ†å¸ƒåˆå§‹åŒ–ä¸€ä¸ªçŸ©é˜µ</li>
<li>å°†è¿™ä¸ªçŸ©é˜µç”¨å¥‡å¼‚å€¼åˆ†è§£å¾—åˆ°ä¸¤ä¸ªæ­£äº¤çŸ©é˜µï¼Œç”¨å…¶ä¸­ä¹‹ä¸€ä½œä¸ºæƒé‡çŸ©é˜µ</li>
</ol>
<aside>
<p>ğŸ’¡ æ­£äº¤åˆå§‹åŒ–é€šå¸¸ç”¨åœ¨RNNçš„å¾ªç¯è¾¹ä¸Šçš„æƒé‡çŸ©é˜µ</p>
</aside></li>
</ul></li>
</ul>
<h2 id="æ•°æ®é¢„å¤„ç†">æ•°æ®é¢„å¤„ç†</h2>
<h3 id="å°ºåº¦ä¸å˜æ€§scale-invariance">å°ºåº¦ä¸å˜æ€§ï¼ˆScale Invarianceï¼‰</h3>
<p>å¯¹äºæœºå™¨ç®—æ³•ä¸­çš„æ•°æ®ï¼Œåœ¨ç¼©æ”¾éƒ¨åˆ†ç‰¹å¾æˆ–è€…å…¨éƒ¨ç‰¹å¾åï¼Œä¸å½±å“å­¦ä¹ å’Œé¢„æµ‹ã€‚</p>
<p>ä¾‹å¦‚ï¼šå°†å˜ç±³å•ä½çš„ç‰¹å¾ï¼Œç¼©æ”¾ä¸ºæ¯«ç±³å•ä½ã€‚</p>
<p><em>NOTE:KNNç®—æ³•çš„å°ºåº¦ä¸å˜æ€§è¾ƒå·®ï¼Œå› ä¸ºå…¶è®¡ç®—çš„æ¬§å¼è·ç¦»å¯¹æ•°æ®è¦æ±‚é«˜</em></p>
<p>ä¸åŒè¾“å…¥ç‰¹å¾çš„å°ºåº¦å·®å¼‚è¾ƒå¤§ä¼šå¸¦æ¥ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol type="1">
<li>å‚æ•°åˆå§‹åŒ–å›°éš¾</li>
<li>ä¼˜åŒ–æ•ˆç‡è¾ƒä½</li>
</ol>
<h3 id="å½’ä¸€åŒ–è§„èŒƒåŒ–-normalization">å½’ä¸€åŒ–ï¼ˆè§„èŒƒåŒ– Normalizationï¼‰</h3>
<ul>
<li><p><strong>æœ€å°æœ€å¤§å€¼è§„èŒƒåŒ–</strong>ï¼š</p>
<p>æ‰¾åˆ°æ•°æ®ä¸­çš„æœ€å°æœ€å¤§å€¼ï¼Œå°†æ‰€æœ‰æ•°æ®ç¼©æ”¾åˆ°è¿™ä¸ªèŒƒå›´å†…</p></li>
<li><p><strong>æ ‡å‡†åŒ–ï¼ˆZå€¼è§„èŒƒåŒ–ï¼‰</strong>ï¼š</p>
<p>å¯¹æ¯ä¸€ç»´æ•°æ®è®¡ç®—å‡å€¼å’Œæ–¹å·®</p>
<p><span class="math display">\[
  \mu = \frac{1}{N} \sum \limits _{n=1}^Nx^n
  \]</span></p>
<p><span class="math display">\[
  \sigma ^2 = \frac{1}{N}\sum \limits _{n=1}^N (x^n-\mu)^2
  \]</span></p>
<p>ç„¶åå°†ç‰¹å¾<span class="math inline">\(x^n\)</span>è¿›è¡Œå˜æ¢ï¼š</p>
<p><span class="math display">\[
  \hat x^n = \frac{x^n-\mu}{\sigma}
  \]</span></p>
<p>æ ‡å‡†å·®<span class="math inline">\(\sigma\)</span>åšåˆ†æ¯ä¸ä¸ºé›¶çš„å«ä¹‰ï¼š</p>
<p>è¡¨ç¤ºè¿™ä¸€ç»´åº¦çš„ç‰¹å¾ç›¸åŒï¼Œä¸é‡è¦å¯ä»¥ç›´æ¥å»æ‰</p></li>
<li><p><strong>ç™½åŒ–ï¼ˆwhiteningï¼ŒPCAï¼‰</strong>:</p>
<p>å»é™¤æ‰€æœ‰æˆåˆ†ä¹‹é—´çš„ç›¸å…³æ€§</p>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%205.png" alt="æ ‡å‡†åŒ–å’Œç™½åŒ–">
<figcaption aria-hidden="true">æ ‡å‡†åŒ–å’Œç™½åŒ–</figcaption>
</figure></li>
</ul>
<h3 id="é€å±‚è§„èŒƒåŒ–">é€å±‚è§„èŒƒåŒ–</h3>
<p>MLä¸­çš„å¸¸ç”¨æ–¹æ³•ï¼Œåº”ç”¨åˆ°DLçš„ç›®çš„æ˜¯ï¼š</p>
<ol type="1">
<li><p>æ›´å¥½çš„å°ºåº¦ä¸å˜æ€§</p>
<p>è§£å†³å†…éƒ¨åå˜é‡åç§»é—®é¢˜ï¼Œé˜²æ­¢åœ¨æ·±åº¦å­¦ä¹ ä¸­æŸä¸€ä¸ªå±‚çš„è¾“å…¥åˆ†å¸ƒçš„å¾®å°å˜åŒ–å¼•èµ·æ›´æ·±å±‚ä¸­çš„è¾ƒå¤§åç§»ã€‚</p></li>
<li><p>æ›´å¹³æ»‘çš„ä¼˜åŒ–åœ°å½¢</p></li>
</ol>
<ul>
<li>è§„èŒƒåŒ–æ–¹æ³•
<ul>
<li><p><strong>æ‰¹é‡è§„èŒƒåŒ–ï¼ˆBatch Normalizationï¼‰</strong></p>
<p>å¯¹äºä¸€ä¸ªç¥ç»ç½‘ç»œï¼Œç¬¬<span class="math inline">\(l\)</span>å±‚çš„å‡€è¾“å…¥ä¸º<span class="math inline">\(z^l\)</span>ï¼Œç¥ç»å…ƒçš„è¾“å‡ºä¸º<span class="math inline">\(a^l\)</span>ï¼Œå³ï¼š</p>
<p><span class="math display">\[
  a^l = f(z^l)=f(Wa^{l-1}+b)
  \]</span></p>
<p>å¯¹äºä¸€ä¸ªæ ·æœ¬æ•°ä¸ºkçš„æ‰¹é‡æ ·æœ¬ï¼Œè®¡ç®—å…¶æ–¹å·®å’Œå‡å€¼ï¼š</p>
<p><span class="math display">\[
  \begin{aligned}
  &amp;\boldsymbol{\mu}_{\mathcal{B}}=\frac{1}{K} \sum_{k=1}^{K}
\boldsymbol{z}^{(k, l)} \\
  &amp;\boldsymbol\sigma_{\mathcal{B}}^{2}=\frac{1}{K}
\sum_{k=1}^{K}\left(\boldsymbol{z}^{(k,
l)}-\boldsymbol{\mu}_{\mathcal{B}}\right) \odot\left(\boldsymbol{z}^{(k,
l)}-\boldsymbol{\mu}_{\mathcal{B}}\right) .
  \end{aligned}
  \]</span></p>
<p>æ‰¹é‡è§„èŒƒåŒ–ï¼š</p>
<p><span class="math display">\[
  \begin{aligned}
  \hat{\boldsymbol{z}}^{l}
&amp;=\frac{\boldsymbol{z}^{l}-\mu_{\mathcal{B}}}{\sqrt{\sigma_{\mathcal{B}}^{2}+\epsilon}}
\odot \boldsymbol{\gamma}+\boldsymbol{\beta} \\
  &amp; \triangleq \mathrm{BN}_{\gamma,
\boldsymbol{\beta}}\left(\boldsymbol{z}^{l}\right),
  \end{aligned}
  \]</span></p>
<p>å…¶ä¸­<span class="math inline">\(\boldsymbol{\gamma}\)</span>æ˜¯ç¼©æ”¾å‚æ•°å‘é‡ï¼Œ<span class="math inline">\(\boldsymbol{\beta}\)</span>æ˜¯å¹³ç§»å‚æ•°å‘é‡ï¼Œéƒ½æ˜¯å¯å­¦ä¹ å‚æ•°ã€‚èƒ½å¤Ÿå¢å¼ºè§„èŒƒåŒ–çš„èƒ½åŠ›ã€‚</p>
<aside>
<p>ğŸ’¡ æ‰¹é‡è§„èŒƒåŒ–å¯ä»¥ä½œä¸ºç¥ç»ç½‘ç»œçš„ä¸€å±‚ï¼ˆBNå±‚ï¼‰ç›´æ¥åŠ å…¥ç½‘ç»œç»“æ„ä¸­ã€‚</p>
</aside></li>
<li><p><strong>å±‚è§„èŒƒåŒ–ï¼ˆLayer Normalizationï¼‰</strong></p>
<p>ä¸çœ‹batchçš„å†…å®¹ï¼Œå¯¹ä¸€å±‚å†…æ‰€æœ‰ç¥ç»å…ƒè¿›è¡Œè§„èŒƒåŒ–</p>
<p>è®¡ç®—å±‚å†…å‡å€¼å’Œæ–¹å·®ï¼š</p>
<p><span class="math display">\[
  \begin{aligned}
  \mu^{l} &amp;=\frac{1}{M_{l}} \sum_{i=1}^{M_{l}} z_{i}^{l} \\
  (\sigma^{l})^{2} &amp;=\frac{1}{M_{l}}
\sum_{i=1}^{M_{l}}\left(z_{i}^{l}-\mu^{l}\right)^{2}
  \end{aligned}
  \]</span></p>
<p>å±‚è§„èŒƒåŒ–ï¼š</p>
<p><span class="math display">\[
  \begin{aligned}
  \hat{\boldsymbol{z}}^{l}
&amp;=\frac{\boldsymbol{z}^{l}-\mu^{l}}{\sqrt{(\sigma^{(l)})^{2}+\epsilon}}
\odot \boldsymbol{\gamma}+\boldsymbol\beta \\
  &amp; \triangleq \mathrm{LN}_{\boldsymbol {\gamma,
\beta}}\left(\boldsymbol{z}^{l}\right)
  \end{aligned}
  \]</span></p>
<aside>
<p>ğŸ’¡
å±‚è§„èŒƒåŒ–ä¹Ÿå¯ä»¥ä½œä¸ºç¥ç»ç½‘ç»œçš„ä¸€å±‚ï¼ˆLNå±‚ï¼‰ç›´æ¥åŠ å…¥ç½‘ç»œç»“æ„ä¸­ã€‚åº”ç”¨è¾ƒå¤šã€‚</p>
</aside>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%206.png" alt="BNå’ŒLNçš„åŒºåˆ«">
<figcaption aria-hidden="true">BNå’ŒLNçš„åŒºåˆ«</figcaption>
</figure>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%207.png" alt="å„ç§è§„èŒƒåŒ–çš„å¯¹æ¯”">
<figcaption aria-hidden="true">å„ç§è§„èŒƒåŒ–çš„å¯¹æ¯”</figcaption>
</figure></li>
<li><p>æƒé‡è§„èŒƒåŒ–</p></li>
<li><p>å±€éƒ¨å“åº”è§„èŒƒåŒ–</p></li>
</ul></li>
</ul>
<h2 id="è¶…å‚æ•°ä¼˜åŒ–">è¶…å‚æ•°ä¼˜åŒ–</h2>
<h3 id="è¶…å‚æ•°">è¶…å‚æ•°</h3>
<ul>
<li>å±‚æ•°</li>
<li>æ¯å±‚ç¥ç»å…ƒä¸ªæ•°</li>
<li>æ¿€æ´»å‡½æ•°</li>
<li>å­¦ä¹ ç‡ï¼ˆä»¥åŠåŠ¨æ€è°ƒæ•´ç®—æ³•ï¼‰</li>
<li>æ­£åˆ™åŒ–ç³»æ•°</li>
<li>mini-batchå¤§å°</li>
</ul>
<h3 id="ä¼˜åŒ–æ–¹æ³•">ä¼˜åŒ–æ–¹æ³•</h3>
<ul>
<li><p>ç½‘æ ¼æœç´¢</p>
<p>å¯¹æ¯ä¸€ä¸ªè¶…å‚æ•°å–å‡ ä¸ªâ€ç»éªŒå€¼â€œï¼Œæ¯”å¦‚å¯¹äºå­¦ä¹ ç‡<span class="math inline">\(\alpha\)</span>ï¼Œå¯ä»¥è®¾ç½®</p>
<p><span class="math display">\[
  \alpha  \in \{0.01,0.1,0.5,1.0\}
  \]</span></p></li>
<li><p>éšæœºæœç´¢</p>
<p>å¯¹è¶…å‚æ•°è¿›è¡Œéšæœºç»„åˆ</p></li>
<li><p>è´å¶æ–¯ä¼˜åŒ–</p></li>
<li><p>åŠ¨æ€èµ„æºåˆ†é…</p></li>
<li><p>ç¥ç»æ¶æ„æœç´¢</p></li>
</ul>
<h2 id="ç½‘ç»œæ­£åˆ™åŒ–">ç½‘ç»œæ­£åˆ™åŒ–</h2>
<p>ç”±äºç¥ç»ç½‘ç»œçš„æ‹Ÿåˆèƒ½åŠ›å¼ºï¼Œä¼šå°†æ¨¡å‹è¿‡åº¦å‚æ•°åŒ–ï¼Œä¼šå¯¼è‡´æ¨¡å‹æ³›åŒ–æ€§å·®ã€‚ä¸ºæé«˜ç¥ç»ç½‘ç»œçš„æ³›åŒ–èƒ½åŠ›é€šå¸¸è¦åŠ å…¥æ­£åˆ™åŒ–ã€‚</p>
<p><strong>æ­£åˆ™åŒ–</strong>å°±æ˜¯æ‰€æœ‰æŸå®³ä¼˜åŒ–æ–¹æ³•çš„æ–¹æ³•ã€‚é€šå¸¸åˆ†ä¸ºä¸¤ç§æ–¹å¼ï¼š</p>
<ol type="1">
<li>å¢åŠ ä¼˜åŒ–çº¦æŸï¼šL1ã€L2çº¦æŸ</li>
<li>å¹²æ‰°ä¼˜åŒ–è¿‡ç¨‹ï¼šæå‰åœæ­¢ã€éšæœºæ¢¯åº¦ä¸‹é™ã€æš‚é€€æ³•ã€æƒé‡è¡°å‡ã€‚</li>
</ol>
<h3 id="æ—©åœæ³•">æ—©åœæ³•</h3>
<p>å¼•å…¥<strong>éªŒè¯é›†ï¼ˆValidation
Datasetï¼‰</strong>æµ‹è¯•æ¯ä¸€æ¬¡è¿­ä»£çš„å‚æ•°æ—¶å€™åœ¨éªŒè¯é›†ä¸Šæœ€ä¼˜ï¼Œå¦‚æœåœ¨éªŒè¯é›†ä¸Šé”™è¯¯ç‡ä¸å†ä¸‹é™å°±åœæ­¢è¿­ä»£ã€‚é˜²æ­¢è¿‡æ‹Ÿåˆã€‚</p>
<h3 id="æƒé‡è¡°å‡">æƒé‡è¡°å‡</h3>
<p>é™åˆ¶æƒé‡å–å€¼èŒƒå›´ã€‚åœ¨æ¯æ¬¡å‚æ•°æ›´æ–°æ—¶ï¼Œå¼•å…¥ä¸€ä¸ªè¡°å‡ç³»æ•°<span class="math inline">\(\beta\)</span></p>
<p><span class="math display">\[
\theta_t=(1-\beta)\theta_{t-1}-\alpha \bold g_t
\]</span></p>
<h3 id="æš‚é€€æ³•dropout">æš‚é€€æ³•ï¼ˆDropoutï¼‰</h3>
<p>æœ‰ä¸€ä¸ªç¥ç»å±‚<span class="math inline">\(y=f(Wx+b)\)</span>ï¼Œå¼•å…¥ä¸€ä¸ªéšæœºçš„æ©è”½å‡½æ•°<span class="math inline">\(mask(x)=m\odot x\)</span>ï¼Œ<span class="math inline">\(m \in \{0,1\}^D\)</span>.å¾—åˆ°ç¥ç»å±‚çš„è¾“å‡º<span class="math inline">\(y=f(Wmask(x)+b)\)</span>.</p>
<aside>
ğŸ’¡
å¯ä»¥ç†è§£ä¸ºä»åŸå§‹ç½‘ç»œä¸­é‡‡æ ·å¾—åˆ°ä¸€ä¸ªå­ç½‘ç»œï¼Œå¦‚æœæœ‰nä¸ªç¥ç»å…ƒï¼Œåˆ™å¯ä»¥é‡‡æ ·å‡º<span class="math inline">\(2^n\)</span>ä¸ªå­ç½‘ç»œã€‚
</aside>
<h3 id="ell_1å’Œell_2æ­£åˆ™åŒ–"><span class="math inline">\(\ell_1\)</span>å’Œ<span class="math inline">\(\ell_2\)</span>æ­£åˆ™åŒ–</h3>
<p>åœ¨åŸæœ¬çš„ä¼˜åŒ–é—®é¢˜ä¸­åŠ å…¥<span class="math inline">\(\ell_1\)</span><span class="math inline">\(\ell_2\)</span>èŒƒæ•°é˜²æ­¢è¿‡æ‹Ÿåˆ</p>
<p><span class="math display">\[
\begin{aligned}
&amp;\theta^{*}=\underset{\theta}{\arg \min } \frac{1}{N} \sum_{n=1}^N
\mathcal{L}\left(y^{(n)}, f\left(\boldsymbol{x}^{(n)} ;
\theta\right)\right) \\
&amp;\text { s.t. } \quad \ell_{p}(\theta) \leq 1
\end{aligned}
\]</span></p>
<p><span class="math inline">\(\ell_2\)</span>æ­£åˆ™åŒ–çš„å‚æ•°æ›´æ–°ç»“æœä¸ºï¼š<span class="math inline">\(\theta_t =
\theta_{t-1}-\alpha(g_t+\lambda\theta_{t-1})=(1-\alpha\lambda)\theta_{t-1}-\alpha
g_t\)</span></p>
<p>å½¢å¼ä¸Šå’Œæƒé‡è¡°å‡çš„ç±»ä¼¼ï¼š<span class="math inline">\(\theta_t=(1-\beta)\theta_{t-1}-\alpha \bold
g_t\)</span></p>
<aside>
ğŸ’¡ åœ¨SGDä¸­ <span class="math inline">\(\ell_2\)</span>
æ­£åˆ™åŒ–å’Œæƒé‡è¡°å‡æ˜¯ç­‰ä»·çš„ï¼Œä½†åœ¨å¤æ‚çš„ä¼˜åŒ–ç®—æ³•å¦‚Adamä¸­åˆ™ä¸èƒ½ç­‰ä»·ã€‚
</aside>
<figure>
<img src="/2022/07/31/shen-jing-wang-luo-zhong-de-you-hua-suan-fa-he-zheng-ze-hua-wen-ti/Untitled%208.png" alt="ä¸åŒèŒƒæ•°çš„çº¦æŸæ¡ä»¶ç¤ºä¾‹">
<figcaption aria-hidden="true">ä¸åŒèŒƒæ•°çš„çº¦æŸæ¡ä»¶ç¤ºä¾‹</figcaption>
</figure>
<h1 id="æ€»ç»“">æ€»ç»“</h1>
<table>

<thead>
<tr class="header">
<th>æ¨¡å‹</th>
<th>ä¼˜åŒ–</th>
<th>æ­£åˆ™åŒ–</th>
<th>éšå¼æ­£åˆ™åŒ–</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ç”¨ReLUä½œä¸ºæ¿€æ´»å‡½æ•°</td>
<td>SGD+mini-batch(åŠ¨æ€å­¦ä¹ ç‡ã€Adamç®—æ³•ä¼˜å…ˆ)</td>
<td>æ—©åœæ³•</td>
<td>SGD</td>
</tr>
<tr class="even">
<td>æ®‹å·®é“¾æ¥</td>
<td>æ¯æ¬¡è¿­ä»£éƒ½é‡æ–°éšæœºæ’åº</td>
<td>æš‚é€€æ³•</td>
<td>æ‰¹é‡è§„èŒƒåŒ–</td>
</tr>
<tr class="odd">
<td>é€å±‚è§„èŒƒåŒ–</td>
<td>æ•°æ®é¢„å¤„ç†ï¼ˆè§„èŒƒåŒ–ï¼‰</td>
<td>æƒé‡è¡°å‡</td>
<td><span class="math inline">\(\ell_1\)</span>å’Œ<span class="math inline">\(\ell_2\)</span>æ­£åˆ™åŒ–</td>
</tr>
<tr class="even">
<td></td>
<td>å‚æ•°åˆå§‹åŒ–ï¼ˆé¢„è®­ç»ƒï¼‰</td>
<td></td>
<td>æ•°æ®å¢å¼º</td>
</tr>
</tbody>
</table>
]]></content>
      <categories>
        <category>å­¦ä¹ </category>
      </categories>
      <tags>
        <tag>ML</tag>
        <tag>DL</tag>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>è™šæ‹Ÿå±€åŸŸç½‘æŠ€æœ¯VLANè§£æ</title>
    <url>/2022/10/17/xu-ni-ju-yu-wang-ji-zhu-vlan-jie-xi/</url>
    <content><![CDATA[<h1 id="è™šæ‹Ÿå±€åŸŸç½‘æŠ€æœ¯">è™šæ‹Ÿå±€åŸŸç½‘æŠ€æœ¯</h1>
<p>## å‰è¨€</p>
<p>å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„ä»¥å¤ªç½‘äº¤æ¢æœºç”±äºä»¥å¤ªç½‘è§„æ¨¡çš„æ‰©å¤§å¯¼è‡´å¹¿æ’­åŸŸæ‰©å¤§ï¼Œé€ æˆçš„<u>å¹¿æ’­é£æš´</u>å¯èƒ½ä¼šå¯¼è‡´ç½‘ç»œç˜«ç—ªã€‚</p>
<p>å¹¿æ’­ä¿¡æ¯çš„æ¥æºä¸»è¦æ˜¯æ¶‰åŠåˆ°åœ°å€è§£æã€åç§°è§£æçš„è¡Œä¸ºï¼š</p>
<ol type="1">
<li>ç½‘ç»œå±‚
TCP/IPåè®®æ ˆä¸­çš„åè®®ï¼šåœ°å€è§£æåè®®ARPï¼Œè·¯ç”±ä¿¡æ¯åè®®RIPï¼ŒDHCP</li>
<li>ä¼šè¯å±‚åè®®ï¼šç½‘ä¸ŠåŸºæœ¬è¾“å…¥è¾“å‡ºç³»ç»ŸNETBIOS</li>
<li>åº”ç”¨å±‚åè®®ï¼šé“¾è·¯æœ¬åœ°å¤šæ’­åç§°è§£æLLMNR</li>
</ol>
<p>ç½‘ç»œä¸­çš„å¹¿æ’­ä¿¡æ¯æ— å¤„ä¸åœ¨ï¼Œæƒ³è¦å…‹åˆ¶ä¸å»ä½¿ç”¨æ˜¯<strong>ä¸ç°å®çš„</strong>ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥æƒ³åŠæ³•å‡å°å¹¿æ’­çš„å½±å“èŒƒå›´å³å¹¿æ’­åŸŸã€‚</p>
<p>å¯¹äºç½‘ç»œè´Ÿè½½è¿‡é«˜ã€é€šä¿¡æ€§èƒ½ä¸‹é™çš„æƒ…å†µï¼Œå¾€å¾€éœ€è¦ç®¡ç†å‘˜æ‰‹åŠ¨æ›´æ”¹ç½‘ç»œæ‹“æ‰‘ç»“æ„ï¼Œå¦‚å˜æ›´ä¸»æœºç½‘æ®µã€ç¡¬ä»¶çº¿è·¯æ”¹é€ ç­‰ã€‚å‡ºç°VLANä¹‹åå°±<strong>åªéœ€è¦ä¿®æ”¹ç½‘ç»œç»“æ„</strong>ã€‚</p>
<h2 id="å®šä¹‰">å®šä¹‰</h2>
<p>è™šæ‹Ÿå±€åŸŸç½‘ï¼ˆVirtual
LAN,VLANï¼‰ï¼Œæ˜¯å°†ä¸€ä¸ªç‰©ç†çš„LANåœ¨é€»è¾‘ä¸Šåˆ’åˆ†æˆå¤šä¸ªå¹¿æ’­åŸŸçš„é€šä¿¡æŠ€æœ¯ã€‚æ¯ä¸ªVLANæ˜¯ä¸€ä¸ªå¹¿æ’­åŸŸï¼ŒVLANå†…çš„ä¸»æœºé—´é€šä¿¡å°±å’Œåœ¨ä¸€ä¸ªLANå†…ä¸€æ ·ï¼Œè€ŒVLANé—´åˆ™ä¸èƒ½ç›´æ¥äº’é€šï¼Œè¿™æ ·ï¼Œå¹¿æ’­æŠ¥æ–‡å°±è¢«é™åˆ¶åœ¨ä¸€ä¸ªVLANå†…ã€‚</p>
<h2 id="å®ç°">å®ç°</h2>
<h1 id="è™šæ‹Ÿæ‰©å±•å±€åŸŸç½‘">è™šæ‹Ÿæ‰©å±•å±€åŸŸç½‘</h1>
<h2 id="vlançš„é™åˆ¶">VLANçš„é™åˆ¶</h2>
<p>ä¼ ç»ŸVLANæ ‡è¯†IDå­—æ®µçš„VIDåªæœ‰12bitï¼Œæœ€å¤šèƒ½å–4094ä¸ªå€¼ï¼Œå¯¹äºå¤§å‹çš„åº”ç”¨åœºæ™¯èƒ½åŠ›æœ‰é™ã€‚</p>
<h2 id="vxlan">VXLAN</h2>
<h3 id="å®šä¹‰-1">å®šä¹‰</h3>
<p>æœ¬è´¨ä¸Šæ˜¯éš§é“æŠ€æœ¯ã€‚</p>
<h3 id="åŸç†è§£æ">åŸç†è§£æ</h3>
<h2 id="ä¼˜ç¼ºç‚¹">ä¼˜ç¼ºç‚¹</h2>
<h2 id="è™šæ‹Ÿå±€åŸŸç½‘æŠ€æœ¯å±•æœ›">è™šæ‹Ÿå±€åŸŸç½‘æŠ€æœ¯å±•æœ›</h2>
<h1 id="è™šæ‹Ÿå±€åŸŸç½‘å®éªŒ">è™šæ‹Ÿå±€åŸŸç½‘å®éªŒ</h1>
<p>æŠŠä¸€ä¸ªç‰©ç†ç½‘ç»œä»é€»è¾‘ä¸Šåˆ’åˆ†ä¸ºå‡ ä¸ªå•ç‹¬çš„å±€åŸŸç½‘</p>
<h2 id="æ²¡æœ‰åˆ’åˆ†vlançš„ç½‘ç»œ">æ²¡æœ‰åˆ’åˆ†VLANçš„ç½‘ç»œ</h2>
<h2 id="åˆ’åˆ†vlançš„ç½‘ç»œ">åˆ’åˆ†VLANçš„ç½‘ç»œ</h2>
<h2 id="vlanä¹‹é—´äº’é€š">VLANä¹‹é—´äº’é€š</h2>
]]></content>
  </entry>
  <entry>
    <title>Github Pagesä¸Hexo deployçš„ä¸€ç‚¹å°é—®é¢˜</title>
    <url>/2023/04/16/github-pages-yu-hexo-deploy-de-yi-dian-xiao-wen-ti/</url>
    <content><![CDATA[<h1 id="å‰æƒ…æè¦">å‰æƒ…æè¦</h1>
<blockquote>
<p>é¡ºä¾¿å¦‚æœä½ è¿˜æ²¡æ’¸è¿‡è¿™ä¸ªå­¦ç”Ÿå…šç¾Šæ¯›ï¼šhttps://education.github.com/pack/offers</p>
<p>ä¸€å…±æœ‰ä¸‰å®¶åŸŸåå•†ç»™æä¾›è¿™ä¸ªç¾Šæ¯›ï¼Œæ…¢æ…¢æ’¸</p>
</blockquote>
<p>å‰æ®µæ—¶é—´æƒ³ç©ç©åŸŸåï¼Œäºæ˜¯è¶ç€GitHubå­¦ç”ŸåŒ…è¿˜åœ¨èµ¶ç´§æ’¸ä¸¤ä¸ªå…è´¹çš„ä¸€å¹´åŸŸåã€‚ç®€å•çš„æ³¨å†ŒåŸŸåç»‘å®šåœ¨GitHub
Pagesä¸Šä¹‹åå°±æ²¡æœ‰å†deployåˆ°ä»“åº“ä¸Šæ–°çš„åšæ–‡ï¼Œåªæ˜¯åœ¨æœ¬åœ°ä¿®æ”¹è¿‡ï¼Œäºæ˜¯å¿˜è®°äº†æœ‰è¿™ä¹ˆä¸€å›äº‹ã€‚</p>
<p>namecheapè¿™å®¶åŸŸåå•†åœ¨ç”¨å­¦ç”ŸåŒ…æ³¨å†Œæ—¶å¾ˆé¸¡è´¼åœ°è¡¥å……ä¸€å¥ï¼š<strong>ç°åœ¨æ˜¯å”¯ä¸€å°†ä½ åŸŸåå’ŒGitHub
Pagesç»‘å®šçš„æ—¶æœº</strong></p>
<p>å…¶å®ï¼Œåœ¨åšå®¢çš„ä»“åº“settingä¸‹æ‰‹åŠ¨è®¾ç½®Custom domainå¹¶æ²¡æœ‰å¤šå¤æ‚ã€‚</p>
<p><strong>ç›´åˆ°ä»Šå¤©æˆ‘åœ¨deployäº†hexoçš„ä¿®æ”¹åï¼Œå‘ç°åŸŸåä¸‹çš„åšå®¢æ€ä¹ˆ404äº†</strong></p>
<figure>
<img src="/2023/04/16/github-pages-yu-hexo-deploy-de-yi-dian-xiao-wen-ti/404.png" alt="404">
<figcaption aria-hidden="true">404</figcaption>
</figure>
<h1 id="çœæµç‰ˆ">çœæµç‰ˆ</h1>
<p>Hexoæœ‰é’ˆå¯¹é…ç½®GitHub Pageså®šåˆ¶åŸŸåçš„æ–¹æ³•ï¼Œåœ¨è¿™ä¸ª<a href="https://github.com/hexojs/hexo/issues/4121">issue</a>ä¸­æåˆ°ï¼šåœ¨Hexoç›®å½•ä¸‹çš„<code>source</code>ç›®å½•ä¸­åˆ›å»º<code>CNAME</code>æ–‡ä»¶ï¼Œå¹¶å°†åŸŸåå†™å…¥ï¼Œä¹‹åçš„æ¯æ¬¡æ„å»ºå’Œéƒ¨ç½²éƒ½ä¼šå¸¦æœ‰åŸŸåä¿¡æ¯ã€‚</p>
<figure>
<img src="/2023/04/16/github-pages-yu-hexo-deploy-de-yi-dian-xiao-wen-ti/cname.png" alt="cname">
<figcaption aria-hidden="true">cname</figcaption>
</figure>
<h1 id="é—®é¢˜æ’æŸ¥">é—®é¢˜æ’æŸ¥</h1>
<ol type="1">
<li><p><strong>æ€€ç–‘æ˜¯Hexoæ„å»ºå‡ºäº†é—®é¢˜</strong>ï¼Œä½†æ˜¯404åº”è¯¥æ˜¯<code>index.html</code>ä¸æ­£å¸¸æ‰ä¼šæœ‰çš„é—®é¢˜</p>
<p><code>hexo clean</code>ç„¶åé‡æ–°<code>hexo g</code>
<code>hexo d</code>ï¼Œç„¶åå‘ç°æš´éœ²å‡ºäº†å¦ä¸€ä¸ªé”™è¯¯ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">[master b137740] Site updated: 2023-04-16 15:33:52<br> 2 files changed, 792 insertions(+), 796 deletions(-)<br>kex_exchange_identification: Connection closed by remote host<br>Connection closed by 198.18.1.13 port 22<br>fatal: Could not <span class="hljs-built_in">read</span> from remote repository.<br><br>Please make sure you have the correct access rights<br>and the repository exists.<br></code></pre></td></tr></table></figure>
<p>è¿™æ˜¯æˆ‘ä»¥ä¸ºå°±æ˜¯gitåœ¨é“¾æ¥ä¸Šçš„æ•…éšœï¼Œäºæ˜¯é‡æ–°ç”Ÿæˆäº†SSHå¯†é’¥ä¸Šä¼ åˆ°GitHubä¸Šï¼Œä½†æ˜¯æ•…éšœä¾æ—§</p></li>
<li><p><strong>æ’æŸ¥SSHé—®é¢˜</strong>ï¼Œæœç´¢åˆ°ä½¿ç”¨çš„ä»£ç†å¯èƒ½ä¼šå‡ºç°ä¸å…è®¸22ç«¯å£çš„æƒ…å†µ</p>
<p>äºæ˜¯åœ¨<code>~/.ssh/config</code>ä¸­æ·»åŠ äº†ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs config">Host github.com<br>  HostName ssh.github.com<br>  Port 443<br></code></pre></td></tr></table></figure>
<p>è¡¨ç¤ºå¼ºåˆ¶ä½¿ç”¨443ç«¯å£è¿æ¥GitHubçš„SSH</p>
<p>ä½¿ç”¨<code>ssh -vT git@github.com</code>æµ‹è¯•GitHubï¼š</p>
<p>ä¸€ä¸²è·‘ç ä¹‹åæ”¶åˆ°å›å¤ï¼š<code>Hi Ash-one! You've successfully authenticated, but GitHub does not provide shell access.</code>
çœ‹æ¥SSHçš„é—®é¢˜è§£å†³äº†</p>
<p>ç»§ç»­æµ‹è¯•deployï¼Œå‘ç°Hexoæ­£å¸¸æ„å»ºåˆå¹¶äº†åˆ†æ”¯åˆ°ä»“åº“ä¸­ã€‚</p>
<p>ä½†æ˜¯ï¼Œæ•…éšœä¾æ—§è¿˜åœ¨ã€‚</p></li>
<li><p>åˆ°è¿™é‡Œï¼Œæˆ‘é€‰æ‹©<strong>æ£€æŸ¥äº†commitè®°å½•</strong>ï¼Œå› ä¸ºåœ¨å°è±¡ä¸­æœ‰çœ‹åˆ°ä»“åº“æ ¹ç›®å½•ä¸‹æœ‰<code>CNAME</code>æ–‡ä»¶æ ‡è®°æ˜¯å“ªä¸ªåŸŸåï¼Œç»“æœåœ¨æ‰€æœ‰commitè®°å½•ä¸­éƒ½æ²¡æœ‰è§åˆ°è¿™ä¸€æ¡ï¼Œcommitçš„æ–‡æœ¬ä¹Ÿéƒ½æ˜¯Hexoè‡ªåŠ¨ç”Ÿæˆçš„updateæ–‡æœ¬ã€‚</p>
<p>ç»ˆäºæ„è¯†åˆ°äº†æ˜¯<strong>Hexoåœ¨deployçš„æ—¶å€™è‚¯å®šæ˜¯å°†CNAMEæ–‡ä»¶è¦†ç›–æ‰</strong>äº†ï¼Œé‡æ–°è¿›å…¥ä»“åº“çš„è®¾ç½®ï¼Œæœç„¶å‘ç°æ›¾ç»é…ç½®è¿‡çš„åŸŸåæ¶ˆå¤±äº†</p>
<figure>
<img src="/2023/04/16/github-pages-yu-hexo-deploy-de-yi-dian-xiao-wen-ti/custom-domain.png" alt="å¯¹è¿™é‡Œç†Ÿæ‚‰å®Œå…¨æ˜¯å› ä¸ºé…ç½®HTTPSè¯ä¹¦æ—¶çš„ç—›è‹¦">
<figcaption aria-hidden="true">å¯¹è¿™é‡Œç†Ÿæ‚‰å®Œå…¨æ˜¯å› ä¸ºé…ç½®HTTPSè¯ä¹¦æ—¶çš„ç—›è‹¦</figcaption>
</figure></li>
</ol>
<p>é‡æ–°åœ¨å›¾ä¸­3çš„ä½ç½®ä¸Šå¡«ä¸Šäº†åŸŸååï¼ŒæˆåŠŸè§£å†³äº†è¿™æ¬¡çš„404é—®é¢˜ã€‚</p>
<p>ä½†æ˜¯å¾ˆç®€å•çš„çŠ¶å†µæ˜¯ï¼šä¸‹æ¬¡deployè¿˜ä¼šè¦†ç›–æ‰CNAME</p>
<p>å®é™…ä¸ŠHexoæœ‰é’ˆå¯¹é…ç½®GitHub Pagesçš„æ–¹æ³•ï¼Œåœ¨è¿™ä¸ª<a href="https://github.com/hexojs/hexo/issues/4121">issue</a>ä¸­æåˆ°ï¼šåœ¨Hexoç›®å½•ä¸‹çš„<code>source</code>ç›®å½•ä¸­åˆ›å»º<code>CNAME</code>æ–‡ä»¶ï¼Œå¹¶å°†åŸŸåå†™å…¥ï¼Œå°±å®Œæˆäº†ï¼Œä¹‹åçš„æ¯æ¬¡æ„å»ºå’Œéƒ¨ç½²éƒ½ä¼šå¸¦æœ‰åŸŸåä¿¡æ¯ã€‚</p>
<h1 id="å°ç»“">å°ç»“</h1>
<p>æ•´ä½“è€Œè¨€åªæ˜¯å› ä¸ºå·¥å…·ä¸ç†Ÿæ‚‰å‡ºç°çš„ä¸€æ¬¡å°é—®é¢˜ï¼ŒèŠ±äº†åŠå°æ—¶çš„æ’æŸ¥æ¥å›ï¼Œè¿˜å‡ºç°SSHä¸Šçš„å¥‡æ€ªé—®é¢˜ï¼Œç¡®å®æ˜¯å¾ˆå¥‡å¦™äº†ã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>hexo</tag>
        <tag>åšå®¢</tag>
        <tag>git</tag>
      </tags>
  </entry>
  <entry>
    <title>åœ¨Linuxä¸Šæ— sudoå®‰è£…ä½¿ç”¨ProxyChains</title>
    <url>/2023/04/18/zai-linux-shang-shi-yong-proxychains-wu-root-quan-xian/</url>
    <content><![CDATA[<h1 id="å‰è¨€">å‰è¨€</h1>
<p>å¤šäººå…±ç”¨æœåŠ¡å™¨æ—¶ç»å¸¸é‡åˆ°åˆ†é…çš„è´¦æˆ·æ— sudoæƒé™ã€æ— æ³•ææƒï¼Œä½†æ˜¯ç»å¸¸éœ€è¦å®‰è£…è½¯ä»¶ã€‚</p>
<p>é€šå¸¸æ¥è®²ä¸‹è½½æºç æœ¬åœ°makeç„¶åinstallæ²¡æœ‰å¤ªå¤šé—®é¢˜ï¼Œä¸è¿‡ç”±äºå¾ˆå¤šè½¯ä»¶å¼€å‘è€…è®¾ç½®çš„è·¯å¾„é—®é¢˜ä¼šå¯¼è‡´è½¯ä»¶æ— æ³•ä½¿ç”¨ï¼Œ</p>
<p>æœ¬æ–‡ä»¥ProxyChainsä¸ºä¾‹è¿›è¡Œæ•´ä¸ªè¿‡ç¨‹ï¼ŒProxyChainsæ˜¯ä¸€ä¸ªå…¨å±€ä»£ç†å·¥å…·ï¼Œå¯ä»¥åœ¨éœ€è¦çš„å‘½ä»¤å‰åŠ ä¸Š<code>proxychains4</code>ä½¿å¾—è¯¥å‘½ä»¤æŒ‰ç…§è®¾ç½®é€šè¿‡ä»£ç†è®¿é—®ã€‚</p>
<p><strong>æ³¨æ„è¿™ä¸ªå·¥å…·åªèƒ½ä»£ç†TCPï¼Œåƒ<code>ping</code>å‘½ä»¤è¿™æ ·çš„ICMPåè®®æ˜¯ä¸ä¼šè¢«ä»£ç†çš„ï¼</strong></p>
<h1 id="å®‰è£…">å®‰è£…</h1>
<p>å¦‚æœæ˜¯æœ‰sudoæƒé™ç›´æ¥ç”¨åŒ…ç®¡ç†å™¨ä¸‹è½½å³å¯ï¼ŒUbuntuä¸Š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">sudo apt install proxychains4<br></code></pre></td></tr></table></figure>
<p>æ²¡æœ‰æƒé™çš„éœ€è¦ä»æºç æ„å»º</p>
<p>ProxyChainsçš„<a href="https://github.com/haad/proxychains">ä»“åº“</a>å¯ä»¥ä¸‹è½½åˆ°æºç ï¼Œç„¶å<code>cd</code>è¿›å…¥è¯¥ç›®å½•</p>
<p>ä½¿ç”¨ç¼–è¾‘å™¨æ‰“å¼€<code>src/main.c</code>æ–‡ä»¶ï¼Œä¿®æ”¹å›¾ä¸­çš„å†…å®¹ï¼š</p>
<figure>
<img src="/2023/04/18/zai-linux-shang-shi-yong-proxychains-wu-root-quan-xian/ä¿®æ”¹.png" alt="éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†">
<figcaption aria-hidden="true">éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†</figcaption>
</figure>
<p>è¿™é‡Œä»£ç æŒ‡å®šçš„æ˜¯ç¨‹åºè¿è¡Œæ—¶ä»å“ªé‡Œè¯»å–libæ–‡ä»¶ï¼Œå½“æˆ‘ä»¬make
installå®Œåï¼Œè¿™ä¸ªlibæ–‡ä»¶<code>libproxychains4.so</code>æ˜¯åœ¨æœ¬é¡¹ç›®æºæ–‡ä»¶å¤¹ä¸‹çš„ï¼Œ</p>
<p>æ‰€ä»¥éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å°†éœ€è¦æ”¾ç½®libæ–‡ä»¶çš„è·¯å¾„æ·»åŠ åˆ°è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œæˆ‘è¿™é‡Œé€‰æ‹©ç»Ÿä¸€ç®¡ç†libæ–‡ä»¶çš„è·¯å¾„ï¼Œ<strong>æ‰€ä»¥åœ¨è¿™ä¸ªå­—å…¸é‡ŒåŠ ä¸Š`/home/gxz/.local/lib'
</strong>ï¼Œä½ è¦æ ¹æ®è‡ªå·±é€‰æ‹©æ˜¯å¦ä¿®æ”¹ã€‚</p>
<p>ä¸‹é¢æŒ‡å®šé…ç½®ç›®å½•ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># --prefixæ˜¯ç”¨æ¥æ·»åŠ å‰ç¼€çš„ï¼Œè¡¨ç¤ºä»å½“å‰ç›®å½•å¼€å§‹makeçš„ç»“æœè·¯å¾„ä¼šåŠ ä¸Šè¿™ä¸ªå‰ç¼€</span><br>./configue --prefix=build<br><br>make<br><br><span class="hljs-comment"># æ³¨æ„è¿™é‡Œçš„DESTDIRè·¯å¾„ä¸€å®šè¦ä»æ ¹ç›®å½•å¼€å§‹å†™ï¼Œinstallçš„ç»“æœä¼šæ”¾åœ¨DESTDIRåŠ ä¸Šä¸Šé¢é…ç½®çš„prefixçš„æ–‡ä»¶å¤¹ä¸­ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥å®‰è£…åœ¨å…¶ä»–ä½ç½®ç»Ÿä¸€ç®¡ç†</span><br>make install DESTDIR=<span class="hljs-string">&#x27;/home/gxz/dev/proxychains&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æ²¡æœ‰æŠ¥é”™å°±ä»£è¡¨å®‰è£…å¥½äº†ï¼Œå¯ä»¥æ‰¾åˆ°<code>.so</code>æ–‡ä»¶ï¼Œå°†å®ƒæ‹·è´æˆ–è€…ç§»åŠ¨åˆ°åˆšæ‰åœ¨cæ–‡ä»¶æ·»åŠ çš„ç›®å½•ä¸‹ï¼š</p>
<figure>
<img src="/2023/04/18/zai-linux-shang-shi-yong-proxychains-wu-root-quan-xian/makeç»“æœ.png" alt="makeç»“æœ">
<figcaption aria-hidden="true">makeç»“æœ</figcaption>
</figure>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cp</span> libproxychains4.so /home/gxz/.local/lib/<br><span class="hljs-comment"># è¿™é‡Œç›´æ¥mvä¹Ÿå¯ä»¥</span><br></code></pre></td></tr></table></figure>
<p>å°†ProxyChainsæ·»åŠ åˆ°ç¯å¢ƒå˜é‡ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">vim ~/.bashrc<br><br><br><span class="hljs-comment">#proxychains</span><br><span class="hljs-built_in">export</span> PROXYCHAINS_HOME=<span class="hljs-variable">$HOME</span>/dev/proxychains<br><span class="hljs-built_in">export</span> PATH=<span class="hljs-variable">$PROXYCHAINS_HOME</span>/build/bin:<span class="hljs-variable">$PATH</span><br><br><span class="hljs-comment"># å¦‚æœä½ å¾ˆç†Ÿæ‚‰dllæ–‡ä»¶è°ƒç”¨ï¼Œç›´æ¥åœ¨è¿™é‡Œå°†â€˜~/.local/libâ€˜è·¯å¾„åŠ å…¥åº“æ–‡ä»¶è·¯å¾„å¾ˆæ–¹ä¾¿ã€‚</span><br><span class="hljs-built_in">export</span> LD_LIBRARY_PATH=<span class="hljs-variable">$HOME</span>/.local/lib:<span class="hljs-variable">$LD_LIBRARY_PATH</span><br><br><br><span class="hljs-comment"># è¿˜å¯ä»¥åŠ ä¸Šåˆ«åï¼Œæ¯•ç«Ÿè¿™æ¡å‘½ä»¤æœ‰ç‚¹é•¿</span><br><span class="hljs-built_in">alias</span> pc=<span class="hljs-string">&#x27;proxychains4&#x27;</span><br></code></pre></td></tr></table></figure>
<p>åˆ°è¿™é‡Œï¼Œå‘½ä»¤è¡Œè¾“å…¥<code>pc</code>åº”è¯¥ä¼šçœ‹åˆ°æç¤ºä½ è¾“å…¥åé¢çš„å‘½ä»¤ã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬è¿˜æ²¡æœ‰é…ç½®å…·ä½“çš„ä»£ç†åœ°å€ï¼Œæ ¹æ®ä»“åº“ä¸­çš„æŒ‡ç¤ºï¼Œconfæ–‡ä»¶åœ¨è¿™äº›è·¯å¾„ä¸Šæ˜¯ä¼šè¢«è‡ªåŠ¨æ£€æµ‹åˆ°çš„ï¼š</p>
<figure>
<img src="/2023/04/18/zai-linux-shang-shi-yong-proxychains-wu-root-quan-xian/conf.png" alt="confæ–‡ä»¶è·¯å¾„">
<figcaption aria-hidden="true">confæ–‡ä»¶è·¯å¾„</figcaption>
</figure>
<p>æˆ‘é€‰æ‹©åœ¨<code>$(HOME)/.proxychains/proxychains.conf</code>è¿™ä¸ªè·¯å¾„ä¸‹å­˜å‚¨é…ç½®æ–‡ä»¶ã€‚å°†ä¸‹é¢æ–‡ä»¶ç²˜è´´è¿›è¯¥æ–‡ä»¶ä¸­ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">strict_chain<br>proxy_dns <br>remote_dns_subnet 224<br>tcp_read_time_out 15000<br>tcp_connect_time_out 8000<br>localnet 127.0.0.0/255.0.0.0<br><span class="hljs-comment"># ProxyList format</span><br><span class="hljs-comment">#       type  host  port [user pass]</span><br><span class="hljs-comment">#       (values separated by &#x27;tab&#x27; or &#x27;blank&#x27;)</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#        Examples:</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#            	socks5	192.168.67.78	1080	lamer	secret</span><br><span class="hljs-comment">#		http	192.168.89.3	8080	justu	hidden</span><br><span class="hljs-comment">#	 	socks4	192.168.1.49	1080</span><br><span class="hljs-comment">#	        http	192.168.39.93	8080	</span><br><span class="hljs-comment">#		</span><br><span class="hljs-comment">#</span><br><span class="hljs-comment">#       proxy types: http, socks4, socks5, raw</span><br><span class="hljs-comment">#        * raw: The traffic is simply forwarded to the proxy without modification.</span><br><span class="hljs-comment">#        ( auth types supported: &quot;basic&quot;-http  &quot;user/pass&quot;-socks )</span><br><span class="hljs-comment">#</span><br><br>[ProxyList]<br><span class="hljs-comment"># add proxy here ...</span><br><span class="hljs-comment"># meanwile</span><br><span class="hljs-comment"># defaults set to &quot;tor&quot;</span><br>socks5 10.56.0.237 1001 <br></code></pre></td></tr></table></figure>
<p>æœ€ç»ˆéœ€è¦ä¿®æ”¹çš„ä»£ç†å†…å®¹å°±åœ¨æœ€åä¿®æ”¹å³å¯ï¼Œæ”¯æŒhttp/https/socks5ç­‰å¤šç§ä»£ç†ã€‚</p>
<h1 id="ä½¿ç”¨">ä½¿ç”¨</h1>
<p>ä½¿ç”¨å¾ˆç®€å•ï¼Œåœ¨éœ€è¦çš„å‘½ä»¤å‰åŠ ä¸Š<code>proxychains4</code>ä½¿å¾—è¯¥å‘½ä»¤æŒ‰ç…§è®¾ç½®é€šè¿‡ä»£ç†è®¿é—®ã€‚</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">proxychains4 git <span class="hljs-built_in">clone</span> https://github.com/xcmyz/FastSpeech.git<br><br><span class="hljs-comment"># é…ç½®åˆ«åå</span><br>pc git <span class="hljs-built_in">clone</span> https://github.com/xcmyz/FastSpeech.git<br></code></pre></td></tr></table></figure>
<figure>
<img src="/2023/04/18/zai-linux-shang-shi-yong-proxychains-wu-root-quan-xian/result.png" alt="ç»“æœ">
<figcaption aria-hidden="true">ç»“æœ</figcaption>
</figure>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ä»£ç†</tag>
        <tag>proxy</tag>
        <tag>tool</tag>
        <tag>linux</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨Surgeå¼€å¯SSHä»£ç†æ— æ³•é€šè¿‡ç§é’¥è¿æ¥çš„åŸå› </title>
    <url>/2023/05/23/shi-yong-surge-kai-qi-ssh-dai-li-wu-fa-tong-guo-si-yao-lian-jie-de-yuan-yin/</url>
    <content><![CDATA[<h1 id="é—®é¢˜">é—®é¢˜</h1>
<figure>
<img src="/2023/05/23/shi-yong-surge-kai-qi-ssh-dai-li-wu-fa-tong-guo-si-yao-lian-jie-de-yuan-yin/SSH.png" alt="SSHä»£ç†">
<figcaption aria-hidden="true">SSHä»£ç†</figcaption>
</figure>
<p>Surgeçš„SSHä»£ç†ç›¸å½“äº<code>ssh -D</code>å‘½ä»¤ï¼Œå¼€å¯åŠ¨æ€ç«¯å£è½¬å‘åŠŸèƒ½ã€‚</p>
<p>å¦‚æœä¸é€šè¿‡å¯†ç å¼€å¯SSHä»£ç†å°±å¿…é¡»ä½¿ç”¨ç§é’¥ï¼Œä½¿ç”¨RSAç§é’¥å¯ä»¥é€šè¿‡sshè¿æ¥æœåŠ¡å™¨ï¼Œä½†æ˜¯åœ¨Surgeè®¾ç½®åå‡ºç°äº†<code>ssh authorazition failed</code>çš„æƒ…å†µï¼Œæµ‹è¯•ä»£ç†ä¸é€šã€‚</p>
<h1 id="è§£å†³">è§£å†³</h1>
<p><strong>ç»“è®ºæ”¾åœ¨å‰é¢ï¼šRSAå¯†é’¥åŠ å¯†æ–¹å¼ä¸å¯¹ï¼Œæ›´æ¢åˆ°ed25519åŠ å¯†æ–¹å¼é‡æ–°ç”Ÿæˆå¯†é’¥</strong></p>
<p>å…ˆæ¥æ£€æŸ¥SSHçš„åŠ å¯†æ–¹å¼ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">ssh -v name@host<br></code></pre></td></tr></table></figure>
<p>æ‰¾åˆ°è¾“å‡ºä¸­çš„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">debug1: kex: algorithm: curve25519-sha256<br></code></pre></td></tr></table></figure>
<p>ä»£è¡¨ç”¨çš„æ˜¯25519è¿™ç§åŠ å¯†æ–¹å¼ï¼Œè€Œæˆ‘çš„å¯†é’¥æ˜¯RSAçš„ï¼Œè™½ç„¶å¯ä»¥ç™»å½•ï¼Œä½†ä¸èƒ½ä»£ç†ç”¨ã€‚è¿™ç§æ–¹å¼æ˜¯æ–°ç‰ˆæœ¬é»˜è®¤çš„åŠ å¯†æ–¹å¼ï¼Œå¦‚æœä½ çš„ç»“æœä¸åŒï¼Œé‚£ä¹ˆä¸‹é¢çš„å¯†é’¥ä½ ä¹Ÿè¦æ¢æˆå’Œè¿™é‡Œä¸€æ ·çš„åŠ å¯†æ–¹å¼ã€‚</p>
<p>é‡æ–°ç”Ÿæˆå¯†é’¥ï¼š</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><code class="hljs bash">ssh-keygen -t ed25519 -C <span class="hljs-string">&#x27;xxx@email.com&#x27;</span><br></code></pre></td></tr></table></figure>
<p>æŠŠå…¬é’¥åŠ å…¥æœåŠ¡å™¨-&gt;Surgeæ·»åŠ ç§é’¥åˆ°å¯†é’¥åº“-&gt;é‡æ–°æµ‹è¯•ä»£ç†è¿æ¥</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œ</tag>
        <tag>ä»£ç†</tag>
        <tag>Surge</tag>
        <tag>SSH</tag>
      </tags>
  </entry>
</search>
